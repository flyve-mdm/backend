---
layout: coverage
---
<html>

<head>
    <script src="assets/d3.js" charset="utf-8"></script>
    <script src="assets/dagre-d3.js"></script>
    <script src="assets/jquery.js"></script>
    <script src="assets/jquery.tablesorter.js"></script>
    <script src="assets/report.js"></script>

    <link rel="stylesheet" href="assets/font-awesome.min.css">
</head>

<body>

<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="index.html"><img src="assets/logo.png" alt="atoum"/> Code coverage report</a>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="col-lg-12">
            <div class="row">
        <h1>PluginFlyvemdmAgent: lines coverage</h1>

        


<table class="table table-bordered">
    <tr>
        
                    <td style="text-align: center; width: 100%">
                <h1 class="text-warning">
                    47%
                                            <small>of 930</small>
                                    </h1>
                <strong>Lines</strong>
            </td>
        
        
            </tr>
</table>

<table class="table table-bordered table-striped table-hover sort">
    <thead>
    <tr>
        <th>Method <i class="fa"></i></th>
                            <th style="text-align: center">Lines <i class="fa"></i></th>
            <th style="text-align: center">Line % <i class="fa"></i></th>
                            </tr>
    </thead>

    <tbody>
            <tr>
            <td><a href="#getMinVersioForType">PluginFlyvemdmAgent::getMinVersioForType()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-warning">50%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getEnumMdmType">PluginFlyvemdmAgent::getEnumMdmType()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getTypeName">PluginFlyvemdmAgent::getTypeName()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getMenuPicture">PluginFlyvemdmAgent::getMenuPicture()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getRights">PluginFlyvemdmAgent::getRights()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#defineTabs">PluginFlyvemdmAgent::defineTabs()</a></td>
                                        <td style="text-align: center">10</td>
                <td style="text-align: center">    
    <span class="label label-success">80%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getTabNameForItem">PluginFlyvemdmAgent::getTabNameForItem()</a></td>
                                        <td style="text-align: center">16</td>
                <td style="text-align: center">    
    <span class="label label-danger">13%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#displayTabContentForItem">PluginFlyvemdmAgent::displayTabContentForItem()</a></td>
                                        <td style="text-align: center">9</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#showForm">PluginFlyvemdmAgent::showForm()</a></td>
                                        <td style="text-align: center">32</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#showDangerZone">PluginFlyvemdmAgent::showDangerZone()</a></td>
                                        <td style="text-align: center">26</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#showForFleet">PluginFlyvemdmAgent::showForFleet()</a></td>
                                        <td style="text-align: center">19</td>
                <td style="text-align: center">    
    <span class="label label-success">95%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#displayTabContentForComputer">PluginFlyvemdmAgent::displayTabContentForComputer()</a></td>
                                        <td style="text-align: center">13</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#canViewItem">PluginFlyvemdmAgent::canViewItem()</a></td>
                                        <td style="text-align: center">9</td>
                <td style="text-align: center">    
    <span class="label label-warning">56%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendWipeQuery">PluginFlyvemdmAgent::sendWipeQuery()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendLockQuery">PluginFlyvemdmAgent::sendLockQuery()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendUnlockQuery">PluginFlyvemdmAgent::sendUnlockQuery()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendUnenrollQuery">PluginFlyvemdmAgent::sendUnenrollQuery()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#prepareInputForAdd">PluginFlyvemdmAgent::prepareInputForAdd()</a></td>
                                        <td style="text-align: center">19</td>
                <td style="text-align: center">    
    <span class="label label-warning">53%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#prepareInputForUpdate">PluginFlyvemdmAgent::prepareInputForUpdate()</a></td>
                                        <td style="text-align: center">41</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_addItem">PluginFlyvemdmAgent::post_addItem()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_getFromDB">PluginFlyvemdmAgent::post_getFromDB()</a></td>
                                        <td style="text-align: center">4</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#pre_deleteItem">PluginFlyvemdmAgent::pre_deleteItem()</a></td>
                                        <td style="text-align: center">43</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_updateItem">PluginFlyvemdmAgent::post_updateItem()</a></td>
                                        <td style="text-align: center">18</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#createTaskStatuses">PluginFlyvemdmAgent::createTaskStatuses()</a></td>
                                        <td style="text-align: center">11</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#cancelTaskStatuses">PluginFlyvemdmAgent::cancelTaskStatuses()</a></td>
                                        <td style="text-align: center">15</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_restoreItem">PluginFlyvemdmAgent::post_restoreItem()</a></td>
                                        <td style="text-align: center">9</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_purgeItem">PluginFlyvemdmAgent::post_purgeItem()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getSearchOptionsNew">PluginFlyvemdmAgent::getSearchOptionsNew()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#rawSearchOptions">PluginFlyvemdmAgent::rawSearchOptions()</a></td>
                                        <td style="text-align: center">91</td>
                <td style="text-align: center">    
    <span class="label label-success">99%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#addDefaultJoin">PluginFlyvemdmAgent::addDefaultJoin()</a></td>
                                        <td style="text-align: center">8</td>
                <td style="text-align: center">    
    <span class="label label-warning">63%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#addDefaultWhere">PluginFlyvemdmAgent::addDefaultWhere()</a></td>
                                        <td style="text-align: center">7</td>
                <td style="text-align: center">    
    <span class="label label-success">71%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getSubscribedTopic">PluginFlyvemdmAgent::getSubscribedTopic()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-success">83%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#updateSubscription">PluginFlyvemdmAgent::updateSubscription()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-success">83%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getTopic">PluginFlyvemdmAgent::getTopic()</a></td>
                                        <td style="text-align: center">8</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getByTopic">PluginFlyvemdmAgent::getByTopic()</a></td>
                                        <td style="text-align: center">21</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#unsubscribe">PluginFlyvemdmAgent::unsubscribe()</a></td>
                                        <td style="text-align: center">7</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#checkChallengeCombinations">PluginFlyvemdmAgent::checkChallengeCombinations()</a></td>
                                        <td style="text-align: center">8</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#enrollByInvitationToken">PluginFlyvemdmAgent::enrollByInvitationToken()</a></td>
                                        <td style="text-align: center">207</td>
                <td style="text-align: center">    
    <span class="label label-warning">54%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#cleanupSubtopics">PluginFlyvemdmAgent::cleanupSubtopics()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getTopicsToCleanup">PluginFlyvemdmAgent::getTopicsToCleanup()</a></td>
                                        <td style="text-align: center">7</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendGeolocationQuery">PluginFlyvemdmAgent::sendGeolocationQuery()</a></td>
                                        <td style="text-align: center">19</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendInventoryQuery">PluginFlyvemdmAgent::sendInventoryQuery()</a></td>
                                        <td style="text-align: center">18</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendPingQuery">PluginFlyvemdmAgent::sendPingQuery()</a></td>
                                        <td style="text-align: center">12</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#signCertificate">PluginFlyvemdmAgent::signCertificate()</a></td>
                                        <td style="text-align: center">10</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getAgents">PluginFlyvemdmAgent::getAgents()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getPackages">PluginFlyvemdmAgent::getPackages()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-warning">33%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getFiles">PluginFlyvemdmAgent::getFiles()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-warning">33%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getFleet">PluginFlyvemdmAgent::getFleet()</a></td>
                                        <td style="text-align: center">9</td>
                <td style="text-align: center">    
    <span class="label label-success">78%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getOwner">PluginFlyvemdmAgent::getOwner()</a></td>
                                        <td style="text-align: center">7</td>
                <td style="text-align: center">    
    <span class="label label-success">71%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#chooseEnrollMethod">PluginFlyvemdmAgent::chooseEnrollMethod()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-warning">50%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#setupMqttAccess">PluginFlyvemdmAgent::setupMqttAccess()</a></td>
                                        <td style="text-align: center">47</td>
                <td style="text-align: center">    
    <span class="label label-success">83%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#filterMessages">PluginFlyvemdmAgent::filterMessages()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#logInvitationEvent">PluginFlyvemdmAgent::logInvitationEvent()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#changeMqttAcl">PluginFlyvemdmAgent::changeMqttAcl()</a></td>
                                        <td style="text-align: center">26</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getComputer">PluginFlyvemdmAgent::getComputer()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-success">83%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#notify">PluginFlyvemdmAgent::notify()</a></td>
                                        <td style="text-align: center">3</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#hook_entity_purge">PluginFlyvemdmAgent::hook_entity_purge()</a></td>
                                        <td style="text-align: center">3</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#hook_computer_purge">PluginFlyvemdmAgent::hook_computer_purge()</a></td>
                                        <td style="text-align: center">3</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#refreshPersistedNotifications">PluginFlyvemdmAgent::refreshPersistedNotifications()</a></td>
                                        <td style="text-align: center">9</td>
                <td style="text-align: center">    
    <span class="label label-danger">22%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#isNotifiable">PluginFlyvemdmAgent::isNotifiable()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getSpecificValueToDisplay">PluginFlyvemdmAgent::getSpecificValueToDisplay()</a></td>
                                        <td style="text-align: center">16</td>
                <td style="text-align: center">    
    <span class="label label-success">88%</span>
</td>
                                            </tr>
        </tbody>
</table>

        <table class="table table-bordered table-stripped">
            <thead>
            <tr>
                <th>#</th>
                <th></th>
            </tr>
            </thead>

            <tbody>
                            <tr class="line" id="">
                    <th id="L1" class="number ">1</th>

                    <td class="" >
                        <pre>&lt;?php
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2" class="number ">2</th>

                    <td class="" >
                        <pre>/**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L3" class="number ">3</th>

                    <td class="" >
                        <pre> * LICENSE
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L4" class="number ">4</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L5" class="number ">5</th>

                    <td class="" >
                        <pre> * Copyright © 2016-2018 Teclib&#039;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L6" class="number ">6</th>

                    <td class="" >
                        <pre> * Copyright © 2010-2018 by the FusionInventory Development Team.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L7" class="number ">7</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L8" class="number ">8</th>

                    <td class="" >
                        <pre> * This file is part of Flyve MDM Plugin for GLPI.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L9" class="number ">9</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L10" class="number ">10</th>

                    <td class="" >
                        <pre> * Flyve MDM Plugin for GLPI is a subproject of Flyve MDM. Flyve MDM is a mobile
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L11" class="number ">11</th>

                    <td class="" >
                        <pre> * device management software.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L12" class="number ">12</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L13" class="number ">13</th>

                    <td class="" >
                        <pre> * Flyve MDM Plugin for GLPI is free software: you can redistribute it and/or
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L14" class="number ">14</th>

                    <td class="" >
                        <pre> * modify it under the terms of the GNU Affero General Public License as published
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L15" class="number ">15</th>

                    <td class="" >
                        <pre> * by the Free Software Foundation, either version 3 of the License, or
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L16" class="number ">16</th>

                    <td class="" >
                        <pre> * (at your option) any later version.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L17" class="number ">17</th>

                    <td class="" >
                        <pre> * Flyve MDM Plugin for GLPI is distributed in the hope that it will be useful,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L18" class="number ">18</th>

                    <td class="" >
                        <pre> * but WITHOUT ANY WARRANTY; without even the implied warranty of
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L19" class="number ">19</th>

                    <td class="" >
                        <pre> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L20" class="number ">20</th>

                    <td class="" >
                        <pre> * GNU Affero General Public License for more details.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L21" class="number ">21</th>

                    <td class="" >
                        <pre> * You should have received a copy of the GNU Affero General Public License
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L22" class="number ">22</th>

                    <td class="" >
                        <pre> * along with Flyve MDM Plugin for GLPI. If not, see http://www.gnu.org/licenses/.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L23" class="number ">23</th>

                    <td class="" >
                        <pre> * ------------------------------------------------------------------------------
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L24" class="number ">24</th>

                    <td class="" >
                        <pre> * @author    Thierry Bugier
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L25" class="number ">25</th>

                    <td class="" >
                        <pre> * @copyright Copyright © 2018 Teclib
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L26" class="number ">26</th>

                    <td class="" >
                        <pre> * @license   AGPLv3+ http://www.gnu.org/licenses/agpl.txt
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L27" class="number ">27</th>

                    <td class="" >
                        <pre> * @link      https://github.com/flyve-mdm/glpi-plugin
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L28" class="number ">28</th>

                    <td class="" >
                        <pre> * @link      https://flyve-mdm.com/
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L29" class="number ">29</th>

                    <td class="" >
                        <pre> * ------------------------------------------------------------------------------
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L30" class="number ">30</th>

                    <td class="" >
                        <pre> */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L31" class="number ">31</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L32" class="number ">32</th>

                    <td class="" >
                        <pre>use GlpiPlugin\Flyvemdm\Exception\AgentSendQueryException;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L33" class="number ">33</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L34" class="number ">34</th>

                    <td class="" >
                        <pre>if (!defined(&#039;GLPI_ROOT&#039;)) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L35" class="number ">35</th>

                    <td class="" >
                        <pre>   die(&quot;Sorry. You can&#039;t access this file directly&quot;);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L36" class="number ">36</th>

                    <td class="" >
                        <pre>}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L37" class="number ">37</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L38" class="number ">38</th>

                    <td class="" >
                        <pre>/**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L39" class="number ">39</th>

                    <td class="" >
                        <pre> * @since 0.1.0
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L40" class="number ">40</th>

                    <td class="" >
                        <pre> */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L41" class="number ">41</th>

                    <td class="" >
                        <pre>class PluginFlyvemdmAgent extends CommonDBTM implements PluginFlyvemdmNotifiableInterface {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L42" class="number ">42</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L43" class="number ">43</th>

                    <td class="" >
                        <pre>   const ENROLL_DENY             = 0;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L44" class="number ">44</th>

                    <td class="" >
                        <pre>   const ENROLL_INVITATION_TOKEN = 1;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L45" class="number ">45</th>

                    <td class="" >
                        <pre>   const ENROLL_ENTITY_TOKEN     = 2;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L46" class="number ">46</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L47" class="number ">47</th>

                    <td class="" >
                        <pre>   const DEFAULT_TOKEN_LIFETIME  = &#039;P7D&#039;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L48" class="number ">48</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L49" class="number ">49</th>

                    <td class="" >
                        <pre>   const MINIMUM_ANDROID_VERSION = &#039;2.0&#039;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L50" class="number ">50</th>

                    <td class="" >
                        <pre>   const MINIMUM_APPLE_VERSION = &#039;1.0&#039;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L51" class="number ">51</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L52" class="number ">52</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L53" class="number ">53</th>

                    <td class="" >
                        <pre>    * @var string $rightname name of the right in DB
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L54" class="number ">54</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L55" class="number ">55</th>

                    <td class="" >
                        <pre>   public static $rightname            = &#039;flyvemdm:agent&#039;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L56" class="number ">56</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L57" class="number ">57</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L58" class="number ">58</th>

                    <td class="" >
                        <pre>    * @var bool $dohistory maintain history
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L59" class="number ">59</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L60" class="number ">60</th>

                    <td class="" >
                        <pre>   public $dohistory                   = true;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L61" class="number ">61</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L62" class="number ">62</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L63" class="number ">63</th>

                    <td class="" >
                        <pre>    * @var bool $usenotepad enable notepad for the itemtype (GLPi &lt; 0.85)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L64" class="number ">64</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L65" class="number ">65</th>

                    <td class="" >
                        <pre>   protected $usenotepad               = true;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L66" class="number ">66</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L67" class="number ">67</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L68" class="number ">68</th>

                    <td class="" >
                        <pre>    * @var bool $usenotepad enable notepad for the itemtype (GLPi &gt;=0.85)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L69" class="number ">69</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L70" class="number ">70</th>

                    <td class="" >
                        <pre>   protected $usenotepadRights         = true;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L71" class="number ">71</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L72" class="number ">72</th>

                    <td class="" >
                        <pre>   protected $topic = null;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L73" class="number ">73</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L74" class="number ">74</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L75" class="number ">75</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L76" class="number ">76</th>

                    <td class="" >
                        <pre>    * Returns the minimum version of the agent accepted by the backend
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L77" class="number ">77</th>

                    <td class="" >
                        <pre>    * @param string $mdmType the type of the agent.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L78" class="number ">78</th>

                    <td class="" >
                        <pre>    * @return string the minimum version of the agent depending on its type
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L79" class="number ">79</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getMinVersioForType">
                    <th id="L80" class="number ">80</th>

                    <td class="" id="getMinVersioForType">
                        <pre>   private function getMinVersioForType($mdmType) {<span class="label label-warning">50%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L81" class="number covered">81</th>

                    <td class="covered" >
                        <pre>      switch ($mdmType) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L82" class="number covered">82</th>

                    <td class="covered" >
                        <pre>         case &#039;android&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L83" class="number covered">83</th>

                    <td class="covered" >
                        <pre>            return self::MINIMUM_ANDROID_VERSION;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L84" class="number unreach">84</th>

                    <td class="unreach" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L85" class="number ">85</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L86" class="number uncovered">86</th>

                    <td class="uncovered" >
                        <pre>         case &#039;apple&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L87" class="number uncovered">87</th>

                    <td class="uncovered" >
                        <pre>            return self::MINIMUM_APPLE_VERSION;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L88" class="number unreach">88</th>

                    <td class="unreach" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L89" class="number ">89</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L90" class="number ">90</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L91" class="number uncovered">91</th>

                    <td class="uncovered" >
                        <pre>      return &#039;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L92" class="number unreach">92</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L93" class="number ">93</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L94" class="number ">94</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L95" class="number ">95</th>

                    <td class="" >
                        <pre>    * get mdm types availables
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L96" class="number ">96</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getEnumMdmType">
                    <th id="L97" class="number ">97</th>

                    <td class="" id="getEnumMdmType">
                        <pre>   public static function getEnumMdmType() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L98" class="number ">98</th>

                    <td class="" >
                        <pre>      return [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L99" class="number covered">99</th>

                    <td class="covered" >
                        <pre>         &#039;android&#039;   =&gt; __(&#039;Android&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L100" class="number covered">100</th>

                    <td class="covered" >
                        <pre>         &#039;apple&#039;     =&gt; __(&#039;Apple&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L101" class="number ">101</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L102" class="number unreach">102</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L103" class="number ">103</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L104" class="number ">104</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L105" class="number ">105</th>

                    <td class="" >
                        <pre>    * Localized name of the type
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L106" class="number ">106</th>

                    <td class="" >
                        <pre>    * @param integer $nb number of item in the type (default 0)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L107" class="number ">107</th>

                    <td class="" >
                        <pre>    * @return string
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L108" class="number ">108</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getTypeName">
                    <th id="L109" class="number ">109</th>

                    <td class="" id="getTypeName">
                        <pre>   public static function getTypeName($nb = 0) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L110" class="number covered">110</th>

                    <td class="covered" >
                        <pre>      return _n(&#039;Agent&#039;, &#039;Agents&#039;, $nb, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L111" class="number unreach">111</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L112" class="number ">112</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L113" class="number ">113</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L114" class="number ">114</th>

                    <td class="" >
                        <pre>    * Return the picture file for the menu
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L115" class="number ">115</th>

                    <td class="" >
                        <pre>    * @return string
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L116" class="number ">116</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getMenuPicture">
                    <th id="L117" class="number ">117</th>

                    <td class="" id="getMenuPicture">
                        <pre>   public static function getMenuPicture() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L118" class="number covered">118</th>

                    <td class="covered" >
                        <pre>      return &#039;fa-tablet&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L119" class="number unreach">119</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L120" class="number ">120</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L121" class="number ">121</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L122" class="number ">122</th>

                    <td class="" >
                        <pre>    * @since version 0.1.0
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L123" class="number ">123</th>

                    <td class="" >
                        <pre>    * @see commonDBTM::getRights()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L124" class="number ">124</th>

                    <td class="" >
                        <pre>     */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getRights">
                    <th id="L125" class="number ">125</th>

                    <td class="" id="getRights">
                        <pre>   public function getRights($interface = &#039;central&#039;) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L126" class="number covered">126</th>

                    <td class="covered" >
                        <pre>      $rights = parent::getRights();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L127" class="number ">127</th>

                    <td class="" >
                        <pre>      /// For additional rights if needed
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L128" class="number ">128</th>

                    <td class="" >
                        <pre>      //$rights[self::RIGHTS] = self::getTypeName();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L129" class="number ">129</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L130" class="number covered">130</th>

                    <td class="covered" >
                        <pre>      return $rights;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L131" class="number unreach">131</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L132" class="number ">132</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L133" class="number ">133</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L134" class="number ">134</th>

                    <td class="" >
                        <pre>    * Define tabs available for this itemtype
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L135" class="number ">135</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="defineTabs">
                    <th id="L136" class="number ">136</th>

                    <td class="" id="defineTabs">
                        <pre>   public function defineTabs($options = []) {<span class="label label-success">80%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L137" class="number covered">137</th>

                    <td class="covered" >
                        <pre>      $tab = [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L138" class="number covered">138</th>

                    <td class="covered" >
                        <pre>      $this-&gt;addDefaultFormTab($tab);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L139" class="number covered">139</th>

                    <td class="covered" >
                        <pre>      $this-&gt;addStandardTab(PluginFlyvemdmGeolocation::class, $tab, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L140" class="number covered">140</th>

                    <td class="covered" >
                        <pre>      $this-&gt;addStandardTab(__CLASS__, $tab, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L141" class="number covered">141</th>

                    <td class="covered" >
                        <pre>      if (!$this-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L142" class="number uncovered">142</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;addStandardTab(PluginFlyvemdmTask::class, $tab, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L143" class="number uncovered">143</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;addStandardTab(PluginFlyvemdmTaskstatus::class, $tab, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L144" class="number ">144</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L145" class="number covered">145</th>

                    <td class="covered" >
                        <pre>      $this-&gt;addStandardTab(Notepad::class, $tab, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L146" class="number covered">146</th>

                    <td class="covered" >
                        <pre>      $this-&gt;addStandardTab(Log::class, $tab, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L147" class="number ">147</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L148" class="number covered">148</th>

                    <td class="covered" >
                        <pre>      return $tab;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L149" class="number unreach">149</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L150" class="number ">150</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L151" class="number ">151</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L152" class="number ">152</th>

                    <td class="" >
                        <pre>    * @see CommonGLPI::getTabNameForItem()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L153" class="number ">153</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L154" class="number ">154</th>

                    <td class="" >
                        <pre>    * @since version 9.1
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L155" class="number ">155</th>

                    <td class="" >
                        <pre>    * @param CommonGLPI $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L156" class="number ">156</th>

                    <td class="" >
                        <pre>    * @param integer $withtemplate
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L157" class="number ">157</th>

                    <td class="" >
                        <pre>    * @return array|string
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L158" class="number ">158</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getTabNameForItem">
                    <th id="L159" class="number ">159</th>

                    <td class="" id="getTabNameForItem">
                        <pre>   function getTabNameForItem(CommonGLPI $item, $withtemplate = 0) {<span class="label label-danger">13%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L160" class="number covered">160</th>

                    <td class="covered" >
                        <pre>      if (static::canView()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L161" class="number uncovered">161</th>

                    <td class="uncovered" >
                        <pre>         switch ($item-&gt;getType()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L162" class="number ">162</th>

                    <td class="" >
                        <pre>            case __CLASS__ :
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L163" class="number uncovered">163</th>

                    <td class="uncovered" >
                        <pre>               $tab = [1 =&gt; __(&#039;Danger zone !&#039;, &#039;flyvemdm&#039;)];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L164" class="number uncovered">164</th>

                    <td class="uncovered" >
                        <pre>               return $tab;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L165" class="number unreach">165</th>

                    <td class="unreach" >
                        <pre>               break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L166" class="number ">166</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L167" class="number ">167</th>

                    <td class="" >
                        <pre>            case PluginFlyvemdmFleet::class:
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L168" class="number uncovered">168</th>

                    <td class="uncovered" >
                        <pre>               if (!$withtemplate) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L169" class="number uncovered">169</th>

                    <td class="uncovered" >
                        <pre>                  $nb = 0;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L170" class="number uncovered">170</th>

                    <td class="uncovered" >
                        <pre>                  $fleetId = $item-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L171" class="number uncovered">171</th>

                    <td class="uncovered" >
                        <pre>                  $pluralNumber = Session::getPluralNumber();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L172" class="number uncovered">172</th>

                    <td class="uncovered" >
                        <pre>                  if ($_SESSION[&#039;glpishow_count_on_tabs&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L173" class="number uncovered">173</th>

                    <td class="uncovered" >
                        <pre>                     $DbUtil = new DbUtils();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L174" class="number uncovered">174</th>

                    <td class="uncovered" >
                        <pre>                     $nb = $DbUtil-&gt;countElementsInTable(static::getTable(), [&#039;plugin_flyvemdm_fleets_id&#039; =&gt; $fleetId]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L175" class="number ">175</th>

                    <td class="" >
                        <pre>                  }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L176" class="number uncovered">176</th>

                    <td class="uncovered" >
                        <pre>                  return self::createTabEntry(self::getTypeName($pluralNumber), $nb);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L177" class="number ">177</th>

                    <td class="" >
                        <pre>               }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L178" class="number uncovered">178</th>

                    <td class="uncovered" >
                        <pre>               break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L179" class="number ">179</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L180" class="number ">180</th>

                    <td class="" >
                        <pre>            case Computer::class:
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L181" class="number uncovered">181</th>

                    <td class="uncovered" >
                        <pre>               return __(&#039;Flyve MDM Agent&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L182" class="number uncovered">182</th>

                    <td class="uncovered" >
                        <pre>               break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L183" class="number ">183</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L184" class="number ">184</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L185" class="number ">185</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L186" class="number covered">186</th>

                    <td class="covered" >
                        <pre>      return &#039;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L187" class="number unreach">187</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L188" class="number ">188</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L189" class="number ">189</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L190" class="number ">190</th>

                    <td class="" >
                        <pre>    * @param CommonGLPI $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L191" class="number ">191</th>

                    <td class="" >
                        <pre>    * @param integer $tabnum (default 1)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L192" class="number ">192</th>

                    <td class="" >
                        <pre>    * @param integer $withtemplate (default 0)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L193" class="number ">193</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L194" class="number ">194</th>

                    <td class="" >
                        <pre>    * @since version 9.1
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L195" class="number ">195</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L196" class="number ">196</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L197" class="number ">197</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="displayTabContentForItem">
                    <th id="L198" class="number ">198</th>

                    <td class="" id="displayTabContentForItem">
                        <pre>   static function displayTabContentForItem(CommonGLPI $item, $tabnum = 1, $withtemplate = 0) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L199" class="number uncovered">199</th>

                    <td class="uncovered" >
                        <pre>      switch (get_class($item)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L200" class="number uncovered">200</th>

                    <td class="uncovered" >
                        <pre>         case static::class:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L201" class="number uncovered">201</th>

                    <td class="uncovered" >
                        <pre>            self::showDangerZone($item);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L202" class="number uncovered">202</th>

                    <td class="uncovered" >
                        <pre>            return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L203" class="number unreach">203</th>

                    <td class="unreach" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L204" class="number ">204</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L205" class="number uncovered">205</th>

                    <td class="uncovered" >
                        <pre>         case PluginFlyvemdmFleet::class:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L206" class="number uncovered">206</th>

                    <td class="uncovered" >
                        <pre>            self::showForFleet($item);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L207" class="number uncovered">207</th>

                    <td class="uncovered" >
                        <pre>            return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L208" class="number uncovered">208</th>

                    <td class="uncovered" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L209" class="number ">209</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L210" class="number uncovered">210</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L211" class="number ">211</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L212" class="number ">212</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L213" class="number ">213</th>

                    <td class="" >
                        <pre>    * Shows form for edition
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L214" class="number ">214</th>

                    <td class="" >
                        <pre>    * @param integer $ID Id of the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L215" class="number ">215</th>

                    <td class="" >
                        <pre>    * @param array $options
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L216" class="number ">216</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="showForm">
                    <th id="L217" class="number ">217</th>

                    <td class="" id="showForm">
                        <pre>   public function showForm($ID, array $options = []) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L218" class="number covered">218</th>

                    <td class="covered" >
                        <pre>      $this-&gt;initForm($ID, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L219" class="number covered">219</th>

                    <td class="covered" >
                        <pre>      $this-&gt;showFormHeader($options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L220" class="number covered">220</th>

                    <td class="covered" >
                        <pre>      $canUpdate = (!$this-&gt;isNewID($ID)) &amp;&amp; ($this-&gt;canUpdate() &gt; 0);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L221" class="number ">221</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L222" class="number covered">222</th>

                    <td class="covered" >
                        <pre>      $fields              = $this-&gt;fields;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L223" class="number covered">223</th>

                    <td class="covered" >
                        <pre>      $objectName          = (new DbUtils)-&gt;autoName($this-&gt;fields[&#039;name&#039;], &#039;name&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L224" class="number covered">224</th>

                    <td class="covered" >
                        <pre>                             (isset($options[&#039;withtemplate&#039;]) &amp;&amp; $options[&#039;withtemplate&#039;] == 2),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L225" class="number covered">225</th>

                    <td class="covered" >
                        <pre>                             $this-&gt;getType(), -1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L226" class="number covered">226</th>

                    <td class="covered" >
                        <pre>      $fields[&#039;name&#039;]      = Html::autocompletionTextField($this, &#039;name&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L227" class="number covered">227</th>

                    <td class="covered" >
                        <pre>                             [&#039;value&#039; =&gt; $objectName, &#039;display&#039; =&gt; false]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L228" class="number covered">228</th>

                    <td class="covered" >
                        <pre>      $fields[&#039;computer&#039;]  = Computer::dropdown([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L229" class="number covered">229</th>

                    <td class="covered" >
                        <pre>                                 &#039;display&#039;      =&gt; false,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L230" class="number covered">230</th>

                    <td class="covered" >
                        <pre>                                 &#039;name&#039;         =&gt; &#039;computers_id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L231" class="number covered">231</th>

                    <td class="covered" >
                        <pre>                                 &#039;value&#039;        =&gt; $this-&gt;fields[&#039;computers_id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L232" class="number covered">232</th>

                    <td class="covered" >
                        <pre>                                 &#039;entity&#039;       =&gt; $this-&gt;fields[&#039;entities_id&#039;]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L233" class="number ">233</th>

                    <td class="" >
                        <pre>                             ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L234" class="number covered">234</th>

                    <td class="covered" >
                        <pre>      $fields[&#039;fleet&#039;]     = PluginFlyvemdmFleet::dropdown([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L235" class="number covered">235</th>

                    <td class="covered" >
                        <pre>                                    &#039;display&#039;      =&gt; false,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L236" class="number covered">236</th>

                    <td class="covered" >
                        <pre>                                    &#039;name&#039;         =&gt; &#039;plugin_flyvemdm_fleets_id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L237" class="number covered">237</th>

                    <td class="covered" >
                        <pre>                                    &#039;value&#039;        =&gt; $this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L238" class="number covered">238</th>

                    <td class="covered" >
                        <pre>                                    &#039;entity&#039;       =&gt; $this-&gt;fields[&#039;entities_id&#039;]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L239" class="number ">239</th>

                    <td class="" >
                        <pre>                             ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L240" class="number covered">240</th>

                    <td class="covered" >
                        <pre>      if (empty($fields[&#039;last_contact&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L241" class="number covered">241</th>

                    <td class="covered" >
                        <pre>         $fields[&#039;last_contact&#039;] = __(&#039;Never seen online&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L242" class="number ">242</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L243" class="number ">243</th>

                    <td class="" >
                        <pre>      $data = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L244" class="number covered">244</th>

                    <td class="covered" >
                        <pre>            &#039;withTemplate&#039;    =&gt; (isset($options[&#039;withtemplate&#039;]) &amp;&amp; $options[&#039;withtemplate&#039;] ? &#039;*&#039; : &#039;&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L245" class="number covered">245</th>

                    <td class="covered" >
                        <pre>            &#039;isNewID&#039;         =&gt; $this-&gt;isNewID($ID),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L246" class="number covered">246</th>

                    <td class="covered" >
                        <pre>            &#039;canUpdate&#039;       =&gt; $canUpdate,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L247" class="number covered">247</th>

                    <td class="covered" >
                        <pre>            &#039;agent&#039;           =&gt; $fields,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L248" class="number covered">248</th>

                    <td class="covered" >
                        <pre>            &#039;pingButton&#039;      =&gt; Html::submit(_x(&#039;button&#039;, &#039;Ping&#039;), [&#039;name&#039; =&gt; &#039;ping&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L249" class="number covered">249</th>

                    <td class="covered" >
                        <pre>            &#039;geolocateButton&#039; =&gt; Html::submit(_x(&#039;button&#039;, &#039;Geolocate&#039;), [&#039;name&#039; =&gt; &#039;geolocate&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L250" class="number covered">250</th>

                    <td class="covered" >
                        <pre>            &#039;inventoryButton&#039; =&gt; Html::submit(_x(&#039;button&#039;, &#039;Inventory&#039;), [&#039;name&#039; =&gt; &#039;inventory&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L251" class="number ">251</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L252" class="number ">252</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L253" class="number covered">253</th>

                    <td class="covered" >
                        <pre>      $twig = plugin_flyvemdm_getTemplateEngine();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L254" class="number covered">254</th>

                    <td class="covered" >
                        <pre>      echo $twig-&gt;render(&#039;agent.html.twig&#039;, $data);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L255" class="number ">255</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L256" class="number covered">256</th>

                    <td class="covered" >
                        <pre>      $this-&gt;showFormButtons($options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L257" class="number covered">257</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L258" class="number ">258</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L259" class="number ">259</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L260" class="number ">260</th>

                    <td class="" >
                        <pre>    * Prints the computer&#039;s operating system form
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L261" class="number ">261</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L262" class="number ">262</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmAgent $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L263" class="number ">263</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L264" class="number ">264</th>

                    <td class="" >
                        <pre>    * @since version 9.1
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L265" class="number ">265</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="showDangerZone">
                    <th id="L266" class="number ">266</th>

                    <td class="" id="showDangerZone">
                        <pre>   public static function showDangerZone(PluginFlyvemdmAgent $item) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L267" class="number covered">267</th>

                    <td class="covered" >
                        <pre>      $ID = $item-&gt;fields[&#039;id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L268" class="number covered">268</th>

                    <td class="covered" >
                        <pre>      $item-&gt;initForm($ID);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L269" class="number covered">269</th>

                    <td class="covered" >
                        <pre>      $item-&gt;showFormHeader([&#039;formtitle&#039; =&gt; false]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L270" class="number covered">270</th>

                    <td class="covered" >
                        <pre>      $canedit = static::canUpdate();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L271" class="number ">271</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L272" class="number covered">272</th>

                    <td class="covered" >
                        <pre>      $fields              = $item-&gt;fields;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L273" class="number ">273</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L274" class="number covered">274</th>

                    <td class="covered" >
                        <pre>      $fields[&#039;lock&#039;]      = Html::getCheckbox([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L275" class="number covered">275</th>

                    <td class="covered" >
                        <pre>            &#039;title&#039;        =&gt; __(&#039;Lock the device as soon as possible&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L276" class="number covered">276</th>

                    <td class="covered" >
                        <pre>            &#039;name&#039;         =&gt; &#039;lock&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L277" class="number covered">277</th>

                    <td class="covered" >
                        <pre>            &#039;checked&#039;      =&gt; $item-&gt;fields[&#039;lock&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L278" class="number covered">278</th>

                    <td class="covered" >
                        <pre>            &#039;value&#039;        =&gt; &#039;1&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L279" class="number covered">279</th>

                    <td class="covered" >
                        <pre>            &#039;readonly&#039;     =&gt; ($canedit == &#039;0&#039; ? &#039;1&#039; : &#039;0&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L280" class="number ">280</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L281" class="number covered">281</th>

                    <td class="covered" >
                        <pre>      $fields[&#039;wipe&#039;]      = Html::getCheckbox([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L282" class="number covered">282</th>

                    <td class="covered" >
                        <pre>            &#039;title&#039;        =&gt; __(&#039;Wipe the device as soon as possible&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L283" class="number covered">283</th>

                    <td class="covered" >
                        <pre>            &#039;name&#039;         =&gt; &#039;wipe&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L284" class="number covered">284</th>

                    <td class="covered" >
                        <pre>            &#039;checked&#039;      =&gt; $item-&gt;fields[&#039;wipe&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L285" class="number covered">285</th>

                    <td class="covered" >
                        <pre>            &#039;value&#039;        =&gt; &#039;1&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L286" class="number covered">286</th>

                    <td class="covered" >
                        <pre>            &#039;readonly&#039;     =&gt; ($canedit == &#039;0&#039; ? &#039;1&#039; : &#039;0&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L287" class="number ">287</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L288" class="number ">288</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L289" class="number ">289</th>

                    <td class="" >
                        <pre>      $data = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L290" class="number covered">290</th>

                    <td class="covered" >
                        <pre>            &#039;withTemplate&#039;    =&gt; &#039;&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L291" class="number covered">291</th>

                    <td class="covered" >
                        <pre>            &#039;isNewID&#039;         =&gt; $item-&gt;isNewID($ID),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L292" class="number covered">292</th>

                    <td class="covered" >
                        <pre>            &#039;canUpdate&#039;       =&gt; (!$item-&gt;isNewID($ID)) &amp;&amp; ($item-&gt;canUpdate() &gt; 0),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L293" class="number covered">293</th>

                    <td class="covered" >
                        <pre>            &#039;agent&#039;           =&gt; $fields,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L294" class="number covered">294</th>

                    <td class="covered" >
                        <pre>            &#039;unenrollButton&#039;  =&gt; Html::submit(_x(&#039;button&#039;, &#039;Unenroll&#039;), [&#039;name&#039; =&gt; &#039;unenroll&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L295" class="number ">295</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L296" class="number ">296</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L297" class="number covered">297</th>

                    <td class="covered" >
                        <pre>      $twig = plugin_flyvemdm_getTemplateEngine();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L298" class="number covered">298</th>

                    <td class="covered" >
                        <pre>      echo $twig-&gt;render(&#039;agent_dangerzone.html.twig&#039;, $data);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L299" class="number ">299</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L300" class="number covered">300</th>

                    <td class="covered" >
                        <pre>      $item-&gt;showFormButtons([&#039;candel&#039; =&gt; false, &#039;formfooter&#039; =&gt; false]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L301" class="number covered">301</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L302" class="number ">302</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L303" class="number ">303</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L304" class="number ">304</th>

                    <td class="" >
                        <pre>    * Displays the agents according the fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L305" class="number ">305</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmFleet $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L306" class="number ">306</th>

                    <td class="" >
                        <pre>    * @return string an html with the agents
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L307" class="number ">307</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="showForFleet">
                    <th id="L308" class="number ">308</th>

                    <td class="" id="showForFleet">
                        <pre>   public static function showForFleet(PluginFlyvemdmFleet $item) {<span class="label label-success">95%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L309" class="number covered">309</th>

                    <td class="covered" >
                        <pre>      if (!PluginFlyvemdmFleet::canView()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L310" class="number uncovered">310</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L311" class="number ">311</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L312" class="number ">312</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L313" class="number covered">313</th>

                    <td class="covered" >
                        <pre>      $start = isset($_GET[&quot;start&quot;]) ? intval($_GET[&quot;start&quot;]) : 0;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L314" class="number ">314</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L315" class="number covered">315</th>

                    <td class="covered" >
                        <pre>      $dbUtils = new DbUtils();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L316" class="number ">316</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L317" class="number ">317</th>

                    <td class="" >
                        <pre>      // get items
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L318" class="number covered">318</th>

                    <td class="covered" >
                        <pre>      $agent = new PluginFlyvemdmAgent();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L319" class="number covered">319</th>

                    <td class="covered" >
                        <pre>      $items_id = $item-&gt;getField(&#039;id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L320" class="number covered">320</th>

                    <td class="covered" >
                        <pre>      $itemFk = $item::getForeignKeyField();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L321" class="number covered">321</th>

                    <td class="covered" >
                        <pre>      $condition = &quot;`$itemFk` = &#039;$items_id&#039; &quot; . $dbUtils-&gt;getEntitiesRestrictRequest();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L322" class="number covered">322</th>

                    <td class="covered" >
                        <pre>      $rows = $agent-&gt;find($condition);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L323" class="number covered">323</th>

                    <td class="covered" >
                        <pre>      $number = count($rows);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L324" class="number ">324</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L325" class="number ">325</th>

                    <td class="" >
                        <pre>      // get the pager
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L326" class="number covered">326</th>

                    <td class="covered" >
                        <pre>      $pager = Html::printAjaxPager(self::getTypeName(1), $start, $number, &#039;&#039;, false);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L327" class="number ">327</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L328" class="number ">328</th>

                    <td class="" >
                        <pre>      $data = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L329" class="number covered">329</th>

                    <td class="covered" >
                        <pre>         &#039;number&#039; =&gt; $number,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L330" class="number covered">330</th>

                    <td class="covered" >
                        <pre>         &#039;pager&#039;  =&gt; $pager,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L331" class="number covered">331</th>

                    <td class="covered" >
                        <pre>         &#039;agents&#039; =&gt; $rows,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L332" class="number covered">332</th>

                    <td class="covered" >
                        <pre>         &#039;start&#039;  =&gt; $start,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L333" class="number covered">333</th>

                    <td class="covered" >
                        <pre>         &#039;stop&#039;   =&gt; $start + $_SESSION[&#039;glpilist_limit&#039;]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L334" class="number ">334</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L335" class="number ">335</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L336" class="number covered">336</th>

                    <td class="covered" >
                        <pre>      $twig = plugin_flyvemdm_getTemplateEngine();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L337" class="number covered">337</th>

                    <td class="covered" >
                        <pre>      echo $twig-&gt;render(&#039;agent_fleet.html.twig&#039;, $data);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L338" class="number covered">338</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L339" class="number ">339</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L340" class="number ">340</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L341" class="number ">341</th>

                    <td class="" >
                        <pre>    * Shows informations about the agent linhked to a computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L342" class="number ">342</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L343" class="number ">343</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L344" class="number ">344</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="displayTabContentForComputer">
                    <th id="L345" class="number ">345</th>

                    <td class="" id="displayTabContentForComputer">
                        <pre>   public static function displayTabContentForComputer(CommonDBTM $item) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L346" class="number uncovered">346</th>

                    <td class="uncovered" >
                        <pre>      $agent = new static();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L347" class="number uncovered">347</th>

                    <td class="uncovered" >
                        <pre>      if (!$agent-&gt;getFromDBByCrit([&#039;computers_id&#039; =&gt; $item-&gt;getID()])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L348" class="number uncovered">348</th>

                    <td class="uncovered" >
                        <pre>         return;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L349" class="number ">349</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L350" class="number uncovered">350</th>

                    <td class="uncovered" >
                        <pre>      $fields = $agent-&gt;fields;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L351" class="number uncovered">351</th>

                    <td class="uncovered" >
                        <pre>      $fields[&#039;fleet&#039;]=$agent-&gt;getFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L352" class="number uncovered">352</th>

                    <td class="uncovered" >
                        <pre>      if (empty($fields[&#039;last_contact&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L353" class="number uncovered">353</th>

                    <td class="uncovered" >
                        <pre>         $fields[&#039;last_contact&#039;] = __(&#039;Never seen online&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L354" class="number ">354</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L355" class="number uncovered">355</th>

                    <td class="uncovered" >
                        <pre>      $twig = plugin_flyvemdm_getTemplateEngine();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L356" class="number uncovered">356</th>

                    <td class="uncovered" >
                        <pre>      echo $twig-&gt;render(&#039;agentComputerInfo.html.twig&#039;, [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L357" class="number uncovered">357</th>

                    <td class="uncovered" >
                        <pre>         &#039;agent&#039; =&gt; $fields,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L358" class="number uncovered">358</th>

                    <td class="uncovered" >
                        <pre>         &#039;agentUrl&#039; =&gt; Toolbox::getItemTypeFormURL(self::class),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L359" class="number uncovered">359</th>

                    <td class="uncovered" >
                        <pre>         &#039;fleetUrl&#039; =&gt; Toolbox::getItemTypeFormURL(PluginFlyvemdmFleet::class)</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L360" class="number ">360</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L361" class="number uncovered">361</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L362" class="number ">362</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="canViewItem">
                    <th id="L363" class="number ">363</th>

                    <td class="" id="canViewItem">
                        <pre>   public function canViewItem() {<span class="label label-warning">56%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L364" class="number ">364</th>

                    <td class="" >
                        <pre>      // Check the active profile
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L365" class="number covered">365</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;guest_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L366" class="number covered">366</th>

                    <td class="covered" >
                        <pre>      if ($_SESSION[&#039;glpiactiveprofile&#039;][&#039;id&#039;] != $config[&#039;guest_profiles_id&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L367" class="number covered">367</th>

                    <td class="covered" >
                        <pre>         return parent::canViewItem();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L368" class="number ">368</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L369" class="number ">369</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L370" class="number covered">370</th>

                    <td class="covered" >
                        <pre>      if (!$this-&gt;checkEntity(true)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L371" class="number covered">371</th>

                    <td class="covered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L372" class="number ">372</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L373" class="number ">373</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L374" class="number ">374</th>

                    <td class="" >
                        <pre>      // the active profile is guest user, then check the user is
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L375" class="number ">375</th>

                    <td class="" >
                        <pre>      // owner of the item&#039;s computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L376" class="number uncovered">376</th>

                    <td class="uncovered" >
                        <pre>      $computer = $this-&gt;getComputer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L377" class="number uncovered">377</th>

                    <td class="uncovered" >
                        <pre>      if ($computer === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L378" class="number uncovered">378</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L379" class="number ">379</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L380" class="number ">380</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L381" class="number uncovered">381</th>

                    <td class="uncovered" >
                        <pre>      return $_SESSION[&#039;glpiID&#039;] == $computer-&gt;getField(&#039;users_id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L382" class="number unreach">382</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L383" class="number ">383</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L384" class="number ">384</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L385" class="number ">385</th>

                    <td class="" >
                        <pre>    * Sends a wipe command to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L386" class="number ">386</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendWipeQuery">
                    <th id="L387" class="number ">387</th>

                    <td class="" id="sendWipeQuery">
                        <pre>   protected function sendWipeQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L388" class="number uncovered">388</th>

                    <td class="uncovered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L389" class="number uncovered">389</th>

                    <td class="uncovered" >
                        <pre>      if ($topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L390" class="number uncovered">390</th>

                    <td class="uncovered" >
                        <pre>         $mqttMessage = [&#039;wipe&#039; =&gt; &#039;now&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L391" class="number uncovered">391</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;notify(&quot;$topic/Command/Wipe&quot;, json_encode($mqttMessage, JSON_UNESCAPED_SLASHES), 0, 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L392" class="number ">392</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L393" class="number uncovered">393</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L394" class="number ">394</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L395" class="number ">395</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L396" class="number ">396</th>

                    <td class="" >
                        <pre>    * Sends a lock command to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L397" class="number ">397</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendLockQuery">
                    <th id="L398" class="number ">398</th>

                    <td class="" id="sendLockQuery">
                        <pre>   protected function sendLockQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L399" class="number uncovered">399</th>

                    <td class="uncovered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L400" class="number uncovered">400</th>

                    <td class="uncovered" >
                        <pre>      if ($topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L401" class="number uncovered">401</th>

                    <td class="uncovered" >
                        <pre>         $mqttMessage = [&#039;lock&#039; =&gt; &#039;now&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L402" class="number uncovered">402</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;notify(&quot;$topic/Command/Lock&quot;, json_encode($mqttMessage, JSON_UNESCAPED_SLASHES), 0, 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L403" class="number ">403</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L404" class="number uncovered">404</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L405" class="number ">405</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L406" class="number ">406</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L407" class="number ">407</th>

                    <td class="" >
                        <pre>    * Sends a lock command to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L408" class="number ">408</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendUnlockQuery">
                    <th id="L409" class="number ">409</th>

                    <td class="" id="sendUnlockQuery">
                        <pre>   protected function sendUnlockQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L410" class="number uncovered">410</th>

                    <td class="uncovered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L411" class="number uncovered">411</th>

                    <td class="uncovered" >
                        <pre>      if ($topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L412" class="number uncovered">412</th>

                    <td class="uncovered" >
                        <pre>         $mqttMessage = [&#039;lock&#039; =&gt; &#039;unlock&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L413" class="number uncovered">413</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;notify(&quot;$topic/Command/Lock&quot;, json_encode($mqttMessage, JSON_UNESCAPED_SLASHES), 0, 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L414" class="number ">414</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L415" class="number uncovered">415</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L416" class="number ">416</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L417" class="number ">417</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L418" class="number ">418</th>

                    <td class="" >
                        <pre>    * Sends unenrollment command to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L419" class="number ">419</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendUnenrollQuery">
                    <th id="L420" class="number ">420</th>

                    <td class="" id="sendUnenrollQuery">
                        <pre>   protected function sendUnenrollQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L421" class="number uncovered">421</th>

                    <td class="uncovered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L422" class="number uncovered">422</th>

                    <td class="uncovered" >
                        <pre>      if ($topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L423" class="number uncovered">423</th>

                    <td class="uncovered" >
                        <pre>         $mqttMessage = [&#039;unenroll&#039; =&gt; &#039;now&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L424" class="number uncovered">424</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;notify(&quot;$topic/Command/Unenroll&quot;, json_encode($mqttMessage, JSON_UNESCAPED_SLASHES), 0, 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L425" class="number ">425</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L426" class="number uncovered">426</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L427" class="number ">427</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="prepareInputForAdd">
                    <th id="L428" class="number ">428</th>

                    <td class="" id="prepareInputForAdd">
                        <pre>   public function prepareInputForAdd($input) {<span class="label label-warning">53%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L429" class="number ">429</th>

                    <td class="" >
                        <pre>      // Get the maximum quantity of devices allowed for the current entity
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L430" class="number covered">430</th>

                    <td class="covered" >
                        <pre>      $entityConfig = new PluginFlyvemdmEntityConfig();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L431" class="number covered">431</th>

                    <td class="covered" >
                        <pre>      if (!$entityConfig-&gt;getFromDBOrCreate($_SESSION[&#039;glpiactive_entity&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L432" class="number uncovered">432</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages(Session::addMessageAfterRedirect(__(&#039;Failed to read configuration of the entity&#039;, &#039;flyvemdm&#039;)));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L433" class="number uncovered">433</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L434" class="number ">434</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L435" class="number ">435</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L436" class="number covered">436</th>

                    <td class="covered" >
                        <pre>      if (!$entityConfig-&gt;canAddAgent($_SESSION[&#039;glpiactive_entity&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L437" class="number ">437</th>

                    <td class="" >
                        <pre>         // Too many devices
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L438" class="number uncovered">438</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages(Session::addMessageAfterRedirect(__(&#039;Too many devices&#039;, &#039;flyvemdm&#039;)));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L439" class="number uncovered">439</th>

                    <td class="uncovered" >
                        <pre>         $input = false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L440" class="number ">440</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L441" class="number ">441</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L442" class="number ">442</th>

                    <td class="" >
                        <pre>      // User already logged in : user token has been validated
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L443" class="number covered">443</th>

                    <td class="covered" >
                        <pre>      ini_set(&quot;memory_limit&quot;, &quot;-1&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L444" class="number covered">444</th>

                    <td class="covered" >
                        <pre>      ini_set(&quot;max_execution_time&quot;, &quot;0&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L445" class="number covered">445</th>

                    <td class="covered" >
                        <pre>      switch ($this-&gt;chooseEnrollMethod($input)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L446" class="number ">446</th>

                    <td class="" >
                        <pre>         case self::ENROLL_DENY:
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L447" class="number uncovered">447</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;filterMessages(Session::addMessageAfterRedirect(__(&#039;Unable to find a enrollment method&#039;, &#039;flyvemdm&#039;)));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L448" class="number uncovered">448</th>

                    <td class="uncovered" >
                        <pre>            $input = false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L449" class="number uncovered">449</th>

                    <td class="uncovered" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L450" class="number ">450</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L451" class="number ">451</th>

                    <td class="" >
                        <pre>         case self::ENROLL_INVITATION_TOKEN:
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L452" class="number covered">452</th>

                    <td class="covered" >
                        <pre>            $input = $this-&gt;enrollByInvitationToken($input);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L453" class="number covered">453</th>

                    <td class="covered" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L454" class="number ">454</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L455" class="number ">455</th>

                    <td class="" >
                        <pre>         case self::ENROLL_ENTITY_TOKEN:
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L456" class="number ">456</th>

                    <td class="" >
                        <pre>            // Method disabled, waiting for implementation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L457" class="number uncovered">457</th>

                    <td class="uncovered" >
                        <pre>            $input = false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L458" class="number uncovered">458</th>

                    <td class="uncovered" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L459" class="number ">459</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L460" class="number ">460</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L461" class="number covered">461</th>

                    <td class="covered" >
                        <pre>      unset($input[&#039;is_online&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L462" class="number ">462</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L463" class="number covered">463</th>

                    <td class="covered" >
                        <pre>      return $input;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L464" class="number unreach">464</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L465" class="number ">465</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="prepareInputForUpdate">
                    <th id="L466" class="number ">466</th>

                    <td class="" id="prepareInputForUpdate">
                        <pre>   public function prepareInputForUpdate($input) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L467" class="number uncovered">467</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L468" class="number ">468</th>

                    <td class="" >
                        <pre>         // Update MQTT ACL for the fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L469" class="number uncovered">469</th>

                    <td class="uncovered" >
                        <pre>         $oldFleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L470" class="number uncovered">470</th>

                    <td class="uncovered" >
                        <pre>         if (!$oldFleet-&gt;getFromDB($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L471" class="number ">471</th>

                    <td class="" >
                        <pre>            // Unable to load fleet currently associated to  the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L472" class="number uncovered">472</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&quot;The fleet of the device does not longer exists&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L473" class="number uncovered">473</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L474" class="number ">474</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L475" class="number ">475</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L476" class="number uncovered">476</th>

                    <td class="uncovered" >
                        <pre>         $newFleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L477" class="number uncovered">477</th>

                    <td class="uncovered" >
                        <pre>         if (!$newFleet-&gt;getFromDB($input[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L478" class="number ">478</th>

                    <td class="" >
                        <pre>            //Unable to load the new fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L479" class="number uncovered">479</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&quot;The target fleet does not exists&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L480" class="number uncovered">480</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L481" class="number ">481</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L482" class="number ">482</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L483" class="number uncovered">483</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;changeMqttAcl($oldFleet, $newFleet);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L484" class="number ">484</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L485" class="number ">485</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L486" class="number ">486</th>

                    <td class="" >
                        <pre>      // send wipe to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L487" class="number uncovered">487</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;wipe&#039;]) &amp;&amp; $input[&#039;wipe&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L488" class="number uncovered">488</th>

                    <td class="uncovered" >
                        <pre>         $input[&#039;wipe&#039;] = &#039;1&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L489" class="number ">489</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L490" class="number ">490</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L491" class="number ">491</th>

                    <td class="" >
                        <pre>      // send lock to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L492" class="number uncovered">492</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;lock&#039;]) &amp;&amp; $input[&#039;lock&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L493" class="number uncovered">493</th>

                    <td class="uncovered" >
                        <pre>         $input[&#039;lock&#039;] = &#039;1&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L494" class="number ">494</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L495" class="number ">495</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L496" class="number uncovered">496</th>

                    <td class="uncovered" >
                        <pre>      if (array_key_exists(&#039;lock&#039;, $input)</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L497" class="number uncovered">497</th>

                    <td class="uncovered" >
                        <pre>          &amp;&amp; ($this-&gt;fields[&#039;wipe&#039;] != &#039;0&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L498" class="number uncovered">498</th>

                    <td class="uncovered" >
                        <pre>              || (isset($input[&#039;wipe&#039;]) &amp;&amp; $input[&#039;wipe&#039;] != &#039;0&#039;) )) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L499" class="number uncovered">499</th>

                    <td class="uncovered" >
                        <pre>         unset($input[&#039;lock&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L500" class="number ">500</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L501" class="number ">501</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L502" class="number uncovered">502</th>

                    <td class="uncovered" >
                        <pre>      unset($input[&#039;enroll_status&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L503" class="number uncovered">503</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;_unenroll&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L504" class="number uncovered">504</th>

                    <td class="uncovered" >
                        <pre>         $input[&#039;enroll_status&#039;] = &#039;unenrolling&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L505" class="number ">505</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L506" class="number ">506</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L507" class="number ">507</th>

                    <td class="" >
                        <pre>      //Send a connection status request to the device
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L508" class="number uncovered">508</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;_ping&#039;]) || isset($input[&#039;_geolocate&#039;]) || isset($input[&#039;_inventory&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L509" class="number uncovered">509</th>

                    <td class="uncovered" >
                        <pre>         if ($this-&gt;getTopic() === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L510" class="number uncovered">510</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&quot;The device is not enrolled yet&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L511" class="number uncovered">511</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L512" class="number ">512</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L513" class="number ">513</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L514" class="number ">514</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L515" class="number uncovered">515</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;_ping&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L516" class="number ">516</th>

                    <td class="" >
                        <pre>         try {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L517" class="number uncovered">517</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;sendPingQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L518" class="number uncovered">518</th>

                    <td class="uncovered" >
                        <pre>         } catch (AgentSendQueryException $exception) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L519" class="number uncovered">519</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect($exception-&gt;getMessage());</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L520" class="number uncovered">520</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L521" class="number ">521</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L522" class="number ">522</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L523" class="number ">523</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L524" class="number uncovered">524</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;_geolocate&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L525" class="number ">525</th>

                    <td class="" >
                        <pre>         try {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L526" class="number uncovered">526</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;sendGeolocationQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L527" class="number uncovered">527</th>

                    <td class="uncovered" >
                        <pre>         } catch (AgentSendQueryException $exception) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L528" class="number uncovered">528</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect($exception-&gt;getMessage());</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L529" class="number uncovered">529</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L530" class="number ">530</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L531" class="number ">531</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L532" class="number ">532</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L533" class="number uncovered">533</th>

                    <td class="uncovered" >
                        <pre>      if (isset($input[&#039;_inventory&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L534" class="number ">534</th>

                    <td class="" >
                        <pre>         try {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L535" class="number uncovered">535</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;sendInventoryQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L536" class="number uncovered">536</th>

                    <td class="uncovered" >
                        <pre>         } catch (AgentSendQueryException $exception) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L537" class="number uncovered">537</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect($exception-&gt;getMessage());</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L538" class="number uncovered">538</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L539" class="number ">539</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L540" class="number ">540</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L541" class="number ">541</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L542" class="number uncovered">542</th>

                    <td class="uncovered" >
                        <pre>      return $input;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L543" class="number unreach">543</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L544" class="number ">544</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_addItem">
                    <th id="L545" class="number ">545</th>

                    <td class="" id="post_addItem">
                        <pre>   public function post_addItem() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L546" class="number ">546</th>

                    <td class="" >
                        <pre>      // Notify the agent about its fleets
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L547" class="number covered">547</th>

                    <td class="covered" >
                        <pre>      $this-&gt;updateSubscription();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L548" class="number covered">548</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L549" class="number ">549</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_getFromDB">
                    <th id="L550" class="number ">550</th>

                    <td class="" id="post_getFromDB">
                        <pre>   public function post_getFromDB() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L551" class="number ">551</th>

                    <td class="" >
                        <pre>      // set Topic after getting an item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L552" class="number ">552</th>

                    <td class="" >
                        <pre>      // Useful for post_purgeItem
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L553" class="number covered">553</th>

                    <td class="covered" >
                        <pre>      $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L554" class="number covered">554</th>

                    <td class="covered" >
                        <pre>      $this-&gt;setupMqttAccess();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L555" class="number covered">555</th>

                    <td class="covered" >
                        <pre>      $this-&gt;fields[&#039;api_token&#039;] = User::getToken($this-&gt;fields[&#039;users_id&#039;], &#039;api_token&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L556" class="number covered">556</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L557" class="number ">557</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L558" class="number ">558</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L559" class="number ">559</th>

                    <td class="" >
                        <pre>    * Actions done before the DELETE of the item in the database /
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L560" class="number ">560</th>

                    <td class="" >
                        <pre>    * Maybe used to add another check for deletion
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L561" class="number ">561</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L562" class="number ">562</th>

                    <td class="" >
                        <pre>    * @return bool : true if item need to be deleted else false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L563" class="number ">563</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="pre_deleteItem">
                    <th id="L564" class="number ">564</th>

                    <td class="" id="pre_deleteItem">
                        <pre>   public function pre_deleteItem() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L565" class="number ">565</th>

                    <td class="" >
                        <pre>      // get serial of the computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L566" class="number uncovered">566</th>

                    <td class="uncovered" >
                        <pre>      $computer = $this-&gt;getComputer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L567" class="number uncovered">567</th>

                    <td class="uncovered" >
                        <pre>      if ($computer === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L568" class="number ">568</th>

                    <td class="" >
                        <pre>         // The associated computer is already deleted
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L569" class="number uncovered">569</th>

                    <td class="uncovered" >
                        <pre>         return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L570" class="number ">570</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L571" class="number ">571</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L572" class="number ">572</th>

                    <td class="" >
                        <pre>      // get the guest profile ID
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L573" class="number uncovered">573</th>

                    <td class="uncovered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;guest_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L574" class="number uncovered">574</th>

                    <td class="uncovered" >
                        <pre>      $guestProfileId = $config[&#039;guest_profiles_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L575" class="number uncovered">575</th>

                    <td class="uncovered" >
                        <pre>      if ($guestProfileId === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L576" class="number uncovered">576</th>

                    <td class="uncovered" >
                        <pre>         Session::addMessageAfterRedirect(__(&#039;Failed to find the guest user profile&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L577" class="number uncovered">577</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L578" class="number ">578</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L579" class="number ">579</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L580" class="number uncovered">580</th>

                    <td class="uncovered" >
                        <pre>      $computerId = $computer-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L581" class="number uncovered">581</th>

                    <td class="uncovered" >
                        <pre>      $serial = $computer-&gt;getField(&#039;serial&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L582" class="number uncovered">582</th>

                    <td class="uncovered" >
                        <pre>      $entityId = $this-&gt;getField(&#039;entities_id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L583" class="number uncovered">583</th>

                    <td class="uncovered" >
                        <pre>      $ownerUserId = $computer-&gt;getField(&#039;users_id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L584" class="number ">584</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L585" class="number ">585</th>

                    <td class="" >
                        <pre>      // Find other computers belong to the user in the current entity
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L586" class="number ">586</th>

                    <td class="" >
                        <pre>      // TODO : maybe use getEntityRestrict for multientity support
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L587" class="number uncovered">587</th>

                    <td class="uncovered" >
                        <pre>      $rows = $computer-&gt;find(&quot;`entities_id`=&#039;$entityId&#039; AND `users_id`=&#039;$ownerUserId&#039; AND `id` &lt;&gt; &#039;$computerId&#039;&quot;, &#039;&#039;, &#039;1&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L588" class="number uncovered">588</th>

                    <td class="uncovered" >
                        <pre>      if (count($rows) == 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L589" class="number ">589</th>

                    <td class="" >
                        <pre>         // Remove guest habilitation for the entity
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L590" class="number uncovered">590</th>

                    <td class="uncovered" >
                        <pre>         $profile_User = new Profile_User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L591" class="number uncovered">591</th>

                    <td class="uncovered" >
                        <pre>         $success = $profile_User-&gt;deleteByCriteria([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L592" class="number uncovered">592</th>

                    <td class="uncovered" >
                        <pre>               &#039;users_id&#039;        =&gt; $ownerUserId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L593" class="number uncovered">593</th>

                    <td class="uncovered" >
                        <pre>               &#039;entities_id&#039;     =&gt; $entityId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L594" class="number uncovered">594</th>

                    <td class="uncovered" >
                        <pre>               &#039;profiles_id&#039;     =&gt; $guestProfileId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L595" class="number uncovered">595</th>

                    <td class="uncovered" >
                        <pre>               &#039;is_dynamic&#039;      =&gt; 0</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L596" class="number ">596</th>

                    <td class="" >
                        <pre>         ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L597" class="number uncovered">597</th>

                    <td class="uncovered" >
                        <pre>         if (!$success) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L598" class="number uncovered">598</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&#039;Failed to remove guest habilitation for the user of the device&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L599" class="number uncovered">599</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L600" class="number ">600</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L601" class="number ">601</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L602" class="number ">602</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L603" class="number ">603</th>

                    <td class="" >
                        <pre>      // Delete the user account of the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L604" class="number uncovered">604</th>

                    <td class="uncovered" >
                        <pre>      $agentUser = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L605" class="number uncovered">605</th>

                    <td class="uncovered" >
                        <pre>      $agentUser-&gt;delete([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L606" class="number uncovered">606</th>

                    <td class="uncovered" >
                        <pre>            &#039;id&#039;  =&gt; $this-&gt;fields[&#039;users_id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L607" class="number uncovered">607</th>

                    <td class="uncovered" >
                        <pre>      ], true);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L608" class="number ">608</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L609" class="number ">609</th>

                    <td class="" >
                        <pre>      // Send unrolling message to reset agent status
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L610" class="number uncovered">610</th>

                    <td class="uncovered" >
                        <pre>      if ($this-&gt;fields[&#039;enroll_status&#039;] == &#039;enrolled&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L611" class="number uncovered">611</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendUnenrollQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L612" class="number ">612</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L613" class="number ">613</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L614" class="number ">614</th>

                    <td class="" >
                        <pre>      // Delete the MQTT user for the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L615" class="number uncovered">615</th>

                    <td class="uncovered" >
                        <pre>      if (!empty($serial)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L616" class="number uncovered">616</th>

                    <td class="uncovered" >
                        <pre>         $mqttUser = new PluginFlyvemdmMqttuser();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L617" class="number uncovered">617</th>

                    <td class="uncovered" >
                        <pre>         if ($mqttUser-&gt;getFromDBByCrit([&#039;user&#039; =&gt; $serial])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L618" class="number uncovered">618</th>

                    <td class="uncovered" >
                        <pre>            if (!$mqttUser-&gt;delete([&#039;id&#039; =&gt; $mqttUser-&gt;getID()], true)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L619" class="number uncovered">619</th>

                    <td class="uncovered" >
                        <pre>               Session::addMessageAfterRedirect(__(&#039;Failed to delete MQTT user for the device&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L620" class="number uncovered">620</th>

                    <td class="uncovered" >
                        <pre>               return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L621" class="number ">621</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L622" class="number ">622</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L623" class="number ">623</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L624" class="number ">624</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L625" class="number ">625</th>

                    <td class="" >
                        <pre>      // Delete documents associated to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L626" class="number uncovered">626</th>

                    <td class="uncovered" >
                        <pre>      $document_Item = new Document_Item();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L627" class="number uncovered">627</th>

                    <td class="uncovered" >
                        <pre>      $success = $document_Item-&gt;deleteByCriteria([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L628" class="number uncovered">628</th>

                    <td class="uncovered" >
                        <pre>            &#039;itemtype&#039;  =&gt; PluginFlyvemdmAgent::class,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L629" class="number uncovered">629</th>

                    <td class="uncovered" >
                        <pre>            &#039;items_id&#039;  =&gt; $this-&gt;fields[&#039;id&#039;]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L630" class="number ">630</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L631" class="number uncovered">631</th>

                    <td class="uncovered" >
                        <pre>      if (!$success) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L632" class="number uncovered">632</th>

                    <td class="uncovered" >
                        <pre>         Session::addMessageAfterRedirect(__(&#039;Failed to delete documents attached to the device&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L633" class="number uncovered">633</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L634" class="number ">634</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L635" class="number ">635</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L636" class="number uncovered">636</th>

                    <td class="uncovered" >
                        <pre>      return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L637" class="number unreach">637</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L638" class="number ">638</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L639" class="number ">639</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L640" class="number ">640</th>

                    <td class="" >
                        <pre>    * Actions done after the UPDATE of the item in the database
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L641" class="number ">641</th>

                    <td class="" >
                        <pre>    * @param integer $history store changes history ? (default 1)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L642" class="number ">642</th>

                    <td class="" >
                        <pre>    * @return void
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L643" class="number ">643</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_updateItem">
                    <th id="L644" class="number ">644</th>

                    <td class="" id="post_updateItem">
                        <pre>   public function post_updateItem($history = 1) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L645" class="number uncovered">645</th>

                    <td class="uncovered" >
                        <pre>      if (in_array(&#039;plugin_flyvemdm_fleets_id&#039;, $this-&gt;updates)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L646" class="number uncovered">646</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;updateSubscription();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L647" class="number uncovered">647</th>

                    <td class="uncovered" >
                        <pre>         $newFleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L648" class="number uncovered">648</th>

                    <td class="uncovered" >
                        <pre>         if ($newFleet-&gt;getFromDB($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L649" class="number ">649</th>

                    <td class="" >
                        <pre>            // Create task status for the agent and the applied policies
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L650" class="number uncovered">650</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;createTaskStatuses($newFleet);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L651" class="number ">651</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L652" class="number ">652</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L653" class="number ">653</th>

                    <td class="" >
                        <pre>         // update tasks for the agent from already applied policies in the old fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L654" class="number uncovered">654</th>

                    <td class="uncovered" >
                        <pre>         if (isset($this-&gt;oldvalues[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L655" class="number uncovered">655</th>

                    <td class="uncovered" >
                        <pre>            $oldFleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L656" class="number uncovered">656</th>

                    <td class="uncovered" >
                        <pre>            $oldFleet-&gt;getFromDB($this-&gt;oldvalues[&#039;plugin_flyvemdm_fleets_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L657" class="number uncovered">657</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;cancelTaskStatuses($oldFleet);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L658" class="number ">658</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L659" class="number ">659</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L660" class="number ">660</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L661" class="number ">661</th>

                    <td class="" >
                        <pre>      // If both wipe and lock are enabled for the device, only send wipe command
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L662" class="number uncovered">662</th>

                    <td class="uncovered" >
                        <pre>      if (in_array(&#039;wipe&#039;, $this-&gt;updates) &amp;&amp; $this-&gt;fields[&#039;wipe&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L663" class="number uncovered">663</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendWipeQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L664" class="number ">664</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L665" class="number ">665</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L666" class="number uncovered">666</th>

                    <td class="uncovered" >
                        <pre>      if (in_array(&#039;lock&#039;, $this-&gt;updates) &amp;&amp; $this-&gt;fields[&#039;wipe&#039;] == &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L667" class="number uncovered">667</th>

                    <td class="uncovered" >
                        <pre>         if ($this-&gt;fields[&#039;lock&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L668" class="number uncovered">668</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;sendLockQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L669" class="number ">669</th>

                    <td class="" >
                        <pre>         } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L670" class="number uncovered">670</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;sendUnlockQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L671" class="number ">671</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L672" class="number ">672</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L673" class="number ">673</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L674" class="number uncovered">674</th>

                    <td class="uncovered" >
                        <pre>      if (in_array(&#039;enroll_status&#039;, $this-&gt;updates) &amp;&amp; $this-&gt;fields[&#039;enroll_status&#039;] == &#039;unenrolling&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L675" class="number uncovered">675</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendUnenrollQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L676" class="number ">676</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L677" class="number uncovered">677</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L678" class="number ">678</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L679" class="number ">679</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L680" class="number ">680</th>

                    <td class="" >
                        <pre>    * creates task statuses for the agent and the associated fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L681" class="number ">681</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmNotifiableInterface $notifiable
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L682" class="number ">682</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="createTaskStatuses">
                    <th id="L683" class="number ">683</th>

                    <td class="" id="createTaskStatuses">
                        <pre>   private function createTaskStatuses(PluginFlyvemdmNotifiableInterface $notifiable) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L684" class="number uncovered">684</th>

                    <td class="uncovered" >
                        <pre>      $notifiableType = $notifiable-&gt;getType();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L685" class="number uncovered">685</th>

                    <td class="uncovered" >
                        <pre>      $notifiableId = $notifiable-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L686" class="number uncovered">686</th>

                    <td class="uncovered" >
                        <pre>      $task = new PluginFlyvemdmTask();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L687" class="number uncovered">687</th>

                    <td class="uncovered" >
                        <pre>      $rows = $task-&gt;find(&quot;`itemtype_applied` = &#039;$notifiableType&#039; AND `items_id_applied` = &#039;$notifiableId&#039;&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L688" class="number uncovered">688</th>

                    <td class="uncovered" >
                        <pre>      foreach ($rows as $row) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L689" class="number uncovered">689</th>

                    <td class="uncovered" >
                        <pre>         $taskStatus = new PluginFlyvemdmTaskstatus();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L690" class="number uncovered">690</th>

                    <td class="uncovered" >
                        <pre>         $taskStatus-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L691" class="number uncovered">691</th>

                    <td class="uncovered" >
                        <pre>            &#039;plugin_flyvemdm_agents_id&#039; =&gt; $this-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L692" class="number uncovered">692</th>

                    <td class="uncovered" >
                        <pre>            &#039;plugin_flyvemdm_tasks_id&#039;  =&gt; $row[&#039;id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L693" class="number uncovered">693</th>

                    <td class="uncovered" >
                        <pre>            &#039;status&#039;                    =&gt; &#039;pending&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L694" class="number ">694</th>

                    <td class="" >
                        <pre>         ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L695" class="number ">695</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L696" class="number uncovered">696</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L697" class="number ">697</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L698" class="number ">698</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L699" class="number ">699</th>

                    <td class="" >
                        <pre>    * cancels task statuses for the agent anf the given fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L700" class="number ">700</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmNotifiableInterface $notifiable
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L701" class="number ">701</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="cancelTaskStatuses">
                    <th id="L702" class="number ">702</th>

                    <td class="" id="cancelTaskStatuses">
                        <pre>   private function cancelTaskStatuses(PluginFlyvemdmNotifiableInterface $notifiable) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L703" class="number uncovered">703</th>

                    <td class="uncovered" >
                        <pre>      global $DB;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L704" class="number ">704</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L705" class="number uncovered">705</th>

                    <td class="uncovered" >
                        <pre>      $notifiableId = $notifiable-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L706" class="number uncovered">706</th>

                    <td class="uncovered" >
                        <pre>      $taskStatusTable = PluginFlyvemdmTaskstatus::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L707" class="number uncovered">707</th>

                    <td class="uncovered" >
                        <pre>      $taskTable = PluginFlyvemdmTask::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L708" class="number ">708</th>

                    <td class="" >
                        <pre>      $request = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L709" class="number uncovered">709</th>

                    <td class="uncovered" >
                        <pre>         &#039;SELECT&#039;     =&gt; $taskStatusTable . &#039;.*&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L710" class="number uncovered">710</th>

                    <td class="uncovered" >
                        <pre>         &#039;FROM&#039;       =&gt; $taskStatusTable,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L711" class="number ">711</th>

                    <td class="" >
                        <pre>         &#039;INNER JOIN&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L712" class="number ">712</th>

                    <td class="" >
                        <pre>            $taskTable =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L713" class="number ">713</th>

                    <td class="" >
                        <pre>               &#039;FKEY&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L714" class="number uncovered">714</th>

                    <td class="uncovered" >
                        <pre>                  $taskTable       =&gt; &#039;id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L715" class="number uncovered">715</th>

                    <td class="uncovered" >
                        <pre>                  $taskStatusTable =&gt; PluginFlyvemdmTask::getForeignKeyField(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L716" class="number ">716</th>

                    <td class="" >
                        <pre>               ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L717" class="number ">717</th>

                    <td class="" >
                        <pre>            ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L718" class="number ">718</th>

                    <td class="" >
                        <pre>         ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L719" class="number ">719</th>

                    <td class="" >
                        <pre>         &#039;WHERE&#039;      =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L720" class="number uncovered">720</th>

                    <td class="uncovered" >
                        <pre>            &#039;items_id_applied&#039; =&gt; [$notifiableId],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L721" class="number ">721</th>

                    <td class="" >
                        <pre>         ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L722" class="number ">722</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L723" class="number uncovered">723</th>

                    <td class="uncovered" >
                        <pre>      $status = new PluginFlyvemdmTaskstatus();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L724" class="number uncovered">724</th>

                    <td class="uncovered" >
                        <pre>      foreach ($DB-&gt;request($request) as $row) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L725" class="number uncovered">725</th>

                    <td class="uncovered" >
                        <pre>         $status-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L726" class="number uncovered">726</th>

                    <td class="uncovered" >
                        <pre>            &#039;id&#039; =&gt; $row[&#039;id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L727" class="number uncovered">727</th>

                    <td class="uncovered" >
                        <pre>            &#039;status&#039; =&gt; &#039;canceled&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L728" class="number ">728</th>

                    <td class="" >
                        <pre>         ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L729" class="number ">729</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L730" class="number uncovered">730</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L731" class="number ">731</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L732" class="number ">732</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L733" class="number ">733</th>

                    <td class="" >
                        <pre>    * Actions done after the restore of the item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L734" class="number ">734</th>

                    <td class="" >
                        <pre>    * @return void
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L735" class="number ">735</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_restoreItem">
                    <th id="L736" class="number ">736</th>

                    <td class="" id="post_restoreItem">
                        <pre>   public function post_restoreItem() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L737" class="number ">737</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L738" class="number uncovered">738</th>

                    <td class="uncovered" >
                        <pre>      $computer = $this-&gt;getComputer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L739" class="number uncovered">739</th>

                    <td class="uncovered" >
                        <pre>      if ($computer !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L740" class="number uncovered">740</th>

                    <td class="uncovered" >
                        <pre>         $mqttUser = new PluginFlyvemdmMqttuser();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L741" class="number uncovered">741</th>

                    <td class="uncovered" >
                        <pre>         if ($mqttUser-&gt;getFromDB($this-&gt;fields[&#039;computers_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L742" class="number uncovered">742</th>

                    <td class="uncovered" >
                        <pre>            $mqttUser-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L743" class="number uncovered">743</th>

                    <td class="uncovered" >
                        <pre>                  &#039;id&#039;        =&gt; $mqttUser-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L744" class="number uncovered">744</th>

                    <td class="uncovered" >
                        <pre>                  &#039;enabled&#039;   =&gt; &#039;1&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L745" class="number uncovered">745</th>

                    <td class="uncovered" >
                        <pre>            ], 0);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L746" class="number ">746</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L747" class="number ">747</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L748" class="number uncovered">748</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L749" class="number ">749</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L750" class="number ">750</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L751" class="number ">751</th>

                    <td class="" >
                        <pre>    * Actions done after the purge of an item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L752" class="number ">752</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_purgeItem">
                    <th id="L753" class="number ">753</th>

                    <td class="" id="post_purgeItem">
                        <pre>   public function post_purgeItem() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L754" class="number uncovered">754</th>

                    <td class="uncovered" >
                        <pre>      $this-&gt;cleanupSubtopics();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L755" class="number uncovered">755</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L756" class="number ">756</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getSearchOptionsNew">
                    <th id="L757" class="number ">757</th>

                    <td class="" id="getSearchOptionsNew">
                        <pre>   public function getSearchOptionsNew() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L758" class="number uncovered">758</th>

                    <td class="uncovered" >
                        <pre>      return $this-&gt;rawSearchOptions();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L759" class="number unreach">759</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L760" class="number ">760</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="rawSearchOptions">
                    <th id="L761" class="number ">761</th>

                    <td class="" id="rawSearchOptions">
                        <pre>   public function rawSearchOptions() {<span class="label label-success">99%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L762" class="number covered">762</th>

                    <td class="covered" >
                        <pre>      if (method_exists(&#039;CommonDBTM&#039;, &#039;rawSearchOptions&#039;)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L763" class="number covered">763</th>

                    <td class="covered" >
                        <pre>         $tab = parent::rawSearchOptions();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L764" class="number ">764</th>

                    <td class="" >
                        <pre>      } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L765" class="number uncovered">765</th>

                    <td class="uncovered" >
                        <pre>         $tab = parent::getSearchOptionsNew();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L766" class="number ">766</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L767" class="number ">767</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L768" class="number covered">768</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L769" class="number covered">769</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;2&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L770" class="number covered">770</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L771" class="number covered">771</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L772" class="number covered">772</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;ID&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L773" class="number ">773</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L774" class="number covered">774</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;number&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L775" class="number ">775</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L776" class="number ">776</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L777" class="number covered">777</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L778" class="number covered">778</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;3&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L779" class="number covered">779</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; PluginFlyvemdmFleet::getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L780" class="number covered">780</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;name&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L781" class="number covered">781</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Fleet&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L782" class="number covered">782</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;dropdown&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L783" class="number ">783</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L784" class="number ">784</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L785" class="number covered">785</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L786" class="number covered">786</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;4&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L787" class="number covered">787</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; Computer::getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L788" class="number covered">788</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L789" class="number covered">789</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Computer&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L790" class="number covered">790</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;dropdown&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L791" class="number ">791</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L792" class="number ">792</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L793" class="number ">793</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L794" class="number covered">794</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L795" class="number covered">795</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;7&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L796" class="number covered">796</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; PluginFlyvemdmFleet::getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L797" class="number covered">797</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L798" class="number covered">798</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Fleet - ID&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L799" class="number ">799</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L800" class="number covered">800</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;number&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L801" class="number ">801</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L802" class="number ">802</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L803" class="number covered">803</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L804" class="number covered">804</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;8&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L805" class="number covered">805</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L806" class="number covered">806</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;last_contact&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L807" class="number covered">807</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Last contact&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L808" class="number covered">808</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;datetime&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L809" class="number ">809</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L810" class="number ">810</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L811" class="number ">811</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L812" class="number covered">812</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L813" class="number covered">813</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;10&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L814" class="number covered">814</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L815" class="number covered">815</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;version&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L816" class="number covered">816</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Version&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L817" class="number covered">817</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;string&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L818" class="number ">818</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L819" class="number ">819</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L820" class="number ">820</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L821" class="number covered">821</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L822" class="number covered">822</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;11&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L823" class="number covered">823</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L824" class="number covered">824</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;is_online&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L825" class="number covered">825</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Is online&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L826" class="number covered">826</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;specific&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L827" class="number ">827</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L828" class="number ">828</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L829" class="number ">829</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L830" class="number covered">830</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L831" class="number covered">831</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;12&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L832" class="number covered">832</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L833" class="number covered">833</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;mdm_type&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L834" class="number covered">834</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;MDM type&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L835" class="number covered">835</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;specific&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L836" class="number ">836</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L837" class="number ">837</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L838" class="number ">838</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L839" class="number covered">839</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L840" class="number covered">840</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;13&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L841" class="number covered">841</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L842" class="number covered">842</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;has_system_permission&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L843" class="number covered">843</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Has system permission&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L844" class="number covered">844</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;bool&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L845" class="number ">845</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L846" class="number ">846</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L847" class="number ">847</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L848" class="number covered">848</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L849" class="number covered">849</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;14&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L850" class="number covered">850</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L851" class="number covered">851</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;enroll_status&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L852" class="number covered">852</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Enroll status&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L853" class="number covered">853</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;bool&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L854" class="number ">854</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L855" class="number ">855</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L856" class="number ">856</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L857" class="number covered">857</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L858" class="number covered">858</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;15&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L859" class="number covered">859</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L860" class="number covered">860</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;wipe&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L861" class="number covered">861</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Wipe requested&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L862" class="number covered">862</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;bool&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L863" class="number ">863</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L864" class="number ">864</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L865" class="number ">865</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L866" class="number covered">866</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L867" class="number covered">867</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;16&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L868" class="number covered">868</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L869" class="number covered">869</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;lock&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L870" class="number covered">870</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Lock requested&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L871" class="number covered">871</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;bool&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L872" class="number ">872</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L873" class="number ">873</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L874" class="number ">874</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L875" class="number covered">875</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L876" class="number covered">876</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;17&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L877" class="number covered">877</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; Entity::getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L878" class="number covered">878</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;completename&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L879" class="number covered">879</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Entity&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L880" class="number covered">880</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;dropdown&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L881" class="number ">881</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L882" class="number ">882</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L883" class="number covered">883</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L884" class="number covered">884</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;18&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L885" class="number covered">885</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; PluginFlyvemdmPolicy::getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L886" class="number covered">886</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;name&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L887" class="number covered">887</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Applied policy&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L888" class="number covered">888</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;dropdown&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L889" class="number covered">889</th>

                    <td class="covered" >
                        <pre>         &#039;comments&#039;           =&gt; &#039;1&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L890" class="number ">890</th>

                    <td class="" >
                        <pre>         &#039;nosort&#039;             =&gt; true,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L891" class="number ">891</th>

                    <td class="" >
                        <pre>         &#039;joinparams&#039;         =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L892" class="number ">892</th>

                    <td class="" >
                        <pre>            &#039;beforejoin&#039;         =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L893" class="number covered">893</th>

                    <td class="covered" >
                        <pre>               &#039;table&#039;           =&gt; PluginFlyvemdmTask::getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L894" class="number ">894</th>

                    <td class="" >
                        <pre>               &#039;joinparams&#039;      =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L895" class="number ">895</th>

                    <td class="" >
                        <pre>                  &#039;jointype&#039;     =&gt; &#039;child&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L896" class="number ">896</th>

                    <td class="" >
                        <pre>                  &#039;linkfield&#039;    =&gt; &#039;items_id_applied&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L897" class="number ">897</th>

                    <td class="" >
                        <pre>                  &#039;condition&#039;    =&gt; &quot;AND NEWTABLE.`itemtype_applied`=&#039;&quot; . PluginFlyvemdmAgent::class . &quot;&#039;&quot;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L898" class="number ">898</th>

                    <td class="" >
                        <pre>               ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L899" class="number ">899</th>

                    <td class="" >
                        <pre>            ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L900" class="number covered">900</th>

                    <td class="covered" >
                        <pre>            &#039;jointype&#039;           =&gt; &#039;empty&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L901" class="number ">901</th>

                    <td class="" >
                        <pre>         ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L902" class="number ">902</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039;      =&gt; false
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L903" class="number ">903</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L904" class="number ">904</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L905" class="number covered">905</th>

                    <td class="covered" >
                        <pre>      return $tab;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L906" class="number unreach">906</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L907" class="number ">907</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L908" class="number ">908</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L909" class="number ">909</th>

                    <td class="" >
                        <pre>    * Limits search for agents of guest user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L910" class="number ">910</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="addDefaultJoin">
                    <th id="L911" class="number ">911</th>

                    <td class="" id="addDefaultJoin">
                        <pre>   public static function addDefaultJoin() {<span class="label label-warning">63%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L912" class="number covered">912</th>

                    <td class="covered" >
                        <pre>      $join = &#039;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L913" class="number ">913</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L914" class="number covered">914</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;guest_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L915" class="number covered">915</th>

                    <td class="covered" >
                        <pre>      $guestProfileId = $config[&#039;guest_profiles_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L916" class="number covered">916</th>

                    <td class="covered" >
                        <pre>      if ($_SESSION[&#039;glpiactiveprofile&#039;][&#039;id&#039;] == $guestProfileId) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L917" class="number uncovered">917</th>

                    <td class="uncovered" >
                        <pre>         $agentTable = self::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L918" class="number uncovered">918</th>

                    <td class="uncovered" >
                        <pre>         $computerTable = Computer::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L919" class="number uncovered">919</th>

                    <td class="uncovered" >
                        <pre>         $join = &quot;LEFT JOIN `$computerTable` AS `c` ON `$agentTable`.`computers_id`=`c`.`id` &quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L920" class="number ">920</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L921" class="number ">921</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L922" class="number covered">922</th>

                    <td class="covered" >
                        <pre>      return $join;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L923" class="number unreach">923</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L924" class="number ">924</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L925" class="number ">925</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L926" class="number ">926</th>

                    <td class="" >
                        <pre>    * Limit search for agents if guest user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L927" class="number ">927</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="addDefaultWhere">
                    <th id="L928" class="number ">928</th>

                    <td class="" id="addDefaultWhere">
                        <pre>   public static function addDefaultWhere() {<span class="label label-success">71%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L929" class="number covered">929</th>

                    <td class="covered" >
                        <pre>      $where = &#039;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L930" class="number ">930</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L931" class="number covered">931</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;guest_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L932" class="number covered">932</th>

                    <td class="covered" >
                        <pre>      $guestProfileId = $config[&#039;guest_profiles_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L933" class="number covered">933</th>

                    <td class="covered" >
                        <pre>      if ($_SESSION[&#039;glpiactiveprofile&#039;][&#039;id&#039;] == $guestProfileId) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L934" class="number uncovered">934</th>

                    <td class="uncovered" >
                        <pre>         $userId = $_SESSION[&#039;glpiID&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L935" class="number uncovered">935</th>

                    <td class="uncovered" >
                        <pre>         $where = &quot; AND `c`.`users_id`=&#039;$userId&#039;&quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L936" class="number ">936</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L937" class="number ">937</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L938" class="number covered">938</th>

                    <td class="covered" >
                        <pre>      return $where;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L939" class="number unreach">939</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L940" class="number ">940</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L941" class="number ">941</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L942" class="number ">942</th>

                    <td class="" >
                        <pre>    * Returns the topic the agent shall listen
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L943" class="number ">943</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L944" class="number ">944</th>

                    <td class="" >
                        <pre>    * @return string MQTT Topic
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L945" class="number ">945</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L946" class="number ">946</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getSubscribedTopic">
                    <th id="L947" class="number ">947</th>

                    <td class="" id="getSubscribedTopic">
                        <pre>   public function getSubscribedTopic() {<span class="label label-success">83%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L948" class="number covered">948</th>

                    <td class="covered" >
                        <pre>      $fleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L949" class="number covered">949</th>

                    <td class="covered" >
                        <pre>      $subscribedTopic = null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L950" class="number covered">950</th>

                    <td class="covered" >
                        <pre>      if ($fleet-&gt;getFromDB($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L951" class="number covered">951</th>

                    <td class="covered" >
                        <pre>         if (! $fleet-&gt;fields[&#039;is_default&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L952" class="number uncovered">952</th>

                    <td class="uncovered" >
                        <pre>            $subscribedTopic = $fleet-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L953" class="number ">953</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L954" class="number ">954</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L955" class="number covered">955</th>

                    <td class="covered" >
                        <pre>      return $subscribedTopic;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L956" class="number unreach">956</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L957" class="number ">957</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L958" class="number ">958</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L959" class="number ">959</th>

                    <td class="" >
                        <pre>    * Send to an agent an up to date list of MQTT topics it must subscribe
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L960" class="number ">960</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="updateSubscription">
                    <th id="L961" class="number ">961</th>

                    <td class="" id="updateSubscription">
                        <pre>   public function updateSubscription() {<span class="label label-success">83%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L962" class="number covered">962</th>

                    <td class="covered" >
                        <pre>      $topicToSubscribe = $this-&gt;getSubscribedTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L963" class="number ">963</th>

                    <td class="" >
                        <pre>      $topicList = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L964" class="number ">964</th>

                    <td class="" >
                        <pre>         &#039;subscribe&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L965" class="number covered">965</th>

                    <td class="covered" >
                        <pre>            [&#039;topic&#039; =&gt; $topicToSubscribe]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L966" class="number ">966</th>

                    <td class="" >
                        <pre>         ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L967" class="number ">967</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L968" class="number ">968</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L969" class="number covered">969</th>

                    <td class="covered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L970" class="number covered">970</th>

                    <td class="covered" >
                        <pre>      if ($topicToSubscribe !== null &amp;&amp; $topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L971" class="number uncovered">971</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;notify(&quot;$topic/Command/Subscribe&quot;, json_encode($topicList, JSON_UNESCAPED_SLASHES), 0, 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L972" class="number ">972</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L973" class="number covered">973</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L974" class="number ">974</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L975" class="number ">975</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L976" class="number ">976</th>

                    <td class="" >
                        <pre>    * get the MQTT topic of the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L977" class="number ">977</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L978" class="number ">978</th>

                    <td class="" >
                        <pre>    * @return string|null the permanent MQTT topic of the agent.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L979" class="number ">979</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getTopic">
                    <th id="L980" class="number ">980</th>

                    <td class="" id="getTopic">
                        <pre>   public function getTopic() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L981" class="number covered">981</th>

                    <td class="covered" >
                        <pre>      if ($this-&gt;topic === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L982" class="number covered">982</th>

                    <td class="covered" >
                        <pre>         $computer = $this-&gt;getComputer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L983" class="number covered">983</th>

                    <td class="covered" >
                        <pre>         if ($computer !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L984" class="number covered">984</th>

                    <td class="covered" >
                        <pre>            $serial = $computer-&gt;getField(&#039;serial&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L985" class="number covered">985</th>

                    <td class="covered" >
                        <pre>            if (strlen($serial)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L986" class="number covered">986</th>

                    <td class="covered" >
                        <pre>               $entity = $this-&gt;getField(&#039;entities_id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L987" class="number covered">987</th>

                    <td class="covered" >
                        <pre>               $this-&gt;topic = &quot;$entity/agent/$serial&quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L988" class="number ">988</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L989" class="number ">989</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L990" class="number ">990</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L991" class="number ">991</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L992" class="number covered">992</th>

                    <td class="covered" >
                        <pre>      return $this-&gt;topic;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L993" class="number unreach">993</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L994" class="number ">994</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L995" class="number ">995</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L996" class="number ">996</th>

                    <td class="" >
                        <pre>    * get an agent from DB by topic
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L997" class="number ">997</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L998" class="number ">998</th>

                    <td class="" >
                        <pre>    * @param string $topic a M2M topic
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L999" class="number ">999</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1000" class="number ">1000</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getByTopic">
                    <th id="L1001" class="number ">1001</th>

                    <td class="" id="getByTopic">
                        <pre>   public function getByTopic($topic) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1002" class="number uncovered">1002</th>

                    <td class="uncovered" >
                        <pre>      $mqttPath = explode(&#039;/&#039;, $topic);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1003" class="number uncovered">1003</th>

                    <td class="uncovered" >
                        <pre>      if (!isset($mqttPath[2])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1004" class="number uncovered">1004</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1005" class="number ">1005</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1006" class="number uncovered">1006</th>

                    <td class="uncovered" >
                        <pre>      if ($mqttPath[1] != &#039;agent&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1007" class="number uncovered">1007</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1008" class="number ">1008</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1009" class="number uncovered">1009</th>

                    <td class="uncovered" >
                        <pre>      $entity = (int) $mqttPath[0];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1010" class="number uncovered">1010</th>

                    <td class="uncovered" >
                        <pre>      $serial = $mqttPath[2];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1011" class="number uncovered">1011</th>

                    <td class="uncovered" >
                        <pre>      if (strlen($serial) &lt;= 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1012" class="number uncovered">1012</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1013" class="number ">1013</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1014" class="number uncovered">1014</th>

                    <td class="uncovered" >
                        <pre>      if (method_exists($this, &#039;getFromDBByRequest&#039;)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1015" class="number uncovered">1015</th>

                    <td class="uncovered" >
                        <pre>         return $this-&gt;getFromDbByRequest([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1016" class="number ">1016</th>

                    <td class="" >
                        <pre>            &#039;LEFT JOIN&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1017" class="number uncovered">1017</th>

                    <td class="uncovered" >
                        <pre>               Computer::getTable() =&gt; [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1018" class="number ">1018</th>

                    <td class="" >
                        <pre>                  &#039;FKEY&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1019" class="number uncovered">1019</th>

                    <td class="uncovered" >
                        <pre>                     Computer::getTable() =&gt; &#039;id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1020" class="number uncovered">1020</th>

                    <td class="uncovered" >
                        <pre>                     self::getTable() =&gt; Computer::getForeignKeyField(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1021" class="number ">1021</th>

                    <td class="" >
                        <pre>                  ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1022" class="number ">1022</th>

                    <td class="" >
                        <pre>               ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1023" class="number ">1023</th>

                    <td class="" >
                        <pre>            ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1024" class="number ">1024</th>

                    <td class="" >
                        <pre>            &#039;WHERE&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1025" class="number ">1025</th>

                    <td class="" >
                        <pre>               &#039;AND&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1026" class="number uncovered">1026</th>

                    <td class="uncovered" >
                        <pre>                  PluginFlyvemdmAgent::getTable() . &#039;.&#039; . Entity::getForeignKeyField() =&gt; $entity,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1027" class="number uncovered">1027</th>

                    <td class="uncovered" >
                        <pre>                  Computer::getTable() . &#039;.serial&#039; =&gt; $serial</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1028" class="number ">1028</th>

                    <td class="" >
                        <pre>               ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1029" class="number ">1029</th>

                    <td class="" >
                        <pre>            ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1030" class="number ">1030</th>

                    <td class="" >
                        <pre>         ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1031" class="number ">1031</th>

                    <td class="" >
                        <pre>      } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1032" class="number uncovered">1032</th>

                    <td class="uncovered" >
                        <pre>         $computerTable = Computer::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1033" class="number uncovered">1033</th>

                    <td class="uncovered" >
                        <pre>         $agentTable = self::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1034" class="number uncovered">1034</th>

                    <td class="uncovered" >
                        <pre>         return $this-&gt;getFromDBByQuery(&quot;LEFT JOIN `$computerTable` `c` ON (</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1035" class="number uncovered">1035</th>

                    <td class="uncovered" >
                        <pre>                                    `c`.`id` = `$agentTable`.`computers_id`</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1036" class="number ">1036</th>

                    <td class="" >
                        <pre>                                 )
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1037" class="number uncovered">1037</th>

                    <td class="uncovered" >
                        <pre>                                 WHERE `$agentTable`.`entities_id`=&#039;$entity&#039; AND `c`.`serial` = &#039;$serial&#039;&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1038" class="number ">1038</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1039" class="number unreach">1039</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1040" class="number ">1040</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1041" class="number ">1041</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1042" class="number ">1042</th>

                    <td class="" >
                        <pre>    * unsibscribe from a fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1043" class="number ">1043</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="unsubscribe">
                    <th id="L1044" class="number ">1044</th>

                    <td class="" id="unsubscribe">
                        <pre>   public function unsubscribe() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1045" class="number uncovered">1045</th>

                    <td class="uncovered" >
                        <pre>      $this-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1046" class="number uncovered">1046</th>

                    <td class="uncovered" >
                        <pre>            &#039;id&#039; =&gt; $this-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1047" class="number ">1047</th>

                    <td class="" >
                        <pre>            &#039;plugin_flyvemdm_fleets_id&#039; =&gt; null
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1048" class="number ">1048</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1049" class="number uncovered">1049</th>

                    <td class="uncovered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1050" class="number uncovered">1050</th>

                    <td class="uncovered" >
                        <pre>      if ($topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1051" class="number uncovered">1051</th>

                    <td class="uncovered" >
                        <pre>         $topic = $topic . &quot;/Subscription&quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1052" class="number uncovered">1052</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;notify($topic, json_encode([], JSON_UNESCAPED_SLASHES));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1053" class="number ">1053</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1054" class="number uncovered">1054</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1055" class="number ">1055</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1056" class="number ">1056</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1057" class="number ">1057</th>

                    <td class="" >
                        <pre>    * Checks if the data provided for enrollment satisfy our requirements
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1058" class="number ">1058</th>

                    <td class="" >
                        <pre>    * @param array $authFactors
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1059" class="number ">1059</th>

                    <td class="" >
                        <pre>    * @return integer enroll method
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1060" class="number ">1060</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="checkChallengeCombinations">
                    <th id="L1061" class="number ">1061</th>

                    <td class="" id="checkChallengeCombinations">
                        <pre>   protected static function checkChallengeCombinations($authFactors) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1062" class="number uncovered">1062</th>

                    <td class="uncovered" >
                        <pre>      $method = self::ENROLL_DENY;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1063" class="number ">1063</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1064" class="number uncovered">1064</th>

                    <td class="uncovered" >
                        <pre>      if (array_key_exists(&#039;email&#039;, $authFactors) &amp;&amp; array_key_exists(&#039;agentToken&#039;, $authFactors)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1065" class="number ">1065</th>

                    <td class="" >
                        <pre>         // require challenge on email and an agent token only
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1066" class="number uncovered">1066</th>

                    <td class="uncovered" >
                        <pre>         if (count($authFactors) == 2) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1067" class="number uncovered">1067</th>

                    <td class="uncovered" >
                        <pre>            $method = self::ENROLL_AGENT_TOKEN;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1068" class="number ">1068</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1069" class="number ">1069</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1070" class="number uncovered">1070</th>

                    <td class="uncovered" >
                        <pre>      } else if (array_key_exists(&#039;entityToken&#039;, $authFactors)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1071" class="number ">1071</th>

                    <td class="" >
                        <pre>         // or require challenge on a entity token only
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1072" class="number uncovered">1072</th>

                    <td class="uncovered" >
                        <pre>         if (count($authFactors) == 1) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1073" class="number uncovered">1073</th>

                    <td class="uncovered" >
                        <pre>            $method = self::ENROLL_ENTITY_TOKEN;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1074" class="number ">1074</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1075" class="number ">1075</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1076" class="number ">1076</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1077" class="number uncovered">1077</th>

                    <td class="uncovered" >
                        <pre>      return $method;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1078" class="number unreach">1078</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1079" class="number ">1079</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1080" class="number ">1080</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1081" class="number ">1081</th>

                    <td class="" >
                        <pre>    * Attempt to enroll using an invitation token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1082" class="number ">1082</th>

                    <td class="" >
                        <pre>    * @param array $input Enrollment data
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1083" class="number ">1083</th>

                    <td class="" >
                        <pre>    * @return array|bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1084" class="number ">1084</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="enrollByInvitationToken">
                    <th id="L1085" class="number ">1085</th>

                    <td class="" id="enrollByInvitationToken">
                        <pre>   protected function enrollByInvitationToken($input) {<span class="label label-warning">54%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1086" class="number covered">1086</th>

                    <td class="covered" >
                        <pre>      global $LOADED_PLUGINS, $DB;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1087" class="number ">1087</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1088" class="number covered">1088</th>

                    <td class="covered" >
                        <pre>      $invitationToken  = isset($input[&#039;_invitation_token&#039;]) ? $input[&#039;_invitation_token&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1089" class="number covered">1089</th>

                    <td class="covered" >
                        <pre>      $email            = isset($input[&#039;_email&#039;]) ? $input[&#039;_email&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1090" class="number covered">1090</th>

                    <td class="covered" >
                        <pre>      $serial           = isset($input[&#039;_serial&#039;]) ? $input[&#039;_serial&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1091" class="number covered">1091</th>

                    <td class="covered" >
                        <pre>      $uuid             = isset($input[&#039;_uuid&#039;]) ? $input[&#039;_uuid&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1092" class="number covered">1092</th>

                    <td class="covered" >
                        <pre>      $csr              = isset($input[&#039;csr&#039;]) ? $input[&#039;csr&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1093" class="number covered">1093</th>

                    <td class="covered" >
                        <pre>      $firstname        = isset($input[&#039;firstname&#039;]) ? $input[&#039;firstname&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1094" class="number covered">1094</th>

                    <td class="covered" >
                        <pre>      $lastname         = isset($input[&#039;lastname&#039;]) ? $input[&#039;lastname&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1095" class="number covered">1095</th>

                    <td class="covered" >
                        <pre>      $version          = isset($input[&#039;version&#039;]) ? $input[&#039;version&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1096" class="number covered">1096</th>

                    <td class="covered" >
                        <pre>      $mdmType          = isset($input[&#039;type&#039;]) ? $input[&#039;type&#039;] : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1097" class="number covered">1097</th>

                    <td class="covered" >
                        <pre>      $inventory        = isset($input[&#039;inventory&#039;]) ? htmlspecialchars_decode(base64_decode($input[&#039;inventory&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1098" class="number covered">1098</th>

                    <td class="covered" >
                        <pre>         ENT_COMPAT | ENT_XML1) : null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1099" class="number covered">1099</th>

                    <td class="covered" >
                        <pre>      $systemPermission = isset($input[&#039;has_system_permission&#039;]) ? $input[&#039;has_system_permission&#039;] : 0;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1100" class="number ">1100</th>

                    <td class="" >
                        <pre>      // For non-android agents, system permssion might be forced to 1 depending on the lack of such constraint
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1101" class="number ">1101</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1102" class="number covered">1102</th>

                    <td class="covered" >
                        <pre>      $input = [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1103" class="number ">1103</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1104" class="number covered">1104</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1105" class="number covered">1105</th>

                    <td class="covered" >
                        <pre>         &#039;mqtt_tls_for_clients&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1106" class="number ">1106</th>

                    <td class="" >
                        <pre>         &#039;mqtt_use_client_cert&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1107" class="number ">1107</th>

                    <td class="" >
                        <pre>         &#039;debug_noexpire&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1108" class="number ">1108</th>

                    <td class="" >
                        <pre>         &#039;debug_save_inventory&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1109" class="number ">1109</th>

                    <td class="" >
                        <pre>         &#039;computertypes_id&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1110" class="number ">1110</th>

                    <td class="" >
                        <pre>         &#039;agentusercategories_id&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1111" class="number ">1111</th>

                    <td class="" >
                        <pre>         &#039;agent_profiles_id&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1112" class="number ">1112</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1113" class="number ">1113</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1114" class="number ">1114</th>

                    <td class="" >
                        <pre>      // Find the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1115" class="number covered">1115</th>

                    <td class="covered" >
                        <pre>      $invitation = new PluginFlyvemdmInvitation();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1116" class="number covered">1116</th>

                    <td class="covered" >
                        <pre>      if (!$invitation-&gt;getFromDBByToken($invitationToken)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1117" class="number uncovered">1117</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages(__(&#039;Invitation token invalid&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1118" class="number uncovered">1118</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1119" class="number ">1119</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1120" class="number ">1120</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1121" class="number covered">1121</th>

                    <td class="covered" >
                        <pre>      if (empty($serial) &amp;&amp; empty($uuid)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1122" class="number uncovered">1122</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;One of serial and uuid is mandatory&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1123" class="number uncovered">1123</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1124" class="number uncovered">1124</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1125" class="number uncovered">1125</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1126" class="number ">1126</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1127" class="number ">1127</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1128" class="number covered">1128</th>

                    <td class="covered" >
                        <pre>      if (empty($inventory)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1129" class="number uncovered">1129</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Device inventory XML is mandatory&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1130" class="number uncovered">1130</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1131" class="number uncovered">1131</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1132" class="number uncovered">1132</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1133" class="number ">1133</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1134" class="number ">1134</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1135" class="number covered">1135</th>

                    <td class="covered" >
                        <pre>      if ($config[&#039;debug_save_inventory&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1136" class="number uncovered">1136</th>

                    <td class="uncovered" >
                        <pre>         PluginFlyvemdmCommon::saveInventoryFile($inventory, $invitationToken);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1137" class="number ">1137</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1138" class="number covered">1138</th>

                    <td class="covered" >
                        <pre>      $parsedXml = PluginFlyvemdmCommon::parseXML($inventory);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1139" class="number covered">1139</th>

                    <td class="covered" >
                        <pre>      if (!$parsedXml) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1140" class="number uncovered">1140</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Inventory XML is not well formed&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1141" class="number uncovered">1141</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1142" class="number uncovered">1142</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1143" class="number uncovered">1143</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1144" class="number ">1144</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1145" class="number ">1145</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1146" class="number covered">1146</th>

                    <td class="covered" >
                        <pre>      if (empty($version)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1147" class="number uncovered">1147</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Agent version missing&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1148" class="number uncovered">1148</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1149" class="number uncovered">1149</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1150" class="number uncovered">1150</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1151" class="number ">1151</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1152" class="number ">1152</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1153" class="number covered">1153</th>

                    <td class="covered" >
                        <pre>      if (empty($mdmType)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1154" class="number uncovered">1154</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;MDM type missing&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1155" class="number uncovered">1155</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1156" class="number uncovered">1156</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1157" class="number uncovered">1157</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1158" class="number ">1158</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1159" class="number ">1159</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1160" class="number covered">1160</th>

                    <td class="covered" >
                        <pre>      if (!in_array($mdmType, array_keys($this::getEnumMdmType()))) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1161" class="number uncovered">1161</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;unknown MDM type&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1162" class="number uncovered">1162</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1163" class="number uncovered">1163</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1164" class="number uncovered">1164</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1165" class="number ">1165</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1166" class="number ">1166</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1167" class="number covered">1167</th>

                    <td class="covered" >
                        <pre>      if (preg_match(PluginFlyvemdmCommon::SEMVER_VERSION_REGEX, $version) !== 1) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1168" class="number uncovered">1168</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Bad agent version&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1169" class="number uncovered">1169</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1170" class="number uncovered">1170</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1171" class="number uncovered">1171</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1172" class="number ">1172</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1173" class="number ">1173</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1174" class="number ">1174</th>

                    <td class="" >
                        <pre>      // Check the agent matches the minimum version requirement of the backend
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1175" class="number covered">1175</th>

                    <td class="covered" >
                        <pre>      $minVersion = $this-&gt;getMinVersioForType($mdmType);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1176" class="number covered">1176</th>

                    <td class="covered" >
                        <pre>      if (version_compare($minVersion, $version) &gt; 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1177" class="number uncovered">1177</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;The agent version is too low&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1178" class="number uncovered">1178</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1179" class="number uncovered">1179</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1180" class="number uncovered">1180</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1181" class="number ">1181</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1182" class="number ">1182</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1183" class="number ">1183</th>

                    <td class="" >
                        <pre>      // Check the agent shall provide or not the system permissions flag
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1184" class="number ">1184</th>

                    <td class="" >
                        <pre>      switch ($mdmType) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1185" class="number covered">1185</th>

                    <td class="covered" >
                        <pre>         case &#039;android&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1186" class="number covered">1186</th>

                    <td class="covered" >
                        <pre>            if ($systemPermission === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1187" class="number uncovered">1187</th>

                    <td class="uncovered" >
                        <pre>               $event = __(&#039;The agent does not advertise its system permissions&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1188" class="number uncovered">1188</th>

                    <td class="uncovered" >
                        <pre>               $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1189" class="number uncovered">1189</th>

                    <td class="uncovered" >
                        <pre>               $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1190" class="number uncovered">1190</th>

                    <td class="uncovered" >
                        <pre>               return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1191" class="number ">1191</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1192" class="number ">1192</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1193" class="number ">1193</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1194" class="number ">1194</th>

                    <td class="" >
                        <pre>      // Check the invitation is pending
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1195" class="number covered">1195</th>

                    <td class="covered" >
                        <pre>      if ($invitation-&gt;getField(&#039;status&#039;) != &#039;pending&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1196" class="number uncovered">1196</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Invitation is not pending&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1197" class="number uncovered">1197</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1198" class="number uncovered">1198</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1199" class="number uncovered">1199</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1200" class="number ">1200</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1201" class="number ">1201</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1202" class="number ">1202</th>

                    <td class="" >
                        <pre>      // Check the token has not yet expired
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1203" class="number covered">1203</th>

                    <td class="covered" >
                        <pre>      if ($invitation-&gt;getField(&#039;expiration_date&#039;) === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1204" class="number uncovered">1204</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Expiration date of the invitation is not set&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1205" class="number uncovered">1205</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1206" class="number uncovered">1206</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1207" class="number uncovered">1207</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1208" class="number ">1208</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1209" class="number covered">1209</th>

                    <td class="covered" >
                        <pre>      $currentDatetime = new DateTime(&quot;now&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1210" class="number covered">1210</th>

                    <td class="covered" >
                        <pre>      $expirationDatetime = new DateTime($invitation-&gt;getField(&#039;expiration_date&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1211" class="number covered">1211</th>

                    <td class="covered" >
                        <pre>      if ($currentDatetime &gt;= $expirationDatetime) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1212" class="number uncovered">1212</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Invitation token expired&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1213" class="number uncovered">1213</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1214" class="number uncovered">1214</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1215" class="number uncovered">1215</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1216" class="number ">1216</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1217" class="number ">1217</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1218" class="number ">1218</th>

                    <td class="" >
                        <pre>      // Check the given email belongs to the same user than the user in the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1219" class="number covered">1219</th>

                    <td class="covered" >
                        <pre>      $user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1220" class="number covered">1220</th>

                    <td class="covered" >
                        <pre>      $userTable = User::getTable();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1221" class="number covered">1221</th>

                    <td class="covered" >
                        <pre>      $condition = $userTable.&quot;.`id`=&#039;&quot; . $invitation-&gt;getField(&#039;users_id&#039;) . &quot;&#039;&quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1222" class="number covered">1222</th>

                    <td class="covered" >
                        <pre>      if (version_compare(GLPI_VERSION, &#039;9.3-dev&#039;) &gt;= 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1223" class="number covered">1223</th>

                    <td class="covered" >
                        <pre>         $condition = [$userTable . &#039;.id&#039; =&gt; $invitation-&gt;getField(&#039;users_id&#039;)];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1224" class="number ">1224</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1225" class="number covered">1225</th>

                    <td class="covered" >
                        <pre>      if ($user-&gt;getFromDBbyEmail($email, $condition) === false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1226" class="number uncovered">1226</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Wrong email address&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1227" class="number uncovered">1227</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1228" class="number uncovered">1228</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1229" class="number uncovered">1229</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1230" class="number ">1230</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1231" class="number covered">1231</th>

                    <td class="covered" >
                        <pre>      $userId = $user-&gt;getId();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1232" class="number ">1232</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1233" class="number covered">1233</th>

                    <td class="covered" >
                        <pre>      $entityId = $invitation-&gt;getField(&#039;entities_id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1234" class="number ">1234</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1235" class="number ">1235</th>

                    <td class="" >
                        <pre>      //sign the agent&#039;s certificate (if TLS enabled)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1236" class="number covered">1236</th>

                    <td class="covered" >
                        <pre>      $input[&#039;certificate&#039;] = &#039;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1237" class="number covered">1237</th>

                    <td class="covered" >
                        <pre>      if ($config[&#039;mqtt_tls_for_clients&#039;] != &#039;0&#039; &amp;&amp; $config[&#039;mqtt_use_client_cert&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1238" class="number uncovered">1238</th>

                    <td class="uncovered" >
                        <pre>         $answer = self::signCertificate($csr);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1239" class="number uncovered">1239</th>

                    <td class="uncovered" >
                        <pre>         $crt = isset($answer[&#039;crt&#039;]) ? $answer[&#039;crt&#039;] : false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1240" class="number uncovered">1240</th>

                    <td class="uncovered" >
                        <pre>         if ($crt === false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1241" class="number uncovered">1241</th>

                    <td class="uncovered" >
                        <pre>            $event = __(&quot;Failed to sign the certificate&quot;, &#039;flyvemdm&#039;)  . &quot;\n &quot; . $answer[&#039;message&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1242" class="number uncovered">1242</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1243" class="number uncovered">1243</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1244" class="number uncovered">1244</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1245" class="number ">1245</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1246" class="number uncovered">1246</th>

                    <td class="uncovered" >
                        <pre>         $input[&#039;certificate&#039;] = $crt;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1247" class="number ">1247</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1248" class="number ">1248</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1249" class="number ">1249</th>

                    <td class="" >
                        <pre>      // Prepare invitation update
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1250" class="number ">1250</th>

                    <td class="" >
                        <pre>      $invitationInput = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1251" class="number covered">1251</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; $invitation-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1252" class="number covered">1252</th>

                    <td class="covered" >
                        <pre>         &#039;status&#039;             =&gt; &#039;done&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1253" class="number ">1253</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1254" class="number ">1254</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1255" class="number ">1255</th>

                    <td class="" >
                        <pre>      // Invalidate the token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1256" class="number covered">1256</th>

                    <td class="covered" >
                        <pre>      if ($config[&#039;debug_noexpire&#039;] == &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1257" class="number covered">1257</th>

                    <td class="covered" >
                        <pre>         $invitationInput[&#039;expiration_date&#039;] = &#039;0000-00-00 00:00:00&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1258" class="number covered">1258</th>

                    <td class="covered" >
                        <pre>         $invitationInput[&#039;status&#039;]          = &#039;done&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1259" class="number ">1259</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1260" class="number ">1260</th>

                    <td class="" >
                        <pre>         // Update the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1261" class="number covered">1261</th>

                    <td class="covered" >
                        <pre>         if (!$invitation-&gt;update($invitationInput)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1262" class="number uncovered">1262</th>

                    <td class="uncovered" >
                        <pre>            $event = __(&quot;Failed to update the invitation&quot;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1263" class="number uncovered">1263</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1264" class="number uncovered">1264</th>

                    <td class="uncovered" >
                        <pre>            $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1265" class="number uncovered">1265</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1266" class="number ">1266</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1267" class="number ">1267</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1268" class="number ">1268</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1269" class="number ">1269</th>

                    <td class="" >
                        <pre>      // Create the device
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1270" class="number covered">1270</th>

                    <td class="covered" >
                        <pre>      $pfCommunication = new PluginFusioninventoryCommunication();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1271" class="number covered">1271</th>

                    <td class="covered" >
                        <pre>      $_SESSION[&#039;glpi_fusionionventory_nolock&#039;] = true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1272" class="number covered">1272</th>

                    <td class="covered" >
                        <pre>      ob_start();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1273" class="number covered">1273</th>

                    <td class="covered" >
                        <pre>      if (!key_exists(&#039;glpi_plugin_fusioninventory&#039;, $_SESSION) || !key_exists(&#039;xmltags&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1274" class="number covered">1274</th>

                    <td class="covered" >
                        <pre>            $_SESSION[&#039;glpi_plugin_fusioninventory&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1275" class="number ">1275</th>

                    <td class="" >
                        <pre>         // forced reload of the FI plugin for correct import of inventory
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1276" class="number uncovered">1276</th>

                    <td class="uncovered" >
                        <pre>         unset($LOADED_PLUGINS[&#039;fusioninventory&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1277" class="number uncovered">1277</th>

                    <td class="uncovered" >
                        <pre>         Plugin::load(&#039;fusioninventory&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1278" class="number ">1278</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1279" class="number covered">1279</th>

                    <td class="covered" >
                        <pre>      $pfCommunication-&gt;handleOCSCommunication(&#039;&#039;, $inventory, &#039;glpi&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1280" class="number covered">1280</th>

                    <td class="covered" >
                        <pre>      $fiOutput = ob_get_contents();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1281" class="number covered">1281</th>

                    <td class="covered" >
                        <pre>      ob_end_clean();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1282" class="number covered">1282</th>

                    <td class="covered" >
                        <pre>      if (strlen($fiOutput) != 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1283" class="number ">1283</th>

                    <td class="" >
                        <pre>         // FI print errors to sdt output and agents needs a correct response, let&#039;s save this to logs.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1284" class="number uncovered">1284</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $fiOutput);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1285" class="number ">1285</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1286" class="number covered">1286</th>

                    <td class="covered" >
                        <pre>      unset($_SESSION[&#039;glpi_fusionionventory_nolock&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1287" class="number covered">1287</th>

                    <td class="covered" >
                        <pre>      $fiAgentId = $_SESSION[&#039;plugin_fusioninventory_agents_id&#039;]; // generated by FusionInventory</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1288" class="number ">1288</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1289" class="number covered">1289</th>

                    <td class="covered" >
                        <pre>      if ($fiAgentId === 0 || !property_exists($parsedXml, &#039;DEVICEID&#039;)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1290" class="number uncovered">1290</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Cannot get the FusionInventory agent&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1291" class="number uncovered">1291</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1292" class="number uncovered">1292</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1293" class="number uncovered">1293</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1294" class="number ">1294</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1295" class="number ">1295</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1296" class="number covered">1296</th>

                    <td class="covered" >
                        <pre>      $pfAgent = new PluginFusioninventoryAgent();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1297" class="number covered">1297</th>

                    <td class="covered" >
                        <pre>      if (!$pfAgent-&gt;getFromDBByCrit([&#039;device_id&#039; =&gt; $parsedXml-&gt;DEVICEID])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1298" class="number uncovered">1298</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;FusionInventory agent not created&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1299" class="number uncovered">1299</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1300" class="number uncovered">1300</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1301" class="number uncovered">1301</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1302" class="number ">1302</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1303" class="number covered">1303</th>

                    <td class="covered" >
                        <pre>      $computerId = $pfAgent-&gt;getField(Computer::getForeignKeyField());</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1304" class="number ">1304</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1305" class="number covered">1305</th>

                    <td class="covered" >
                        <pre>      if ($computerId === 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1306" class="number uncovered">1306</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&quot;Cannot create the device&quot;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1307" class="number uncovered">1307</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1308" class="number uncovered">1308</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1309" class="number uncovered">1309</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1310" class="number ">1310</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1311" class="number ">1311</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1312" class="number ">1312</th>

                    <td class="" >
                        <pre>      // Set the type of computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1313" class="number covered">1313</th>

                    <td class="covered" >
                        <pre>      $computerTypeId = $config[&#039;computertypes_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1314" class="number covered">1314</th>

                    <td class="covered" >
                        <pre>      if ($computerTypeId == -1 || $computerTypeId === false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1315" class="number uncovered">1315</th>

                    <td class="uncovered" >
                        <pre>         $computerTypeId = 0;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1316" class="number ">1316</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1317" class="number covered">1317</th>

                    <td class="covered" >
                        <pre>      $computer = new Computer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1318" class="number covered">1318</th>

                    <td class="covered" >
                        <pre>      $computer-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1319" class="number covered">1319</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;               =&gt; $computerId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1320" class="number covered">1320</th>

                    <td class="covered" >
                        <pre>         &#039;computertypes_id&#039; =&gt; $computerTypeId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1321" class="number covered">1321</th>

                    <td class="covered" >
                        <pre>         &#039;users_id&#039;         =&gt; $userId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1322" class="number ">1322</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1323" class="number ">1323</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1324" class="number ">1324</th>

                    <td class="" >
                        <pre>      // Awful hack because the current user profile does not
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1325" class="number ">1325</th>

                    <td class="" >
                        <pre>      // have more rights than the profile of the agent.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1326" class="number ">1326</th>

                    <td class="" >
                        <pre>      // @see User::post_addItem()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1327" class="number ">1327</th>

                    <td class="" >
                        <pre>      // @see Profle::currentUserHaveMoreRightThan()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1328" class="number ">1328</th>

                    <td class="" >
                        <pre>      // @see Profile::getUnderActiveProfileRestrictRequest()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1329" class="number covered">1329</th>

                    <td class="covered" >
                        <pre>      $backupProfileRight = $_SESSION[&#039;glpiactiveprofile&#039;][&#039;profile&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1330" class="number covered">1330</th>

                    <td class="covered" >
                        <pre>      $_SESSION[&#039;glpiactiveprofile&#039;][&#039;profile&#039;] = $_SESSION[&#039;glpiactiveprofile&#039;][&#039;profile&#039;] | CREATE;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1331" class="number ">1331</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1332" class="number ">1332</th>

                    <td class="" >
                        <pre>      //create agent user account
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1333" class="number covered">1333</th>

                    <td class="covered" >
                        <pre>      $agentAccount = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1334" class="number covered">1334</th>

                    <td class="covered" >
                        <pre>      $agentAccount-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1335" class="number covered">1335</th>

                    <td class="covered" >
                        <pre>         &#039;usercategories_id&#039; =&gt; $config[&#039;agentusercategories_id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1336" class="number covered">1336</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;              =&gt; &#039;flyvemdm-&#039; . PluginFlyvemdmCommon::generateUUID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1337" class="number covered">1337</th>

                    <td class="covered" >
                        <pre>         &#039;realname&#039;          =&gt; $serial,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1338" class="number covered">1338</th>

                    <td class="covered" >
                        <pre>         &#039;_profiles_id&#039;      =&gt; $config[&#039;agent_profiles_id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1339" class="number covered">1339</th>

                    <td class="covered" >
                        <pre>         &#039;profiles_id&#039;       =&gt; $config[&#039;agent_profiles_id&#039;],      // Default profile when user logs in</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1340" class="number covered">1340</th>

                    <td class="covered" >
                        <pre>         &#039;_entities_id&#039;      =&gt; $entityId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1341" class="number covered">1341</th>

                    <td class="covered" >
                        <pre>         &#039;_is_recursive&#039;     =&gt; 0,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1342" class="number uncovered">1342</th>

                    <td class="uncovered" >
                        <pre>         &#039;authtype&#039;          =&gt; Auth::DB_GLPI,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1343" class="number ">1343</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1344" class="number ">1344</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1345" class="number ">1345</th>

                    <td class="" >
                        <pre>      // End of awful hack !
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1346" class="number covered">1346</th>

                    <td class="covered" >
                        <pre>      $_SESSION[&#039;glpiactiveprofile&#039;][&#039;profile&#039;] = $backupProfileRight;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1347" class="number ">1347</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1348" class="number covered">1348</th>

                    <td class="covered" >
                        <pre>      if ($agentAccount-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1349" class="number uncovered">1349</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Cannot create a user account for the agent&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1350" class="number uncovered">1350</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1351" class="number uncovered">1351</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1352" class="number uncovered">1352</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1353" class="number ">1353</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1354" class="number ">1354</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1355" class="number covered">1355</th>

                    <td class="covered" >
                        <pre>      $agentToken = User::getToken($agentAccount-&gt;getID(), &#039;api_token&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1356" class="number covered">1356</th>

                    <td class="covered" >
                        <pre>      if ($agentToken === false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1357" class="number uncovered">1357</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&#039;Cannot create the API token for the agent&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1358" class="number uncovered">1358</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1359" class="number uncovered">1359</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1360" class="number uncovered">1360</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1361" class="number ">1361</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1362" class="number ">1362</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1363" class="number ">1363</th>

                    <td class="" >
                        <pre>      // Create the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1364" class="number covered">1364</th>

                    <td class="covered" >
                        <pre>      $defaultFleet = PluginFlyvemdmFleet::getDefaultFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1365" class="number covered">1365</th>

                    <td class="covered" >
                        <pre>      if ($defaultFleet === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1366" class="number uncovered">1366</th>

                    <td class="uncovered" >
                        <pre>         $event = __(&quot;No default fleet available for the device&quot;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1367" class="number uncovered">1367</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;filterMessages($event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1368" class="number uncovered">1368</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;logInvitationEvent($invitation, $event);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1369" class="number uncovered">1369</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1370" class="number ">1370</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1371" class="number ">1371</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1372" class="number ">1372</th>

                    <td class="" >
                        <pre>      // Enrollment is about to succeed, then update the user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1373" class="number covered">1373</th>

                    <td class="covered" >
                        <pre>      if (!empty($user-&gt;getField(&#039;firstname&#039;)) || !empty($user-&gt;getField(&#039;lastname&#039;))) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1374" class="number covered">1374</th>

                    <td class="covered" >
                        <pre>         $user-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1375" class="number covered">1375</th>

                    <td class="covered" >
                        <pre>               &#039;id&#039;        =&gt; $userId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1376" class="number covered">1376</th>

                    <td class="covered" >
                        <pre>               &#039;firstname&#039; =&gt; $firstname,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1377" class="number covered">1377</th>

                    <td class="covered" >
                        <pre>               &#039;realname&#039;  =&gt; $lastname,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1378" class="number ">1378</th>

                    <td class="" >
                        <pre>         ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1379" class="number ">1379</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1380" class="number ">1380</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1381" class="number ">1381</th>

                    <td class="" >
                        <pre>      // Enrollment is about to succeed then cleanup subtopics
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1382" class="number covered">1382</th>

                    <td class="covered" >
                        <pre>      $this-&gt;fields[&#039;computers_id&#039;] = $computerId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1383" class="number covered">1383</th>

                    <td class="covered" >
                        <pre>      $this-&gt;fields[&#039;entities_id&#039;]  = $entityId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1384" class="number covered">1384</th>

                    <td class="covered" >
                        <pre>      $this-&gt;cleanupSubtopics();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1385" class="number ">1385</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1386" class="number covered">1386</th>

                    <td class="covered" >
                        <pre>      $input[&#039;name&#039;]                      = $email;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1387" class="number covered">1387</th>

                    <td class="covered" >
                        <pre>      $input[&#039;computers_id&#039;]              = $computerId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1388" class="number covered">1388</th>

                    <td class="covered" >
                        <pre>      $input[&#039;entities_id&#039;]               = $entityId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1389" class="number covered">1389</th>

                    <td class="covered" >
                        <pre>      $input[&#039;plugin_flyvemdm_fleets_id&#039;] = $defaultFleet-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1390" class="number covered">1390</th>

                    <td class="covered" >
                        <pre>      $input[&#039;_invitations_id&#039;]           = $invitation-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1391" class="number covered">1391</th>

                    <td class="covered" >
                        <pre>      $input[&#039;enroll_status&#039;]             = &#039;enrolled&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1392" class="number covered">1392</th>

                    <td class="covered" >
                        <pre>      $input[&#039;version&#039;]                   = $version;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1393" class="number covered">1393</th>

                    <td class="covered" >
                        <pre>      $input[&#039;users_id&#039;]                  = $agentAccount-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1394" class="number covered">1394</th>

                    <td class="covered" >
                        <pre>      $input[&#039;mdm_type&#039;]                  = $mdmType;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1395" class="number covered">1395</th>

                    <td class="covered" >
                        <pre>      $input[&#039;$systemPermission&#039;]         = $systemPermission;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1396" class="number covered">1396</th>

                    <td class="covered" >
                        <pre>      return $input;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1397" class="number ">1397</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1398" class="number unreach">1398</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1399" class="number ">1399</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1400" class="number ">1400</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1401" class="number ">1401</th>

                    <td class="" >
                        <pre>    * @param string $serial
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1402" class="number ">1402</th>

                    <td class="" >
                        <pre>    * @param array $authFactors
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1403" class="number ">1403</th>

                    <td class="" >
                        <pre>    * @param string $csr Certificate Signing Request from the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1404" class="number ">1404</th>

                    <td class="" >
                        <pre>    * @param &amp;string $notFoundMessage Contains the error message if the enrollment failed
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1405" class="number ">1405</th>

                    <td class="" >
                        <pre>    * @return boolean|PluginFlyvemdmAgent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1406" class="number ">1406</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1407" class="number ">1407</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1408" class="number ">1408</th>

                    <td class="" >
                        <pre>   //protected static function enrollByEntityToken($serial, $authFactors, $csr, &amp;$errorMessage) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1409" class="number ">1409</th>

                    <td class="" >
                        <pre>      //global $DB;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1410" class="number ">1410</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1411" class="number ">1411</th>

                    <td class="" >
                        <pre>      //$token = $DB-&gt;escape($authFactors[&#039;entityToken&#039;]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1412" class="number ">1412</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1413" class="number ">1413</th>

                    <td class="" >
                        <pre>      //// Find an entity matching the given token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1414" class="number ">1414</th>

                    <td class="" >
                        <pre>      //$entity = new PluginFlyvemdmEntityconfig();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1415" class="number ">1415</th>

                    <td class="" >
                        <pre>      //if (!$entity-&gt;getFromDBByCrit([&#039;enroll_token&#039; =&gt; $token])) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1416" class="number ">1416</th>

                    <td class="" >
                        <pre>      //   $errorMessage = &quot;no entity token not found&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1417" class="number ">1417</th>

                    <td class="" >
                        <pre>      //   return false;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1418" class="number ">1418</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1419" class="number ">1419</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1420" class="number ">1420</th>

                    <td class="" >
                        <pre>      //// Create a new computer for the device being enrolled
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1421" class="number ">1421</th>

                    <td class="" >
                        <pre>      //// TODO : Enable localization of the type
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1422" class="number ">1422</th>

                    <td class="" >
                        <pre>      //$computerType = new ComputerType();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1423" class="number ">1423</th>

                    <td class="" >
                        <pre>      //$computerTypeId = $computerType-&gt;import([&#039;name&#039; =&gt; &#039;Smartphone&#039;]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1424" class="number ">1424</th>

                    <td class="" >
                        <pre>      //if ($computerTypeId == -1 || $computerTypeId === false) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1425" class="number ">1425</th>

                    <td class="" >
                        <pre>      //   $computerTypeId = 0;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1426" class="number ">1426</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1427" class="number ">1427</th>

                    <td class="" >
                        <pre>      //$computer = new Computer();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1428" class="number ">1428</th>

                    <td class="" >
                        <pre>      //$condition = &quot;`serial`=&#039;&quot; . $DB-&gt;escape($serial) . &quot;&#039; AND `entities_id`=&#039;&quot; . $entity-&gt;getID() . &quot;&#039;&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1429" class="number ">1429</th>

                    <td class="" >
                        <pre>      //$computerCollection = $computer-&gt;find($condition);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1430" class="number ">1430</th>

                    <td class="" >
                        <pre>      //if (count($computerCollection) &gt; 1) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1431" class="number ">1431</th>

                    <td class="" >
                        <pre>      //   $errorMessage = &quot;failed to find the computer&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1432" class="number ">1432</th>

                    <td class="" >
                        <pre>      //   return false;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1433" class="number ">1433</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1434" class="number ">1434</th>

                    <td class="" >
                        <pre>      //if (count($computerCollection) == 1) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1435" class="number ">1435</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1436" class="number ">1436</th>

                    <td class="" >
                        <pre>      //   reset($computerCollection);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1437" class="number ">1437</th>

                    <td class="" >
                        <pre>      //   $computer-&gt;getFromDB(key($computerCollection));
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1438" class="number ">1438</th>

                    <td class="" >
                        <pre>      //   $computerId = $computer-&gt;getID();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1439" class="number ">1439</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1440" class="number ">1440</th>

                    <td class="" >
                        <pre>      //} else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1441" class="number ">1441</th>

                    <td class="" >
                        <pre>      //   $computerId = $computer-&gt;add([
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1442" class="number ">1442</th>

                    <td class="" >
                        <pre>      //      &#039;entities_id&#039;        =&gt; $entity-&gt;getID(),
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1443" class="number ">1443</th>

                    <td class="" >
                        <pre>      //      &#039;serial&#039;             =&gt; $serial,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1444" class="number ">1444</th>

                    <td class="" >
                        <pre>      //      &#039;computertypes_id&#039;   =&gt; $computerTypeId
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1445" class="number ">1445</th>

                    <td class="" >
                        <pre>      //   ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1446" class="number ">1446</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1447" class="number ">1447</th>

                    <td class="" >
                        <pre>      //   if ($computerId === false) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1448" class="number ">1448</th>

                    <td class="" >
                        <pre>      //      $errorMessage = &quot;failed to create the computer&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1449" class="number ">1449</th>

                    <td class="" >
                        <pre>      //      return false;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1450" class="number ">1450</th>

                    <td class="" >
                        <pre>      //   }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1451" class="number ">1451</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1452" class="number ">1452</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1453" class="number ">1453</th>

                    <td class="" >
                        <pre>      //if (! $computerId &gt; 0) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1454" class="number ">1454</th>

                    <td class="" >
                        <pre>      //   $errorMessage = &quot;failed to update the computer&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1455" class="number ">1455</th>

                    <td class="" >
                        <pre>      //   return false;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1456" class="number ">1456</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1457" class="number ">1457</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1458" class="number ">1458</th>

                    <td class="" >
                        <pre>      //// Create an agent for this device, linked to the new computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1459" class="number ">1459</th>

                    <td class="" >
                        <pre>      //$agent = new PluginFlyvemdmAgent();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1460" class="number ">1460</th>

                    <td class="" >
                        <pre>      //$condition = &quot;`computers_id`=&#039;$computerId&#039;&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1461" class="number ">1461</th>

                    <td class="" >
                        <pre>      //$agentCollection = $agent-&gt;find($condition);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1462" class="number ">1462</th>

                    <td class="" >
                        <pre>      //if (count($agentCollection) &gt; 1) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1463" class="number ">1463</th>

                    <td class="" >
                        <pre>      //   return false;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1464" class="number ">1464</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1465" class="number ">1465</th>

                    <td class="" >
                        <pre>      //if (count($agentCollection) == 1) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1466" class="number ">1466</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1467" class="number ">1467</th>

                    <td class="" >
                        <pre>      //   reset($agentCollection);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1468" class="number ">1468</th>

                    <td class="" >
                        <pre>      //   $agent-&gt;getFromDB(key($agentCollection));
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1469" class="number ">1469</th>

                    <td class="" >
                        <pre>      //   $agentId = $agent-&gt;getId();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1470" class="number ">1470</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1471" class="number ">1471</th>

                    <td class="" >
                        <pre>      //} else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1472" class="number ">1472</th>

                    <td class="" >
                        <pre>      //   $agentId = $agent-&gt;add([
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1473" class="number ">1473</th>

                    <td class="" >
                        <pre>      //         &#039;entities_id&#039;     =&gt; $entity-&gt;getID(),
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1474" class="number ">1474</th>

                    <td class="" >
                        <pre>      //         &#039;computers_id&#039;    =&gt; $computer-&gt;getID(),
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1475" class="number ">1475</th>

                    <td class="" >
                        <pre>      //         &#039;token_expire&#039;    =&gt; &#039;0000-00-00 00:00:00&#039;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1476" class="number ">1476</th>

                    <td class="" >
                        <pre>      //   ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1477" class="number ">1477</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1478" class="number ">1478</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1479" class="number ">1479</th>

                    <td class="" >
                        <pre>      //if (! $agentId &gt; 0) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1480" class="number ">1480</th>

                    <td class="" >
                        <pre>      //   return false;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1481" class="number ">1481</th>

                    <td class="" >
                        <pre>      //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1482" class="number ">1482</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1483" class="number ">1483</th>

                    <td class="" >
                        <pre>      //return $agent;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1484" class="number ">1484</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1485" class="number ">1485</th>

                    <td class="" >
                        <pre>   //}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1486" class="number ">1486</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1487" class="number ">1487</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1488" class="number ">1488</th>

                    <td class="" >
                        <pre>    * Erase delete persisted MQTT topics of the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1489" class="number ">1489</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="cleanupSubtopics">
                    <th id="L1490" class="number ">1490</th>

                    <td class="" id="cleanupSubtopics">
                        <pre>   public function cleanupSubtopics() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1491" class="number covered">1491</th>

                    <td class="covered" >
                        <pre>      $topic = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1492" class="number covered">1492</th>

                    <td class="covered" >
                        <pre>      if ($topic !== null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1493" class="number covered">1493</th>

                    <td class="covered" >
                        <pre>         foreach (self::getTopicsToCleanup() as $subTopic) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1494" class="number covered">1494</th>

                    <td class="covered" >
                        <pre>            $this-&gt;notify(&quot;$topic/$subTopic&quot;, &#039;&#039;, 0, 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1495" class="number ">1495</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1496" class="number ">1496</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1497" class="number covered">1497</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1498" class="number ">1498</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1499" class="number ">1499</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1500" class="number ">1500</th>

                    <td class="" >
                        <pre>    * list of topics to cleanup on unenrollment or on enrollment
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1501" class="number ">1501</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1502" class="number ">1502</th>

                    <td class="" >
                        <pre>    * @return string[]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1503" class="number ">1503</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getTopicsToCleanup">
                    <th id="L1504" class="number ">1504</th>

                    <td class="" id="getTopicsToCleanup">
                        <pre>   public static function getTopicsToCleanup() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1505" class="number covered">1505</th>

                    <td class="covered" >
                        <pre>      $policy = new PluginFlyvemdmPolicy();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1506" class="number covered">1506</th>

                    <td class="covered" >
                        <pre>      $rows = $policy-&gt;find();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1507" class="number ">1507</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1508" class="number ">1508</th>

                    <td class="" >
                        <pre>      // get all policies sub topics
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1509" class="number covered">1509</th>

                    <td class="covered" >
                        <pre>      $topics = [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1510" class="number covered">1510</th>

                    <td class="covered" >
                        <pre>      foreach ($rows as $row) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1511" class="number covered">1511</th>

                    <td class="covered" >
                        <pre>         $topics[] = &#039;Policy/&#039; . $row[&#039;symbol&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1512" class="number ">1512</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1513" class="number covered">1513</th>

                    <td class="covered" >
                        <pre>      return array_merge($topics, [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1514" class="number covered">1514</th>

                    <td class="covered" >
                        <pre>         &#039;Command/Subscribe&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1515" class="number ">1515</th>

                    <td class="" >
                        <pre>         &#039;Command/Ping&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1516" class="number ">1516</th>

                    <td class="" >
                        <pre>         &#039;Command/Geolocate&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1517" class="number ">1517</th>

                    <td class="" >
                        <pre>         &#039;Command/Inventory&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1518" class="number ">1518</th>

                    <td class="" >
                        <pre>         &#039;Command/Lock&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1519" class="number ">1519</th>

                    <td class="" >
                        <pre>         &#039;Command/Wipe&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1520" class="number ">1520</th>

                    <td class="" >
                        <pre>         &#039;Command/Unenroll&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1521" class="number ">1521</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1522" class="number unreach">1522</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1523" class="number ">1523</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1524" class="number ">1524</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1525" class="number ">1525</th>

                    <td class="" >
                        <pre>    * Send an geolocation request to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1526" class="number ">1526</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1527" class="number ">1527</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1528" class="number ">1528</th>

                    <td class="" >
                        <pre>    * @throws AgentSendQueryException
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1529" class="number ">1529</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendGeolocationQuery">
                    <th id="L1530" class="number ">1530</th>

                    <td class="" id="sendGeolocationQuery">
                        <pre>   private function sendGeolocationQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1531" class="number ">1531</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1532" class="number uncovered">1532</th>

                    <td class="uncovered" >
                        <pre>      $computerId = $this-&gt;fields[&#039;computers_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1533" class="number uncovered">1533</th>

                    <td class="uncovered" >
                        <pre>      $geolocation = new PluginFlyvemdmGeolocation();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1534" class="number uncovered">1534</th>

                    <td class="uncovered" >
                        <pre>      $lastPositionRows = $geolocation-&gt;find(&quot;`computers_id`=&#039;$computerId&#039;&quot;, &#039;`date` DESC, `id` DESC&#039;, &#039;1&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1535" class="number uncovered">1535</th>

                    <td class="uncovered" >
                        <pre>      $lastPosition = array_pop($lastPositionRows);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1536" class="number ">1536</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1537" class="number uncovered">1537</th>

                    <td class="uncovered" >
                        <pre>      $this-&gt;notify($this-&gt;topic . &quot;/Command/Geolocate&quot;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1538" class="number uncovered">1538</th>

                    <td class="uncovered" >
                        <pre>         json_encode([&#039;query&#039; =&gt; &#039;Geolocate&#039;], JSON_UNESCAPED_SLASHES), 0, 0);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1539" class="number ">1539</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1540" class="number ">1540</th>

                    <td class="" >
                        <pre>      // Wait for a reply within a short delay
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1541" class="number uncovered">1541</th>

                    <td class="uncovered" >
                        <pre>      $loopCount = 25;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1542" class="number uncovered">1542</th>

                    <td class="uncovered" >
                        <pre>      while ($loopCount &gt; 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1543" class="number uncovered">1543</th>

                    <td class="uncovered" >
                        <pre>         usleep(200000); // 200 milliseconds</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1544" class="number uncovered">1544</th>

                    <td class="uncovered" >
                        <pre>         $loopCount--;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1545" class="number uncovered">1545</th>

                    <td class="uncovered" >
                        <pre>         $updatedPositionRows = $geolocation-&gt;find(&quot;`computers_id`=&#039;$computerId&#039;&quot;, &#039;`date` DESC, `id` DESC&#039;, &#039;1&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1546" class="number uncovered">1546</th>

                    <td class="uncovered" >
                        <pre>         $updatedPosition = array_pop($updatedPositionRows);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1547" class="number uncovered">1547</th>

                    <td class="uncovered" >
                        <pre>         if ($lastPosition === null &amp;&amp; $updatedPosition !== null</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1548" class="number uncovered">1548</th>

                    <td class="uncovered" >
                        <pre>            || $lastPosition !== null &amp;&amp; $lastPosition[&#039;id&#039;] != $updatedPosition[&#039;id&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1549" class="number uncovered">1549</th>

                    <td class="uncovered" >
                        <pre>            if ($updatedPosition[&#039;latitude&#039;] == &#039;na&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1550" class="number uncovered">1550</th>

                    <td class="uncovered" >
                        <pre>               throw new AgentSendQueryException(__(&#039;GPS is turned off or is not ready&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1551" class="number ">1551</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1552" class="number uncovered">1552</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&#039;The device sent its position&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1553" class="number uncovered">1553</th>

                    <td class="uncovered" >
                        <pre>            return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1554" class="number ">1554</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1555" class="number ">1555</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1556" class="number uncovered">1556</th>

                    <td class="uncovered" >
                        <pre>      throw new AgentSendQueryException(__(&#039;Timeout requesting position&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1557" class="number unreach">1557</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1558" class="number ">1558</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1559" class="number ">1559</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1560" class="number ">1560</th>

                    <td class="" >
                        <pre>    * Send an inventory request to the device
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1561" class="number ">1561</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1562" class="number ">1562</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1563" class="number ">1563</th>

                    <td class="" >
                        <pre>    * @throws AgentSendQueryException
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1564" class="number ">1564</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendInventoryQuery">
                    <th id="L1565" class="number ">1565</th>

                    <td class="" id="sendInventoryQuery">
                        <pre>   private function sendInventoryQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1566" class="number uncovered">1566</th>

                    <td class="uncovered" >
                        <pre>      $this-&gt;notify($this-&gt;topic . &quot;/Command/Inventory&quot;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1567" class="number uncovered">1567</th>

                    <td class="uncovered" >
                        <pre>         json_encode([&#039;query&#039; =&gt; &#039;Inventory&#039;], JSON_UNESCAPED_SLASHES), 0, 0);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1568" class="number ">1568</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1569" class="number uncovered">1569</th>

                    <td class="uncovered" >
                        <pre>      $computerFk = Computer::getForeignKeyField();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1570" class="number uncovered">1570</th>

                    <td class="uncovered" >
                        <pre>      $computerId = $this-&gt;fields[$computerFk];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1571" class="number uncovered">1571</th>

                    <td class="uncovered" >
                        <pre>      $inventory = new PluginFusioninventoryInventoryComputerComputer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1572" class="number uncovered">1572</th>

                    <td class="uncovered" >
                        <pre>      $inventoryRows = $inventory-&gt;find(&quot;`$computerFk` = &#039;$computerId&#039;&quot;, &#039;&#039;, &#039;1&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1573" class="number uncovered">1573</th>

                    <td class="uncovered" >
                        <pre>      $lastInventory = array_pop($inventoryRows);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1574" class="number ">1574</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1575" class="number uncovered">1575</th>

                    <td class="uncovered" >
                        <pre>      $loopCount = 5 * 10; // 10 seconds</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1576" class="number uncovered">1576</th>

                    <td class="uncovered" >
                        <pre>      while ($loopCount &gt; 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1577" class="number uncovered">1577</th>

                    <td class="uncovered" >
                        <pre>         usleep(200000); // 200 milliseconds</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1578" class="number uncovered">1578</th>

                    <td class="uncovered" >
                        <pre>         $loopCount--;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1579" class="number uncovered">1579</th>

                    <td class="uncovered" >
                        <pre>         $inventoryRows = $inventory-&gt;find(&quot;`$computerFk` = &#039;$computerId&#039;&quot;, &#039;&#039;, &#039;1&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1580" class="number uncovered">1580</th>

                    <td class="uncovered" >
                        <pre>         $updatedInventory = array_pop($inventoryRows);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1581" class="number uncovered">1581</th>

                    <td class="uncovered" >
                        <pre>         if ($lastInventory === null &amp;&amp; $updatedInventory !== null</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1582" class="number uncovered">1582</th>

                    <td class="uncovered" >
                        <pre>            || $lastInventory !== null &amp;&amp; $lastInventory != $updatedInventory) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1583" class="number uncovered">1583</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&#039;Inventory received&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1584" class="number uncovered">1584</th>

                    <td class="uncovered" >
                        <pre>            return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1585" class="number ">1585</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1586" class="number ">1586</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1587" class="number uncovered">1587</th>

                    <td class="uncovered" >
                        <pre>      throw new AgentSendQueryException(__(&quot;Timeout querying the device inventory&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1588" class="number unreach">1588</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1589" class="number ">1589</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1590" class="number ">1590</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1591" class="number ">1591</th>

                    <td class="" >
                        <pre>    * Sends a message on the subtopic dedicated to ping requests
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1592" class="number ">1592</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1593" class="number ">1593</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1594" class="number ">1594</th>

                    <td class="" >
                        <pre>    * @throws AgentSendQueryException
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1595" class="number ">1595</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendPingQuery">
                    <th id="L1596" class="number ">1596</th>

                    <td class="" id="sendPingQuery">
                        <pre>   private function sendPingQuery() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1597" class="number uncovered">1597</th>

                    <td class="uncovered" >
                        <pre>      $this-&gt;notify($this-&gt;topic . &quot;/Command/Ping&quot;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1598" class="number uncovered">1598</th>

                    <td class="uncovered" >
                        <pre>         json_encode([&#039;query&#039; =&gt; &#039;Ping&#039;], JSON_UNESCAPED_SLASHES), 0, 0);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1599" class="number ">1599</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1600" class="number uncovered">1600</th>

                    <td class="uncovered" >
                        <pre>      $loopCount = 25;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1601" class="number uncovered">1601</th>

                    <td class="uncovered" >
                        <pre>      $updatedAgent = new self();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1602" class="number uncovered">1602</th>

                    <td class="uncovered" >
                        <pre>      while ($loopCount &gt; 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1603" class="number uncovered">1603</th>

                    <td class="uncovered" >
                        <pre>         usleep(200000); // 200 milliseconds</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1604" class="number uncovered">1604</th>

                    <td class="uncovered" >
                        <pre>         $loopCount--;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1605" class="number uncovered">1605</th>

                    <td class="uncovered" >
                        <pre>         $updatedAgent-&gt;getFromDB($this-&gt;getID());</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1606" class="number uncovered">1606</th>

                    <td class="uncovered" >
                        <pre>         if ($updatedAgent-&gt;getField(&#039;last_contact&#039;) != $this-&gt;fields[&#039;last_contact&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1607" class="number uncovered">1607</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&#039;The device answered&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1608" class="number uncovered">1608</th>

                    <td class="uncovered" >
                        <pre>            return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1609" class="number ">1609</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1610" class="number ">1610</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1611" class="number uncovered">1611</th>

                    <td class="uncovered" >
                        <pre>      throw new AgentSendQueryException(__(&quot;Timeout querying the device&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1612" class="number unreach">1612</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1613" class="number ">1613</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1614" class="number ">1614</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1615" class="number ">1615</th>

                    <td class="" >
                        <pre>    * Attempts to sign the certificate against the CA
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1616" class="number ">1616</th>

                    <td class="" >
                        <pre>    * @param string $csr Certificate signing request
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1617" class="number ">1617</th>

                    <td class="" >
                        <pre>    * @return bool|mixed
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1618" class="number ">1618</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="signCertificate">
                    <th id="L1619" class="number ">1619</th>

                    <td class="" id="signCertificate">
                        <pre>   protected static function signCertificate($csr) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1620" class="number uncovered">1620</th>

                    <td class="uncovered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;ssl_cert_url&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1621" class="number uncovered">1621</th>

                    <td class="uncovered" >
                        <pre>      if ($config === null) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1622" class="number uncovered">1622</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1623" class="number ">1623</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1624" class="number uncovered">1624</th>

                    <td class="uncovered" >
                        <pre>      $url = $config[&#039;ssl_cert_url&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1625" class="number ">1625</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1626" class="number uncovered">1626</th>

                    <td class="uncovered" >
                        <pre>      $csr = urlencode($csr);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1627" class="number ">1627</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1628" class="number uncovered">1628</th>

                    <td class="uncovered" >
                        <pre>      $json = file_get_contents(&quot;$url/csr_sign.php?csr=$csr&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1629" class="number uncovered">1629</th>

                    <td class="uncovered" >
                        <pre>      if ($json === false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1630" class="number uncovered">1630</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1631" class="number ">1631</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1632" class="number ">1632</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1633" class="number uncovered">1633</th>

                    <td class="uncovered" >
                        <pre>      $answer = json_decode($json, true);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1634" class="number ">1634</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1635" class="number uncovered">1635</th>

                    <td class="uncovered" >
                        <pre>      return $answer;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1636" class="number unreach">1636</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1637" class="number ">1637</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1638" class="number ">1638</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1639" class="number ">1639</th>

                    <td class="" >
                        <pre>    * @see PluginFlyvemdmNotifiableInterface::getAgents()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1640" class="number ">1640</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getAgents">
                    <th id="L1641" class="number ">1641</th>

                    <td class="" id="getAgents">
                        <pre>   public function getAgents() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1642" class="number covered">1642</th>

                    <td class="covered" >
                        <pre>      return [$this];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1643" class="number unreach">1643</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1644" class="number ">1644</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1645" class="number ">1645</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1646" class="number ">1646</th>

                    <td class="" >
                        <pre>    * @see PluginFlyvemdmNotifiableInterface::getPackages()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1647" class="number ">1647</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getPackages">
                    <th id="L1648" class="number ">1648</th>

                    <td class="" id="getPackages">
                        <pre>   public function getPackages() {<span class="label label-warning">33%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1649" class="number covered">1649</th>

                    <td class="covered" >
                        <pre>      if ($this-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1650" class="number covered">1650</th>

                    <td class="covered" >
                        <pre>         return [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1651" class="number ">1651</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1652" class="number ">1652</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1653" class="number uncovered">1653</th>

                    <td class="uncovered" >
                        <pre>      $fleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1654" class="number uncovered">1654</th>

                    <td class="uncovered" >
                        <pre>      if (!$fleet-&gt;getFromDB($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1655" class="number uncovered">1655</th>

                    <td class="uncovered" >
                        <pre>         return [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1656" class="number ">1656</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1657" class="number ">1657</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1658" class="number uncovered">1658</th>

                    <td class="uncovered" >
                        <pre>      return $fleet-&gt;getPackages();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1659" class="number unreach">1659</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1660" class="number ">1660</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1661" class="number ">1661</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1662" class="number ">1662</th>

                    <td class="" >
                        <pre>    * @see PluginFlyvemdmNotifiableInterface::getFiles()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1663" class="number ">1663</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getFiles">
                    <th id="L1664" class="number ">1664</th>

                    <td class="" id="getFiles">
                        <pre>   public function getFiles() {<span class="label label-warning">33%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1665" class="number covered">1665</th>

                    <td class="covered" >
                        <pre>      if ($this-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1666" class="number covered">1666</th>

                    <td class="covered" >
                        <pre>         return [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1667" class="number ">1667</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1668" class="number ">1668</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1669" class="number uncovered">1669</th>

                    <td class="uncovered" >
                        <pre>      $fleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1670" class="number uncovered">1670</th>

                    <td class="uncovered" >
                        <pre>      if (!$fleet-&gt;getFromDB($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1671" class="number uncovered">1671</th>

                    <td class="uncovered" >
                        <pre>         return [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1672" class="number ">1672</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1673" class="number ">1673</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1674" class="number uncovered">1674</th>

                    <td class="uncovered" >
                        <pre>      return $fleet-&gt;getFiles();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1675" class="number unreach">1675</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1676" class="number ">1676</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1677" class="number ">1677</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1678" class="number ">1678</th>

                    <td class="" >
                        <pre>    * @see PluginFlyvemdmNotifiableInterface::getFleet()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1679" class="number ">1679</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getFleet">
                    <th id="L1680" class="number ">1680</th>

                    <td class="" id="getFleet">
                        <pre>   public function getFleet() {<span class="label label-success">78%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1681" class="number covered">1681</th>

                    <td class="covered" >
                        <pre>      $fleet = null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1682" class="number ">1682</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1683" class="number covered">1683</th>

                    <td class="covered" >
                        <pre>      if ($this-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1684" class="number covered">1684</th>

                    <td class="covered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1685" class="number ">1685</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1686" class="number ">1686</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1687" class="number ">1687</th>

                    <td class="" >
                        <pre>      // The agent exists in DB
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1688" class="number covered">1688</th>

                    <td class="covered" >
                        <pre>      $fleet = new PluginFlyvemdmFleet();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1689" class="number covered">1689</th>

                    <td class="covered" >
                        <pre>      if ($fleet-&gt;isNewID($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1690" class="number uncovered">1690</th>

                    <td class="uncovered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1691" class="number ">1691</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1692" class="number covered">1692</th>

                    <td class="covered" >
                        <pre>      if (!$fleet-&gt;getFromDB($this-&gt;fields[&#039;plugin_flyvemdm_fleets_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1693" class="number uncovered">1693</th>

                    <td class="uncovered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1694" class="number ">1694</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1695" class="number ">1695</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1696" class="number covered">1696</th>

                    <td class="covered" >
                        <pre>      return $fleet;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1697" class="number unreach">1697</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1698" class="number ">1698</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1699" class="number ">1699</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1700" class="number ">1700</th>

                    <td class="" >
                        <pre>    * Get the user owner of the agent&#039;s device
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1701" class="number ">1701</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getOwner">
                    <th id="L1702" class="number ">1702</th>

                    <td class="" id="getOwner">
                        <pre>   public function getOwner() {<span class="label label-success">71%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1703" class="number covered">1703</th>

                    <td class="covered" >
                        <pre>      $computer = new Computer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1704" class="number covered">1704</th>

                    <td class="covered" >
                        <pre>      if (!$computer-&gt;getFromDB($this-&gt;fields[&#039;computers_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1705" class="number uncovered">1705</th>

                    <td class="uncovered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1706" class="number ">1706</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1707" class="number covered">1707</th>

                    <td class="covered" >
                        <pre>      $user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1708" class="number covered">1708</th>

                    <td class="covered" >
                        <pre>      if (!$user-&gt;getFromDB($computer-&gt;getField(&#039;users_id&#039;))) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1709" class="number uncovered">1709</th>

                    <td class="uncovered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1710" class="number ">1710</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1711" class="number ">1711</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1712" class="number covered">1712</th>

                    <td class="covered" >
                        <pre>      return $user;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1713" class="number unreach">1713</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1714" class="number ">1714</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1715" class="number ">1715</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1716" class="number ">1716</th>

                    <td class="" >
                        <pre>    * Determine the enrollment method depending on input data
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1717" class="number ">1717</th>

                    <td class="" >
                        <pre>    * @param array $input
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1718" class="number ">1718</th>

                    <td class="" >
                        <pre>    * @return integer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1719" class="number ">1719</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="chooseEnrollMethod">
                    <th id="L1720" class="number ">1720</th>

                    <td class="" id="chooseEnrollMethod">
                        <pre>   protected function chooseEnrollMethod($input) {<span class="label label-warning">50%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1721" class="number covered">1721</th>

                    <td class="covered" >
                        <pre>      if (isset($input[&#039;_email&#039;])</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1722" class="number covered">1722</th>

                    <td class="covered" >
                        <pre>            &amp;&amp; isset($input[&#039;_invitation_token&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1723" class="number covered">1723</th>

                    <td class="covered" >
                        <pre>         return self::ENROLL_INVITATION_TOKEN;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1724" class="number uncovered">1724</th>

                    <td class="uncovered" >
                        <pre>      } else if (isset($input[&#039;_entity_token&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1725" class="number uncovered">1725</th>

                    <td class="uncovered" >
                        <pre>         return self::ENROLL_ENTITY_TOKEN;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1726" class="number ">1726</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1727" class="number ">1727</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1728" class="number uncovered">1728</th>

                    <td class="uncovered" >
                        <pre>      return self::ENROLL_DENY;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1729" class="number unreach">1729</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1730" class="number ">1730</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1731" class="number ">1731</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1732" class="number ">1732</th>

                    <td class="" >
                        <pre>    * Creates virtual fields with enrollment data
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1733" class="number ">1733</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="setupMqttAccess">
                    <th id="L1734" class="number ">1734</th>

                    <td class="" id="setupMqttAccess">
                        <pre>   protected function setupMqttAccess() {<span class="label label-success">83%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1735" class="number covered">1735</th>

                    <td class="covered" >
                        <pre>      if (!isset($_SESSION[&#039;glpiID&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1736" class="number uncovered">1736</th>

                    <td class="uncovered" >
                        <pre>         return;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1737" class="number ">1737</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1738" class="number ">1738</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1739" class="number covered">1739</th>

                    <td class="covered" >
                        <pre>      if ($user = $this-&gt;getOwner()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1740" class="number covered">1740</th>

                    <td class="covered" >
                        <pre>         $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1741" class="number covered">1741</th>

                    <td class="covered" >
                        <pre>            &#039;guest_profiles_id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1742" class="number ">1742</th>

                    <td class="" >
                        <pre>            &#039;android_bugcollecctor_url&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1743" class="number ">1743</th>

                    <td class="" >
                        <pre>            &#039;android_bugcollector_login&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1744" class="number ">1744</th>

                    <td class="" >
                        <pre>            &#039;android_bugcollector_passwd&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1745" class="number ">1745</th>

                    <td class="" >
                        <pre>            &#039;mqtt_broker_address&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1746" class="number ">1746</th>

                    <td class="" >
                        <pre>            &#039;mqtt_broker_port&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1747" class="number ">1747</th>

                    <td class="" >
                        <pre>            &#039;mqtt_broker_tls_port&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1748" class="number ">1748</th>

                    <td class="" >
                        <pre>            &#039;mqtt_tls_for_clients&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1749" class="number ">1749</th>

                    <td class="" >
                        <pre>         ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1750" class="number covered">1750</th>

                    <td class="covered" >
                        <pre>         $guestProfileId = $config[&#039;guest_profiles_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1751" class="number covered">1751</th>

                    <td class="covered" >
                        <pre>         if ($user-&gt;getID() == $_SESSION[&#039;glpiID&#039;] &amp;&amp; $_SESSION[&#039;glpiactiveprofile&#039;][&#039;id&#039;] == $guestProfileId) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1752" class="number covered">1752</th>

                    <td class="covered" >
                        <pre>            $mqttClearPassword = &#039;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1753" class="number ">1753</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1754" class="number ">1754</th>

                    <td class="" >
                        <pre>            // Create, or re-eanble the mqtt user for the device
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1755" class="number covered">1755</th>

                    <td class="covered" >
                        <pre>            $computer = new Computer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1756" class="number covered">1756</th>

                    <td class="covered" >
                        <pre>            if (!$computer-&gt;getFromDB($this-&gt;fields[&#039;computers_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1757" class="number ">1757</th>

                    <td class="" >
                        <pre>               // TODO : failed to find the computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1758" class="number uncovered">1758</th>

                    <td class="uncovered" >
                        <pre>               return;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1759" class="number ">1759</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1760" class="number covered">1760</th>

                    <td class="covered" >
                        <pre>            $serial = $computer-&gt;getField(&#039;serial&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1761" class="number covered">1761</th>

                    <td class="covered" >
                        <pre>            if (!empty($serial)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1762" class="number ">1762</th>

                    <td class="" >
                        <pre>               $acls = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1763" class="number ">1763</th>

                    <td class="" >
                        <pre>                  [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1764" class="number covered">1764</th>

                    <td class="covered" >
                        <pre>                     &#039;topic&#039;        =&gt; $this-&gt;getTopic() . &#039;/Status/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1765" class="number covered">1765</th>

                    <td class="covered" >
                        <pre>                     &#039;access_level&#039; =&gt; PluginFlyvemdmMqttacl::MQTTACL_WRITE</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1766" class="number ">1766</th>

                    <td class="" >
                        <pre>                  ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1767" class="number ">1767</th>

                    <td class="" >
                        <pre>                  [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1768" class="number covered">1768</th>

                    <td class="covered" >
                        <pre>                     &#039;topic&#039;        =&gt; $this-&gt;getTopic() . &#039;/Command/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1769" class="number covered">1769</th>

                    <td class="covered" >
                        <pre>                     &#039;access_level&#039; =&gt; PluginFlyvemdmMqttacl::MQTTACL_READ</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1770" class="number ">1770</th>

                    <td class="" >
                        <pre>                  ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1771" class="number ">1771</th>

                    <td class="" >
                        <pre>                  [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1772" class="number covered">1772</th>

                    <td class="covered" >
                        <pre>                     &#039;topic&#039;        =&gt; $this-&gt;getTopic() . &#039;/Policy/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1773" class="number covered">1773</th>

                    <td class="covered" >
                        <pre>                     &#039;access_level&#039; =&gt; PluginFlyvemdmMqttacl::MQTTACL_READ</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1774" class="number ">1774</th>

                    <td class="" >
                        <pre>                  ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1775" class="number ">1775</th>

                    <td class="" >
                        <pre>                  [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1776" class="number covered">1776</th>

                    <td class="covered" >
                        <pre>                     &#039;topic&#039;        =&gt; $this-&gt;getTopic() . &#039;/FlyvemdmManifest/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1777" class="number covered">1777</th>

                    <td class="covered" >
                        <pre>                     &#039;access_level&#039; =&gt; PluginFlyvemdmMqttacl::MQTTACL_WRITE</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1778" class="number ">1778</th>

                    <td class="" >
                        <pre>                  ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1779" class="number ">1779</th>

                    <td class="" >
                        <pre>                  [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1780" class="number covered">1780</th>

                    <td class="covered" >
                        <pre>                     &#039;topic&#039;        =&gt; &#039;/FlyvemdmManifest/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1781" class="number covered">1781</th>

                    <td class="covered" >
                        <pre>                     &#039;access_level&#039; =&gt; PluginFlyvemdmMqttacl::MQTTACL_READ</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1782" class="number ">1782</th>

                    <td class="" >
                        <pre>                  ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1783" class="number ">1783</th>

                    <td class="" >
                        <pre>               ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1784" class="number ">1784</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1785" class="number covered">1785</th>

                    <td class="covered" >
                        <pre>               $mqttUser = new PluginFlyvemdmMqttuser();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1786" class="number covered">1786</th>

                    <td class="covered" >
                        <pre>               $mqttClearPassword = PluginFlyvemdmMqttuser::getRandomPassword();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1787" class="number ">1787</th>

                    <td class="" >
                        <pre>               // TODO: try make the enrollment fails at this point if getRandomPassword throw exception.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1788" class="number covered">1788</th>

                    <td class="covered" >
                        <pre>               if (!$mqttUser-&gt;getByUser($serial)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1789" class="number ">1789</th>

                    <td class="" >
                        <pre>                  // The user does not exists
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1790" class="number covered">1790</th>

                    <td class="covered" >
                        <pre>                  $mqttUser-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1791" class="number covered">1791</th>

                    <td class="covered" >
                        <pre>                     &#039;user&#039;         =&gt; $serial,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1792" class="number covered">1792</th>

                    <td class="covered" >
                        <pre>                     &#039;enabled&#039;      =&gt; &#039;1&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1793" class="number covered">1793</th>

                    <td class="covered" >
                        <pre>                     &#039;password&#039;     =&gt; $mqttClearPassword,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1794" class="number covered">1794</th>

                    <td class="covered" >
                        <pre>                     &#039;_acl&#039;         =&gt; $acls,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1795" class="number ">1795</th>

                    <td class="" >
                        <pre>                     &#039;_reset_acl&#039;   =&gt; true,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1796" class="number ">1796</th>

                    <td class="" >
                        <pre>                  ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1797" class="number ">1797</th>

                    <td class="" >
                        <pre>               } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1798" class="number ">1798</th>

                    <td class="" >
                        <pre>                  // The user exists
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1799" class="number uncovered">1799</th>

                    <td class="uncovered" >
                        <pre>                  $mqttUser-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1800" class="number uncovered">1800</th>

                    <td class="uncovered" >
                        <pre>                     &#039;id&#039;          =&gt; $mqttUser-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1801" class="number uncovered">1801</th>

                    <td class="uncovered" >
                        <pre>                     &#039;enabled&#039;     =&gt; &#039;1&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1802" class="number uncovered">1802</th>

                    <td class="uncovered" >
                        <pre>                     &#039;password&#039;    =&gt; $mqttClearPassword,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1803" class="number uncovered">1803</th>

                    <td class="uncovered" >
                        <pre>                     &#039;_acl&#039;        =&gt; $acls,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1804" class="number ">1804</th>

                    <td class="" >
                        <pre>                     &#039;_reset_acl&#039;  =&gt; true,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1805" class="number ">1805</th>

                    <td class="" >
                        <pre>                  ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1806" class="number ">1806</th>

                    <td class="" >
                        <pre>               }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1807" class="number ">1807</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1808" class="number ">1808</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1809" class="number ">1809</th>

                    <td class="" >
                        <pre>            // The request comes from the owner of the device or the device itself, mandated by the user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1810" class="number covered">1810</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;topic&#039;]                       = $this-&gt;getTopic();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1811" class="number covered">1811</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;mqttpasswd&#039;]                  = $mqttClearPassword;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1812" class="number covered">1812</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;broker&#039;]                      = $config[&#039;mqtt_broker_address&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1813" class="number covered">1813</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;port&#039;]                        = $config[&#039;mqtt_tls_for_clients&#039;] !== &#039;0&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1814" class="number uncovered">1814</th>

                    <td class="uncovered" >
                        <pre>                                                           ? $config[&#039;mqtt_broker_tls_port&#039;]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1815" class="number covered">1815</th>

                    <td class="covered" >
                        <pre>                                                           : $config[&#039;mqtt_broker_port&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1816" class="number covered">1816</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;tls&#039;]                         = $config[&#039;mqtt_tls_for_clients&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1817" class="number covered">1817</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;android_bugcollecctor_url&#039;]   = $config[&#039;android_bugcollecctor_url&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1818" class="number covered">1818</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;android_bugcollector_login&#039;]  = $config[&#039;android_bugcollector_login&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1819" class="number covered">1819</th>

                    <td class="covered" >
                        <pre>            $this-&gt;fields[&#039;android_bugcollector_passwd&#039;] = $config[&#039;android_bugcollector_passwd&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1820" class="number ">1820</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1821" class="number ">1821</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1822" class="number covered">1822</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1823" class="number ">1823</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1824" class="number ">1824</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1825" class="number ">1825</th>

                    <td class="" >
                        <pre>    * If debug node is disabled, disable detailed error messages
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1826" class="number ">1826</th>

                    <td class="" >
                        <pre>    * @param string $error
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1827" class="number ">1827</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="filterMessages">
                    <th id="L1828" class="number ">1828</th>

                    <td class="" id="filterMessages">
                        <pre>   protected function filterMessages($error) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1829" class="number uncovered">1829</th>

                    <td class="uncovered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;debug_enrolment&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1830" class="number uncovered">1830</th>

                    <td class="uncovered" >
                        <pre>      if ($config[&#039;debug_enrolment&#039;] == 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1831" class="number uncovered">1831</th>

                    <td class="uncovered" >
                        <pre>         $error = __(&#039;Enrollment failed&#039;, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1832" class="number ">1832</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1833" class="number uncovered">1833</th>

                    <td class="uncovered" >
                        <pre>      Session::addMessageAfterRedirect($error, false, ERROR);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1834" class="number uncovered">1834</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1835" class="number ">1835</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1836" class="number ">1836</th>

                    <td class="" >
                        <pre>    * Logs invitation events
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1837" class="number ">1837</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmInvitation $invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1838" class="number ">1838</th>

                    <td class="" >
                        <pre>    * @param string $event
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1839" class="number ">1839</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="logInvitationEvent">
                    <th id="L1840" class="number ">1840</th>

                    <td class="" id="logInvitationEvent">
                        <pre>   protected function logInvitationEvent(PluginFlyvemdmInvitation $invitation, $event) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1841" class="number uncovered">1841</th>

                    <td class="uncovered" >
                        <pre>      $invitationLog = new PluginFlyvemdmInvitationlog();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1842" class="number uncovered">1842</th>

                    <td class="uncovered" >
                        <pre>      $invitationLog-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1843" class="number uncovered">1843</th>

                    <td class="uncovered" >
                        <pre>            &#039;plugin_flyvemdm_invitations_id&#039; =&gt; $invitation-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1844" class="number uncovered">1844</th>

                    <td class="uncovered" >
                        <pre>            &#039;event&#039;                          =&gt; $event</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1845" class="number ">1845</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1846" class="number uncovered">1846</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1847" class="number ">1847</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1848" class="number ">1848</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1849" class="number ">1849</th>

                    <td class="" >
                        <pre>    * Update settings related to fleet change
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1850" class="number ">1850</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmFleet $old old fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1851" class="number ">1851</th>

                    <td class="" >
                        <pre>    * @param PluginFlyvemdmFleet $new new fleet
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1852" class="number ">1852</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="changeMqttAcl">
                    <th id="L1853" class="number ">1853</th>

                    <td class="" id="changeMqttAcl">
                        <pre>   protected function changeMqttAcl(PluginFlyvemdmFleet $old, PluginFlyvemdmFleet $new) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1854" class="number ">1854</th>

                    <td class="" >
                        <pre>      // Update MQTT account
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1855" class="number uncovered">1855</th>

                    <td class="uncovered" >
                        <pre>      $computerId = $this-&gt;getField(&#039;computers_id&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1856" class="number uncovered">1856</th>

                    <td class="uncovered" >
                        <pre>      $mqttUser = new PluginFlyvemdmMqttuser();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1857" class="number uncovered">1857</th>

                    <td class="uncovered" >
                        <pre>      if (method_exists($this, &#039;getFromDBByRequest&#039;)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1858" class="number ">1858</th>

                    <td class="" >
                        <pre>         $request = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1859" class="number ">1859</th>

                    <td class="" >
                        <pre>            &#039;LEFT JOIN&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1860" class="number uncovered">1860</th>

                    <td class="uncovered" >
                        <pre>               Computer::getTable() =&gt; [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1861" class="number ">1861</th>

                    <td class="" >
                        <pre>                  &#039;FKEY&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1862" class="number uncovered">1862</th>

                    <td class="uncovered" >
                        <pre>                     Computer::getTable() =&gt; &#039;serial&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1863" class="number uncovered">1863</th>

                    <td class="uncovered" >
                        <pre>                     PluginFlyvemdmMqttuser::getTable() =&gt; &#039;user&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1864" class="number ">1864</th>

                    <td class="" >
                        <pre>                  ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1865" class="number ">1865</th>

                    <td class="" >
                        <pre>               ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1866" class="number ">1866</th>

                    <td class="" >
                        <pre>            ],
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1867" class="number uncovered">1867</th>

                    <td class="uncovered" >
                        <pre>            &#039;WHERE&#039; =&gt; [Computer::getTable() . &#039;.id&#039; =&gt; $computerId]</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1868" class="number ">1868</th>

                    <td class="" >
                        <pre>         ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1869" class="number uncovered">1869</th>

                    <td class="uncovered" >
                        <pre>         $success = $mqttUser-&gt;getFromDBByRequest($request);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1870" class="number ">1870</th>

                    <td class="" >
                        <pre>      } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1871" class="number uncovered">1871</th>

                    <td class="uncovered" >
                        <pre>         $success = $mqttUser-&gt;getFromDBByQuery(&quot;LEFT JOIN `glpi_computers` `c` ON (`c`.`serial`=`user`) WHERE `c`.`id`=&#039;$computerId&#039;&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1872" class="number ">1872</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1873" class="number uncovered">1873</th>

                    <td class="uncovered" >
                        <pre>      if ($success) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1874" class="number uncovered">1874</th>

                    <td class="uncovered" >
                        <pre>         $mqttAcl = new PluginFlyvemdmMqttacl();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1875" class="number uncovered">1875</th>

                    <td class="uncovered" >
                        <pre>         if ($old-&gt;getField(&#039;is_default&#039;) == &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1876" class="number uncovered">1876</th>

                    <td class="uncovered" >
                        <pre>            $mqttAcl-&gt;getFromDBByCrit([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1877" class="number ">1877</th>

                    <td class="" >
                        <pre>               &#039;AND&#039; =&gt; [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1878" class="number uncovered">1878</th>

                    <td class="uncovered" >
                        <pre>                  &#039;topic&#039; =&gt; $old-&gt;getTopic() . &#039;/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1879" class="number uncovered">1879</th>

                    <td class="uncovered" >
                        <pre>                  PluginFlyvemdmMqttuser::getForeignKeyField() =&gt; $mqttUser-&gt;getID()</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1880" class="number ">1880</th>

                    <td class="" >
                        <pre>               ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1881" class="number ">1881</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1882" class="number uncovered">1882</th>

                    <td class="uncovered" >
                        <pre>            if ($new-&gt;getField(&#039;is_default&#039;) != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1883" class="number uncovered">1883</th>

                    <td class="uncovered" >
                        <pre>               $mqttAcl-&gt;delete([&#039;id&#039; =&gt; $mqttAcl-&gt;getID()]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1884" class="number ">1884</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1885" class="number ">1885</th>

                    <td class="" >
                        <pre>            } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1886" class="number uncovered">1886</th>

                    <td class="uncovered" >
                        <pre>               $mqttAcl-&gt;update([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1887" class="number uncovered">1887</th>

                    <td class="uncovered" >
                        <pre>                     &#039;id&#039;                             =&gt; $mqttAcl-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1888" class="number uncovered">1888</th>

                    <td class="uncovered" >
                        <pre>                     &#039;topic&#039;                          =&gt; $new-&gt;getTopic() . &#039;/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1889" class="number uncovered">1889</th>

                    <td class="uncovered" >
                        <pre>                     &#039;access_level&#039;                   =&gt; PluginFlyvemdmMqttacl::MQTTACL_READ</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1890" class="number ">1890</th>

                    <td class="" >
                        <pre>               ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1891" class="number ">1891</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1892" class="number ">1892</th>

                    <td class="" >
                        <pre>         } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1893" class="number uncovered">1893</th>

                    <td class="uncovered" >
                        <pre>            $mqttAcl-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1894" class="number uncovered">1894</th>

                    <td class="uncovered" >
                        <pre>                  &#039;plugin_flyvemdm_mqttusers_id&#039;   =&gt; $mqttUser-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1895" class="number uncovered">1895</th>

                    <td class="uncovered" >
                        <pre>                  &#039;topic&#039;                          =&gt; $new-&gt;getTopic() . &#039;/#&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1896" class="number uncovered">1896</th>

                    <td class="uncovered" >
                        <pre>                  &#039;access_level&#039;                   =&gt; PluginFlyvemdmMqttacl::MQTTACL_READ</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1897" class="number ">1897</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1898" class="number ">1898</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1899" class="number ">1899</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1900" class="number uncovered">1900</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1901" class="number ">1901</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1902" class="number ">1902</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1903" class="number ">1903</th>

                    <td class="" >
                        <pre>    * Get the computer associatated to the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1904" class="number ">1904</th>

                    <td class="" >
                        <pre>    * @return NULL|Computer
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1905" class="number ">1905</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getComputer">
                    <th id="L1906" class="number ">1906</th>

                    <td class="" id="getComputer">
                        <pre>   public function getComputer() {<span class="label label-success">83%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1907" class="number covered">1907</th>

                    <td class="covered" >
                        <pre>      if (!isset($this-&gt;fields[&#039;computers_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1908" class="number covered">1908</th>

                    <td class="covered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1909" class="number ">1909</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1910" class="number ">1910</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1911" class="number covered">1911</th>

                    <td class="covered" >
                        <pre>      $computer = new Computer();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1912" class="number covered">1912</th>

                    <td class="covered" >
                        <pre>      if (!$computer-&gt;getFromDB($this-&gt;fields[&#039;computers_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1913" class="number uncovered">1913</th>

                    <td class="uncovered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1914" class="number ">1914</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1915" class="number ">1915</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1916" class="number covered">1916</th>

                    <td class="covered" >
                        <pre>      return $computer;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1917" class="number unreach">1917</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1918" class="number ">1918</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1919" class="number ">1919</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1920" class="number ">1920</th>

                    <td class="" >
                        <pre>    * @param string $topic
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1921" class="number ">1921</th>

                    <td class="" >
                        <pre>    * @param string $mqttMessage
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1922" class="number ">1922</th>

                    <td class="" >
                        <pre>    * @param integer $qos
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1923" class="number ">1923</th>

                    <td class="" >
                        <pre>    * @param integer $retain
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1924" class="number ">1924</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="notify">
                    <th id="L1925" class="number ">1925</th>

                    <td class="" id="notify">
                        <pre>   public function notify($topic, $mqttMessage, $qos = 0, $retain = 0) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1926" class="number covered">1926</th>

                    <td class="covered" >
                        <pre>      $mqttClient = PluginFlyvemdmMqttclient::getInstance();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1927" class="number covered">1927</th>

                    <td class="covered" >
                        <pre>      $mqttClient-&gt;publish($topic, $mqttMessage, $qos, $retain);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1928" class="number covered">1928</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1929" class="number ">1929</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1930" class="number ">1930</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1931" class="number ">1931</th>

                    <td class="" >
                        <pre>    * purges agents in the entity being purged
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1932" class="number ">1932</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1933" class="number ">1933</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1934" class="number ">1934</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="hook_entity_purge">
                    <th id="L1935" class="number ">1935</th>

                    <td class="" id="hook_entity_purge">
                        <pre>   public function hook_entity_purge(CommonDBTM $item) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1936" class="number uncovered">1936</th>

                    <td class="uncovered" >
                        <pre>      $agent = new static();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1937" class="number uncovered">1937</th>

                    <td class="uncovered" >
                        <pre>      $agent-&gt;deleteByCriteria([&#039;entities_id&#039; =&gt; $item-&gt;getField(&#039;id&#039;)], 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1938" class="number uncovered">1938</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1939" class="number ">1939</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1940" class="number ">1940</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1941" class="number ">1941</th>

                    <td class="" >
                        <pre>    * Deletes agents related to the computers id
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1942" class="number ">1942</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1943" class="number ">1943</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="hook_computer_purge">
                    <th id="L1944" class="number ">1944</th>

                    <td class="" id="hook_computer_purge">
                        <pre>   public function hook_computer_purge(CommonDBTM $item) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1945" class="number uncovered">1945</th>

                    <td class="uncovered" >
                        <pre>      $agent = new static();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1946" class="number uncovered">1946</th>

                    <td class="uncovered" >
                        <pre>      $agent-&gt;deleteByCriteria([&#039;computers_id&#039; =&gt; $item-&gt;getField(&#039;id&#039;)], 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1947" class="number uncovered">1947</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1948" class="number ">1948</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="refreshPersistedNotifications">
                    <th id="L1949" class="number ">1949</th>

                    <td class="" id="refreshPersistedNotifications">
                        <pre>   public function refreshPersistedNotifications() {<span class="label label-danger">22%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1950" class="number covered">1950</th>

                    <td class="covered" >
                        <pre>      if ($this-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1951" class="number covered">1951</th>

                    <td class="covered" >
                        <pre>         return;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1952" class="number ">1952</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1953" class="number ">1953</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1954" class="number uncovered">1954</th>

                    <td class="uncovered" >
                        <pre>      if ($this-&gt;fields[&#039;wipe&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1955" class="number uncovered">1955</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendWipeQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1956" class="number ">1956</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1957" class="number ">1957</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1958" class="number uncovered">1958</th>

                    <td class="uncovered" >
                        <pre>      if ($this-&gt;fields[&#039;lock&#039;] != &#039;0&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1959" class="number uncovered">1959</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendLockQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1960" class="number ">1960</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1961" class="number ">1961</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1962" class="number uncovered">1962</th>

                    <td class="uncovered" >
                        <pre>      if ($this-&gt;fields[&#039;enroll_status&#039;] != &#039;unenrolling&#039;) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1963" class="number uncovered">1963</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendUnenrollQuery();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1964" class="number ">1964</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1965" class="number uncovered">1965</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1966" class="number ">1966</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1967" class="number ">1967</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1968" class="number ">1968</th>

                    <td class="" >
                        <pre>    * Is the agent notifiable ?
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1969" class="number ">1969</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1970" class="number ">1970</th>

                    <td class="" >
                        <pre>    * @return boolean
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1971" class="number ">1971</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="isNotifiable">
                    <th id="L1972" class="number ">1972</th>

                    <td class="" id="isNotifiable">
                        <pre>   public function isNotifiable() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1973" class="number covered">1973</th>

                    <td class="covered" >
                        <pre>      return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1974" class="number unreach">1974</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1975" class="number ">1975</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1976" class="number ">1976</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1977" class="number ">1977</th>

                    <td class="" >
                        <pre>    * Define how to display a specific value in search result table
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1978" class="number ">1978</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1979" class="number ">1979</th>

                    <td class="" >
                        <pre>    * @param  String $field   Name of the field as define in $this-&gt;getSearchOptions()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1980" class="number ">1980</th>

                    <td class="" >
                        <pre>    * @param  Mixed  $values  The value as it is stored in DB
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1981" class="number ">1981</th>

                    <td class="" >
                        <pre>    * @param  Array  $options Options (optional)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1982" class="number ">1982</th>

                    <td class="" >
                        <pre>    * @return Mixed           Value to be displayed
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1983" class="number ">1983</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getSpecificValueToDisplay">
                    <th id="L1984" class="number ">1984</th>

                    <td class="" id="getSpecificValueToDisplay">
                        <pre>   public static function getSpecificValueToDisplay($field, $values, array $options = []) {<span class="label label-success">88%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1985" class="number covered">1985</th>

                    <td class="covered" >
                        <pre>      if (!is_array($values)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1986" class="number covered">1986</th>

                    <td class="covered" >
                        <pre>         $values = [$field =&gt; $values];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1987" class="number ">1987</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1988" class="number covered">1988</th>

                    <td class="covered" >
                        <pre>      switch ($field) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1989" class="number covered">1989</th>

                    <td class="covered" >
                        <pre>         case &#039;is_online&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1990" class="number covered">1990</th>

                    <td class="covered" >
                        <pre>            if (!isAPI()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1991" class="number covered">1991</th>

                    <td class="covered" >
                        <pre>               $class = $values[$field] == 0 ? &quot;plugin-flyvemdm-offline&quot; : &quot;plugin-flyvemdm-online&quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1992" class="number ">1992</th>

                    <td class="" >
                        <pre>               $output = &#039;&lt;div style=&quot;text-align: center&quot;&gt;&lt;i class=&quot;fa fa-circle &#039;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1993" class="number covered">1993</th>

                    <td class="covered" >
                        <pre>                  . $class</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1994" class="number covered">1994</th>

                    <td class="covered" >
                        <pre>                  . &#039;&quot; aria-hidden=&quot;true&quot; &gt;&lt;/i&gt;&lt;/div&gt;&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1995" class="number covered">1995</th>

                    <td class="covered" >
                        <pre>               return $output;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1996" class="number ">1996</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1997" class="number uncovered">1997</th>

                    <td class="uncovered" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1998" class="number covered">1998</th>

                    <td class="covered" >
                        <pre>         case &#039;mdm_type&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L1999" class="number covered">1999</th>

                    <td class="covered" >
                        <pre>            if (!isAPI()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2000" class="number covered">2000</th>

                    <td class="covered" >
                        <pre>               $enumtypes = self::getEnumMdmType();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2001" class="number covered">2001</th>

                    <td class="covered" >
                        <pre>               return $enumtypes[$values[$field]];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2002" class="number ">2002</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2003" class="number uncovered">2003</th>

                    <td class="uncovered" >
                        <pre>            break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2004" class="number ">2004</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2005" class="number covered">2005</th>

                    <td class="covered" >
                        <pre>      return parent::getSpecificValueToDisplay($field, $values, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2006" class="number unreach">2006</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2007" class="number ">2007</th>

                    <td class="" >
                        <pre>}
</pre>
                    </td>
                </tr>
                        </tbody>
        </table>
    </div>
    </div>

    <footer class="row">
        <div class="col-lg-12">
            <small class="pull-right">Powered by <a href="http://atoum.org"><img src="assets/logo.png" alt="atoum"/></a></small>
        </div>
    </footer>
</div>

<script>
    $(function() {
        $('table.sort').tablesorter();
    })
</script>

</body>

</html>
