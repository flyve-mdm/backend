---
layout: coverage
---
<html>

<head>
    <script src="assets/d3.js" charset="utf-8"></script>
    <script src="assets/dagre-d3.js"></script>
    <script src="assets/jquery.js"></script>
    <script src="assets/jquery.tablesorter.js"></script>
    <script src="assets/report.js"></script>

    <link rel="stylesheet" href="assets/font-awesome.min.css">
</head>

<body>

<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="index.html"><img src="assets/logo.png" alt="atoum"/> Code coverage report</a>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="col-lg-12">
            <div class="row">
        <h1>PluginFlyvemdmInvitation: lines coverage</h1>

        


<table class="table table-bordered">
    <tr>
        
                    <td style="text-align: center; width: 100%">
                <h1 class="text-warning">
                    63%
                                            <small>of 278</small>
                                    </h1>
                <strong>Lines</strong>
            </td>
        
        
            </tr>
</table>

<table class="table table-bordered table-striped table-hover sort">
    <thead>
    <tr>
        <th>Method <i class="fa"></i></th>
                            <th style="text-align: center">Lines <i class="fa"></i></th>
            <th style="text-align: center">Line % <i class="fa"></i></th>
                            </tr>
    </thead>

    <tbody>
            <tr>
            <td><a href="#getEnumInvitationStatus">PluginFlyvemdmInvitation::getEnumInvitationStatus()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getTypeName">PluginFlyvemdmInvitation::getTypeName()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getMenuPicture">PluginFlyvemdmInvitation::getMenuPicture()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getRights">PluginFlyvemdmInvitation::getRights()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#prepareInputForAdd">PluginFlyvemdmInvitation::prepareInputForAdd()</a></td>
                                        <td style="text-align: center">67</td>
                <td style="text-align: center">    
    <span class="label label-warning">64%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#prepareInputForUpdate">PluginFlyvemdmInvitation::prepareInputForUpdate()</a></td>
                                        <td style="text-align: center">11</td>
                <td style="text-align: center">    
    <span class="label label-warning">45%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getFromDBByToken">PluginFlyvemdmInvitation::getFromDBByToken()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#setInvitationToken">PluginFlyvemdmInvitation::setInvitationToken()</a></td>
                                        <td style="text-align: center">4</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#pre_deleteItem">PluginFlyvemdmInvitation::pre_deleteItem()</a></td>
                                        <td style="text-align: center">2</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_addItem">PluginFlyvemdmInvitation::post_addItem()</a></td>
                                        <td style="text-align: center">5</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#post_updateItem">PluginFlyvemdmInvitation::post_updateItem()</a></td>
                                        <td style="text-align: center">10</td>
                <td style="text-align: center">    
    <span class="label label-success">70%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#hook_pre_invitation_purge">PluginFlyvemdmInvitation::hook_pre_invitation_purge()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#hook_pre_document_purge">PluginFlyvemdmInvitation::hook_pre_document_purge()</a></td>
                                        <td style="text-align: center">8</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getUser">PluginFlyvemdmInvitation::getUser()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#createQRCodeDocument">PluginFlyvemdmInvitation::createQRCodeDocument()</a></td>
                                        <td style="text-align: center">32</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getEnrollmentUrl">PluginFlyvemdmInvitation::getEnrollmentUrl()</a></td>
                                        <td style="text-align: center">19</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#sendInvitation">PluginFlyvemdmInvitation::sendInvitation()</a></td>
                                        <td style="text-align: center">4</td>
                <td style="text-align: center">    
    <span class="label label-success">100%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#getSearchOptionsNew">PluginFlyvemdmInvitation::getSearchOptionsNew()</a></td>
                                        <td style="text-align: center">1</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#rawSearchOptions">PluginFlyvemdmInvitation::rawSearchOptions()</a></td>
                                        <td style="text-align: center">34</td>
                <td style="text-align: center">    
    <span class="label label-success">97%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#hook_entity_purge">PluginFlyvemdmInvitation::hook_entity_purge()</a></td>
                                        <td style="text-align: center">3</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#showForm">PluginFlyvemdmInvitation::showForm()</a></td>
                                        <td style="text-align: center">18</td>
                <td style="text-align: center">    
    <span class="label label-success">94%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#showMassiveActionInviteUser">PluginFlyvemdmInvitation::showMassiveActionInviteUser()</a></td>
                                        <td style="text-align: center">4</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#showMassiveActionsSubForm">PluginFlyvemdmInvitation::showMassiveActionsSubForm()</a></td>
                                        <td style="text-align: center">6</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
            <tr>
            <td><a href="#processMassiveActionsForOneItemtype">PluginFlyvemdmInvitation::processMassiveActionsForOneItemtype()</a></td>
                                        <td style="text-align: center">31</td>
                <td style="text-align: center">    
    <span class="label label-danger">0%</span>
</td>
                                            </tr>
        </tbody>
</table>

        <table class="table table-bordered table-stripped">
            <thead>
            <tr>
                <th>#</th>
                <th></th>
            </tr>
            </thead>

            <tbody>
                            <tr class="line" id="">
                    <th id="L1" class="number ">1</th>

                    <td class="" >
                        <pre>&lt;?php
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L2" class="number ">2</th>

                    <td class="" >
                        <pre>/**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L3" class="number ">3</th>

                    <td class="" >
                        <pre> * LICENSE
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L4" class="number ">4</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L5" class="number ">5</th>

                    <td class="" >
                        <pre> * Copyright © 2016-2018 Teclib&#039;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L6" class="number ">6</th>

                    <td class="" >
                        <pre> * Copyright © 2010-2018 by the FusionInventory Development Team.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L7" class="number ">7</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L8" class="number ">8</th>

                    <td class="" >
                        <pre> * This file is part of Flyve MDM Plugin for GLPI.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L9" class="number ">9</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L10" class="number ">10</th>

                    <td class="" >
                        <pre> * Flyve MDM Plugin for GLPI is a subproject of Flyve MDM. Flyve MDM is a mobile
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L11" class="number ">11</th>

                    <td class="" >
                        <pre> * device management software.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L12" class="number ">12</th>

                    <td class="" >
                        <pre> *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L13" class="number ">13</th>

                    <td class="" >
                        <pre> * Flyve MDM Plugin for GLPI is free software: you can redistribute it and/or
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L14" class="number ">14</th>

                    <td class="" >
                        <pre> * modify it under the terms of the GNU Affero General Public License as published
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L15" class="number ">15</th>

                    <td class="" >
                        <pre> * by the Free Software Foundation, either version 3 of the License, or
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L16" class="number ">16</th>

                    <td class="" >
                        <pre> * (at your option) any later version.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L17" class="number ">17</th>

                    <td class="" >
                        <pre> * Flyve MDM Plugin for GLPI is distributed in the hope that it will be useful,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L18" class="number ">18</th>

                    <td class="" >
                        <pre> * but WITHOUT ANY WARRANTY; without even the implied warranty of
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L19" class="number ">19</th>

                    <td class="" >
                        <pre> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L20" class="number ">20</th>

                    <td class="" >
                        <pre> * GNU Affero General Public License for more details.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L21" class="number ">21</th>

                    <td class="" >
                        <pre> * You should have received a copy of the GNU Affero General Public License
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L22" class="number ">22</th>

                    <td class="" >
                        <pre> * along with Flyve MDM Plugin for GLPI. If not, see http://www.gnu.org/licenses/.
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L23" class="number ">23</th>

                    <td class="" >
                        <pre> * ------------------------------------------------------------------------------
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L24" class="number ">24</th>

                    <td class="" >
                        <pre> * @author    Thierry Bugier
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L25" class="number ">25</th>

                    <td class="" >
                        <pre> * @copyright Copyright © 2018 Teclib
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L26" class="number ">26</th>

                    <td class="" >
                        <pre> * @license   AGPLv3+ http://www.gnu.org/licenses/agpl.txt
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L27" class="number ">27</th>

                    <td class="" >
                        <pre> * @link      https://github.com/flyve-mdm/glpi-plugin
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L28" class="number ">28</th>

                    <td class="" >
                        <pre> * @link      https://flyve-mdm.com/
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L29" class="number ">29</th>

                    <td class="" >
                        <pre> * ------------------------------------------------------------------------------
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L30" class="number ">30</th>

                    <td class="" >
                        <pre> */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L31" class="number ">31</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L32" class="number ">32</th>

                    <td class="" >
                        <pre>if (!defined(&#039;GLPI_ROOT&#039;)) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L33" class="number ">33</th>

                    <td class="" >
                        <pre>   die(&quot;Sorry. You can&#039;t access this file directly&quot;);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L34" class="number ">34</th>

                    <td class="" >
                        <pre>}
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L35" class="number ">35</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L36" class="number ">36</th>

                    <td class="" >
                        <pre>class PluginFlyvemdmInvitation extends CommonDBTM {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L37" class="number ">37</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L38" class="number ">38</th>

                    <td class="" >
                        <pre>   const DEFAULT_TOKEN_LIFETIME = &quot;P7D&quot;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L39" class="number ">39</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L40" class="number ">40</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L41" class="number ">41</th>

                    <td class="" >
                        <pre>    * @var string $rightname name of the right in DB
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L42" class="number ">42</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L43" class="number ">43</th>

                    <td class="" >
                        <pre>   public static $rightname = &#039;flyvemdm:invitation&#039;;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L44" class="number ">44</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L45" class="number ">45</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L46" class="number ">46</th>

                    <td class="" >
                        <pre>    * @var User The invited user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L47" class="number ">47</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L48" class="number ">48</th>

                    <td class="" >
                        <pre>   protected $user;
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L49" class="number ">49</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L50" class="number ">50</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L51" class="number ">51</th>

                    <td class="" >
                        <pre>    * Gets the possibles statuses that an invitation can have
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L52" class="number ">52</th>

                    <td class="" >
                        <pre>    * @return array the possibles statuses of the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L53" class="number ">53</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getEnumInvitationStatus">
                    <th id="L54" class="number ">54</th>

                    <td class="" id="getEnumInvitationStatus">
                        <pre>   public function getEnumInvitationStatus() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L55" class="number ">55</th>

                    <td class="" >
                        <pre>      return [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L56" class="number covered">56</th>

                    <td class="covered" >
                        <pre>         &#039;pending&#039; =&gt; __(&#039;Pending&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L57" class="number covered">57</th>

                    <td class="covered" >
                        <pre>         &#039;done&#039;    =&gt; __(&#039;Done&#039;, &#039;flyvemdm&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L58" class="number ">58</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L59" class="number unreach">59</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L60" class="number ">60</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L61" class="number ">61</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L62" class="number ">62</th>

                    <td class="" >
                        <pre>    * Localized name of the type
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L63" class="number ">63</th>

                    <td class="" >
                        <pre>    * @param integer $nb number of item in the type (default 0)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L64" class="number ">64</th>

                    <td class="" >
                        <pre>    * @return string
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L65" class="number ">65</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getTypeName">
                    <th id="L66" class="number ">66</th>

                    <td class="" id="getTypeName">
                        <pre>   public static function getTypeName($nb = 0) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L67" class="number covered">67</th>

                    <td class="covered" >
                        <pre>      return _n(&#039;Invitation&#039;, &#039;Invitations&#039;, $nb, &#039;flyvemdm&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L68" class="number unreach">68</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L69" class="number ">69</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L70" class="number ">70</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L71" class="number ">71</th>

                    <td class="" >
                        <pre>    * Returns the URI to the picture file relative to the front/folder of the plugin
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L72" class="number ">72</th>

                    <td class="" >
                        <pre>    * @return string URI to the picture file
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L73" class="number ">73</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getMenuPicture">
                    <th id="L74" class="number ">74</th>

                    <td class="" id="getMenuPicture">
                        <pre>   public static function getMenuPicture() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L75" class="number covered">75</th>

                    <td class="covered" >
                        <pre>      return &#039;fa-paper-plane&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L76" class="number unreach">76</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L77" class="number ">77</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L78" class="number ">78</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L79" class="number ">79</th>

                    <td class="" >
                        <pre>    * @since version 0.1.0
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L80" class="number ">80</th>

                    <td class="" >
                        <pre>    * @see commonDBTM::getRights()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L81" class="number ">81</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getRights">
                    <th id="L82" class="number ">82</th>

                    <td class="" id="getRights">
                        <pre>   public function getRights($interface = &#039;central&#039;) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L83" class="number covered">83</th>

                    <td class="covered" >
                        <pre>      $rights = parent::getRights();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L84" class="number ">84</th>

                    <td class="" >
                        <pre>      /// For additional righrs if needed
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L85" class="number ">85</th>

                    <td class="" >
                        <pre>      //$rights[self::RIGHTS] = self::getTypeName();
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L86" class="number ">86</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L87" class="number covered">87</th>

                    <td class="covered" >
                        <pre>      return $rights;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L88" class="number unreach">88</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L89" class="number ">89</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L90" class="number ">90</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L91" class="number ">91</th>

                    <td class="" >
                        <pre>    * Prepares input to follow the most used description convention
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L92" class="number ">92</th>

                    <td class="" >
                        <pre>    * @param array $input the data to use when creating a new row in the DB
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L93" class="number ">93</th>

                    <td class="" >
                        <pre>    * @return array|false the modified input data
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L94" class="number ">94</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="prepareInputForAdd">
                    <th id="L95" class="number ">95</th>

                    <td class="" id="prepareInputForAdd">
                        <pre>   public function prepareInputForAdd($input) {<span class="label label-warning">64%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L96" class="number ">96</th>

                    <td class="" >
                        <pre>      // integrity checks
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L97" class="number covered">97</th>

                    <td class="covered" >
                        <pre>      if (!isset($input[&#039;_useremails&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L98" class="number covered">98</th>

                    <td class="covered" >
                        <pre>         Session::addMessageAfterRedirect(__(&quot;Email address is invalid&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L99" class="number covered">99</th>

                    <td class="covered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L100" class="number ">100</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L101" class="number ">101</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L102" class="number covered">102</th>

                    <td class="covered" >
                        <pre>      $input[&#039;_useremails&#039;] = filter_var($input[&#039;_useremails&#039;], FILTER_VALIDATE_EMAIL);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L103" class="number covered">103</th>

                    <td class="covered" >
                        <pre>      if (!$input[&#039;_useremails&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L104" class="number covered">104</th>

                    <td class="covered" >
                        <pre>         Session::addMessageAfterRedirect(__(&quot;Email address is invalid&quot;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L105" class="number covered">105</th>

                    <td class="covered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L106" class="number ">106</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L107" class="number ">107</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L108" class="number ">108</th>

                    <td class="" >
                        <pre>      // Find guest profile&#039;s id
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L109" class="number covered">109</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&quot;flyvemdm&quot;, [&#039;guest_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L110" class="number covered">110</th>

                    <td class="covered" >
                        <pre>      $guestProfileId = $config[&#039;guest_profiles_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L111" class="number ">111</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L112" class="number covered">112</th>

                    <td class="covered" >
                        <pre>      $entityId = $input[&#039;entities_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L113" class="number ">113</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L114" class="number ">114</th>

                    <td class="" >
                        <pre>      // Find or create the user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L115" class="number covered">115</th>

                    <td class="covered" >
                        <pre>      $user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L116" class="number covered">116</th>

                    <td class="covered" >
                        <pre>      if (!$user-&gt;getFromDBbyName($input[&#039;_useremails&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L117" class="number ">117</th>

                    <td class="" >
                        <pre>         // The user does not exists yet, create him
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L118" class="number covered">118</th>

                    <td class="covered" >
                        <pre>         if (version_compare(PluginFlyvemdmCommon::getGlpiVersion(), &#039;9.3.0&#039;) &gt;= 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L119" class="number ">119</th>

                    <td class="" >
                        <pre>            // Workaround GLPI bug in commit a4bca634e4d055cdd6576000d8d0f2b89b0dcd91
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L120" class="number ">120</th>

                    <td class="" >
                        <pre>            // in GLPI 9.3.0 (waiting for a fix)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L121" class="number covered">121</th>

                    <td class="covered" >
                        <pre>            $userId = $user-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L122" class="number covered">122</th>

                    <td class="covered" >
                        <pre>               &#039;_useremails&#039;   =&gt; [$input[&#039;_useremails&#039;]],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L123" class="number covered">123</th>

                    <td class="covered" >
                        <pre>               &#039;name&#039;          =&gt; $input[&#039;_useremails&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L124" class="number uncovered">124</th>

                    <td class="uncovered" >
                        <pre>               &#039;authtype&#039;      =&gt; Auth::DB_GLPI,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L125" class="number ">125</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L126" class="number covered">126</th>

                    <td class="covered" >
                        <pre>            $profile_User = new Profile_User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L127" class="number covered">127</th>

                    <td class="covered" >
                        <pre>            $profile_User-&gt;deleteByCriteria([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L128" class="number covered">128</th>

                    <td class="covered" >
                        <pre>               &#039;users_id&#039;     =&gt; $user-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L129" class="number ">129</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L130" class="number covered">130</th>

                    <td class="covered" >
                        <pre>            $profile_User-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L131" class="number covered">131</th>

                    <td class="covered" >
                        <pre>               &#039;users_id&#039;     =&gt; $user-&gt;getID(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L132" class="number covered">132</th>

                    <td class="covered" >
                        <pre>               &#039;profiles_id&#039;  =&gt; $guestProfileId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L133" class="number covered">133</th>

                    <td class="covered" >
                        <pre>               &#039;entities_id&#039;  =&gt; $entityId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L134" class="number covered">134</th>

                    <td class="covered" >
                        <pre>               &#039;is_recursive&#039; =&gt; 0,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L135" class="number ">135</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L136" class="number ">136</th>

                    <td class="" >
                        <pre>         } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L137" class="number uncovered">137</th>

                    <td class="uncovered" >
                        <pre>            $userId = $user-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L138" class="number uncovered">138</th>

                    <td class="uncovered" >
                        <pre>               &#039;_useremails&#039;   =&gt; [$input[&#039;_useremails&#039;]],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L139" class="number uncovered">139</th>

                    <td class="uncovered" >
                        <pre>               &#039;name&#039;          =&gt; $input[&#039;_useremails&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L140" class="number uncovered">140</th>

                    <td class="uncovered" >
                        <pre>               &#039;_profiles_id&#039;  =&gt; $guestProfileId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L141" class="number uncovered">141</th>

                    <td class="uncovered" >
                        <pre>               &#039;_entities_id&#039;  =&gt; $entityId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L142" class="number uncovered">142</th>

                    <td class="uncovered" >
                        <pre>               &#039;_is_recursive&#039; =&gt; 0,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L143" class="number uncovered">143</th>

                    <td class="uncovered" >
                        <pre>               &#039;authtype&#039;      =&gt; Auth::DB_GLPI,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L144" class="number ">144</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L145" class="number ">145</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L146" class="number covered">146</th>

                    <td class="covered" >
                        <pre>         if ($user-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L147" class="number uncovered">147</th>

                    <td class="uncovered" >
                        <pre>            Session::addMessageAfterRedirect(__(&quot;Cannot create the user&quot;, &#039;flyvemdm&#039;), false, INFO,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L148" class="number uncovered">148</th>

                    <td class="uncovered" >
                        <pre>               true);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L149" class="number covered">149</th>

                    <td class="covered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L150" class="number ">150</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L151" class="number ">151</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L152" class="number ">152</th>

                    <td class="" >
                        <pre>      } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L153" class="number ">153</th>

                    <td class="" >
                        <pre>         // Do not handle deleted users
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L154" class="number covered">154</th>

                    <td class="covered" >
                        <pre>         if ($user-&gt;isDeleted()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L155" class="number covered">155</th>

                    <td class="covered" >
                        <pre>            Session::addMessageAfterRedirect(__(&quot;The user already exists and has been deleted. You must restore or purge him first.&quot;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L156" class="number covered">156</th>

                    <td class="covered" >
                        <pre>               &#039;flyvemdm&#039;), false, INFO, true);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L157" class="number covered">157</th>

                    <td class="covered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L158" class="number ">158</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L159" class="number ">159</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L160" class="number ">160</th>

                    <td class="" >
                        <pre>         // The user already exists, add him in the entity
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L161" class="number uncovered">161</th>

                    <td class="uncovered" >
                        <pre>         $userId = $user-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L162" class="number uncovered">162</th>

                    <td class="uncovered" >
                        <pre>         $profile_User = new Profile_User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L163" class="number uncovered">163</th>

                    <td class="uncovered" >
                        <pre>         $entities = $profile_User-&gt;getEntitiesForProfileByUser($userId, $guestProfileId);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L164" class="number uncovered">164</th>

                    <td class="uncovered" >
                        <pre>         if (!isset($entities[$_SESSION[&#039;glpiactive_entity&#039;]])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L165" class="number uncovered">165</th>

                    <td class="uncovered" >
                        <pre>            $profile_User-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L166" class="number uncovered">166</th>

                    <td class="uncovered" >
                        <pre>               &#039;users_id&#039;     =&gt; $userId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L167" class="number uncovered">167</th>

                    <td class="uncovered" >
                        <pre>               &#039;profiles_id&#039;  =&gt; $guestProfileId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L168" class="number uncovered">168</th>

                    <td class="uncovered" >
                        <pre>               &#039;entities_id&#039;  =&gt; $entityId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L169" class="number uncovered">169</th>

                    <td class="uncovered" >
                        <pre>               &#039;is_recursive&#039; =&gt; 0,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L170" class="number ">170</th>

                    <td class="" >
                        <pre>            ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L171" class="number ">171</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L172" class="number ">172</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L173" class="number covered">173</th>

                    <td class="covered" >
                        <pre>      $input[&#039;users_id&#039;] = $userId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L174" class="number ">174</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L175" class="number ">175</th>

                    <td class="" >
                        <pre>      // Ensure the user has a token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L176" class="number covered">176</th>

                    <td class="covered" >
                        <pre>      $personalToken = User::getToken($user-&gt;getID(), &#039;api_token&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L177" class="number covered">177</th>

                    <td class="covered" >
                        <pre>      if ($personalToken === false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L178" class="number uncovered">178</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L179" class="number ">179</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L180" class="number ">180</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L181" class="number ">181</th>

                    <td class="" >
                        <pre>      // Generate a invitation token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L182" class="number covered">182</th>

                    <td class="covered" >
                        <pre>      $input[&#039;invitation_token&#039;] = $this-&gt;setInvitationToken();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L183" class="number ">183</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L184" class="number ">184</th>

                    <td class="" >
                        <pre>      // Get the default expiration delay
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L185" class="number covered">185</th>

                    <td class="covered" >
                        <pre>      $entityConfig = new PluginFlyvemdmEntityConfig();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L186" class="number covered">186</th>

                    <td class="covered" >
                        <pre>      $tokenExpire = self::DEFAULT_TOKEN_LIFETIME;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L187" class="number covered">187</th>

                    <td class="covered" >
                        <pre>      if ($entityConfig-&gt;getFromDB($_SESSION[&#039;glpiactive_entity&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L188" class="number covered">188</th>

                    <td class="covered" >
                        <pre>         $tokenExpire = $entityConfig-&gt;getField(&#039;agent_token_life&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L189" class="number ">189</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L190" class="number ">190</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L191" class="number ">191</th>

                    <td class="" >
                        <pre>      // Compute the expiration date of the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L192" class="number covered">192</th>

                    <td class="covered" >
                        <pre>      $expirationDate = new DateTime(&quot;now&quot;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L193" class="number ">193</th>

                    <td class="" >
                        <pre>      try {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L194" class="number covered">194</th>

                    <td class="covered" >
                        <pre>         $expirationDate-&gt;add(new DateInterval($tokenExpire));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L195" class="number uncovered">195</th>

                    <td class="uncovered" >
                        <pre>      } catch (Exception $e) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L196" class="number uncovered">196</th>

                    <td class="uncovered" >
                        <pre>         Session::addMessageAfterRedirect(__(&quot;Invalid token expiration date interval&quot;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L197" class="number uncovered">197</th>

                    <td class="uncovered" >
                        <pre>            &#039;flyvemdm&#039;), false, ERROR, true);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L198" class="number uncovered">198</th>

                    <td class="uncovered" >
                        <pre>         return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L199" class="number ">199</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L200" class="number covered">200</th>

                    <td class="covered" >
                        <pre>      $input[&#039;expiration_date&#039;] = $expirationDate-&gt;format(&#039;Y-m-d H:i:s&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L201" class="number ">201</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L202" class="number ">202</th>

                    <td class="" >
                        <pre>      // Set a name for the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L203" class="number covered">203</th>

                    <td class="covered" >
                        <pre>      $input[&#039;name&#039;] = self::getTypeName(1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L204" class="number covered">204</th>

                    <td class="covered" >
                        <pre>      return $input;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L205" class="number unreach">205</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L206" class="number ">206</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L207" class="number ">207</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L208" class="number ">208</th>

                    <td class="" >
                        <pre>    * @see CommonDBTM::prepareInputForUpdate()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L209" class="number ">209</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="prepareInputForUpdate">
                    <th id="L210" class="number ">210</th>

                    <td class="" id="prepareInputForUpdate">
                        <pre>   public function prepareInputForUpdate($input) {<span class="label label-warning">45%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L211" class="number ">211</th>

                    <td class="" >
                        <pre>      // Registered users need right to send again an invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L212" class="number ">212</th>

                    <td class="" >
                        <pre>      // but shall not be able to edit anything
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L213" class="number covered">213</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;registered_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L214" class="number covered">214</th>

                    <td class="covered" >
                        <pre>      $registeredProfileId = $config[&#039;registered_profiles_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L215" class="number covered">215</th>

                    <td class="covered" >
                        <pre>      if ($_SESSION[&#039;glpiactiveprofile&#039;][&#039;id&#039;] == $registeredProfileId) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L216" class="number uncovered">216</th>

                    <td class="uncovered" >
                        <pre>         $forbidden = array_diff_key(</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L217" class="number uncovered">217</th>

                    <td class="uncovered" >
                        <pre>            $input,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L218" class="number ">218</th>

                    <td class="" >
                        <pre>            [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L219" class="number uncovered">219</th>

                    <td class="uncovered" >
                        <pre>               &#039;id&#039;          =&gt; &#039;&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L220" class="number ">220</th>

                    <td class="" >
                        <pre>               &#039;_notify&#039;     =&gt; &#039;&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L221" class="number ">221</th>

                    <td class="" >
                        <pre>               &#039;_no_history&#039; =&gt; &#039;&#039;,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L222" class="number ">222</th>

                    <td class="" >
                        <pre>            ]
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L223" class="number ">223</th>

                    <td class="" >
                        <pre>         );
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L224" class="number uncovered">224</th>

                    <td class="uncovered" >
                        <pre>         if (count($forbidden)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L225" class="number ">225</th>

                    <td class="" >
                        <pre>            // An attempt to edit the item by a registered use
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L226" class="number uncovered">226</th>

                    <td class="uncovered" >
                        <pre>            return false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L227" class="number ">227</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L228" class="number ">228</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L229" class="number ">229</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L230" class="number covered">230</th>

                    <td class="covered" >
                        <pre>      if (isset($input[&#039;_notify&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L231" class="number uncovered">231</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;sendInvitation();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L232" class="number ">232</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L233" class="number ">233</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L234" class="number covered">234</th>

                    <td class="covered" >
                        <pre>      return $input;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L235" class="number unreach">235</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L236" class="number ">236</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L237" class="number ">237</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L238" class="number ">238</th>

                    <td class="" >
                        <pre>    * Finds the invitation that matches the token given in argument
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L239" class="number ">239</th>

                    <td class="" >
                        <pre>    * @param string $token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L240" class="number ">240</th>

                    <td class="" >
                        <pre>    * @return boolean true if the invitation token exist
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L241" class="number ">241</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getFromDBByToken">
                    <th id="L242" class="number ">242</th>

                    <td class="" id="getFromDBByToken">
                        <pre>   public function getFromDBByToken($token) {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L243" class="number covered">243</th>

                    <td class="covered" >
                        <pre>      return $this-&gt;getFromDBByCrit([&#039;invitation_token&#039; =&gt; $token]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L244" class="number unreach">244</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L245" class="number ">245</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L246" class="number ">246</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L247" class="number ">247</th>

                    <td class="" >
                        <pre>    * Generates the Invitation Token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L248" class="number ">248</th>

                    <td class="" >
                        <pre>    * @return string the generated token
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L249" class="number ">249</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="setInvitationToken">
                    <th id="L250" class="number ">250</th>

                    <td class="" id="setInvitationToken">
                        <pre>   protected function setInvitationToken() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L251" class="number covered">251</th>

                    <td class="covered" >
                        <pre>      $invitation = new static();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L252" class="number ">252</th>

                    <td class="" >
                        <pre>      do {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L253" class="number covered">253</th>

                    <td class="covered" >
                        <pre>         $token = bin2hex(openssl_random_pseudo_bytes(32));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L254" class="number covered">254</th>

                    <td class="covered" >
                        <pre>      } while ($invitation-&gt;getFromDBByToken($token));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L255" class="number covered">255</th>

                    <td class="covered" >
                        <pre>      return $token;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L256" class="number unreach">256</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L257" class="number ">257</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="pre_deleteItem">
                    <th id="L258" class="number ">258</th>

                    <td class="" id="pre_deleteItem">
                        <pre>   public function pre_deleteItem() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L259" class="number uncovered">259</th>

                    <td class="uncovered" >
                        <pre>      $invitationLog = new PluginFlyvemdmInvitationlog();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L260" class="number uncovered">260</th>

                    <td class="uncovered" >
                        <pre>      return $invitationLog-&gt;deleteByCriteria([&#039;plugin_flyvemdm_invitations_id&#039; =&gt; $this-&gt;getID()]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L261" class="number unreach">261</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L262" class="number ">262</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_addItem">
                    <th id="L263" class="number ">263</th>

                    <td class="" id="post_addItem">
                        <pre>   public function post_addItem() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L264" class="number ">264</th>

                    <td class="" >
                        <pre>      // Create / update import to entity rule
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L265" class="number covered">265</th>

                    <td class="covered" >
                        <pre>      $fi = new PluginFlyvemdmFusionInventory();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L266" class="number covered">266</th>

                    <td class="covered" >
                        <pre>      $fi-&gt;addInvitationRule($this);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L267" class="number ">267</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L268" class="number ">268</th>

                    <td class="" >
                        <pre>      // Generate QR code
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L269" class="number covered">269</th>

                    <td class="covered" >
                        <pre>      $this-&gt;createQRCodeDocument();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L270" class="number ">270</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L271" class="number ">271</th>

                    <td class="" >
                        <pre>      // Sent invitation email
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L272" class="number covered">272</th>

                    <td class="covered" >
                        <pre>      $this-&gt;sendInvitation();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L273" class="number covered">273</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L274" class="number ">274</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="post_updateItem">
                    <th id="L275" class="number ">275</th>

                    <td class="" id="post_updateItem">
                        <pre>   public function post_updateItem($history = 1) {<span class="label label-success">70%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L276" class="number ">276</th>

                    <td class="" >
                        <pre>      // Update the dynamic import entity rules
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L277" class="number covered">277</th>

                    <td class="covered" >
                        <pre>      if (in_array(&#039;status&#039;, $this-&gt;updates)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L278" class="number covered">278</th>

                    <td class="covered" >
                        <pre>         $fi = new PluginFlyvemdmFusionInventory();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L279" class="number covered">279</th>

                    <td class="covered" >
                        <pre>         switch ($this-&gt;fields[&#039;status&#039;]) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L280" class="number covered">280</th>

                    <td class="covered" >
                        <pre>            case  &#039;done&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L281" class="number covered">281</th>

                    <td class="covered" >
                        <pre>               $fi-&gt;deleteInvitationRuleCriteria($this);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L282" class="number covered">282</th>

                    <td class="covered" >
                        <pre>               break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L283" class="number uncovered">283</th>

                    <td class="uncovered" >
                        <pre>            case &#039;pending&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L284" class="number uncovered">284</th>

                    <td class="uncovered" >
                        <pre>               $fi-&gt;addInvitationRule($this);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L285" class="number uncovered">285</th>

                    <td class="uncovered" >
                        <pre>               break;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L286" class="number ">286</th>

                    <td class="" >
                        <pre>         }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L287" class="number ">287</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L288" class="number covered">288</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L289" class="number ">289</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L290" class="number ">290</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L291" class="number ">291</th>

                    <td class="" >
                        <pre>    * @see CommonDBTM::pre_deleteItem()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L292" class="number ">292</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L293" class="number ">293</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L294" class="number ">294</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="hook_pre_invitation_purge">
                    <th id="L295" class="number ">295</th>

                    <td class="" id="hook_pre_invitation_purge">
                        <pre>   public function hook_pre_invitation_purge(CommonDBTM $item) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L296" class="number uncovered">296</th>

                    <td class="uncovered" >
                        <pre>      $fi = new PluginFlyvemdmFusionInventory();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L297" class="number uncovered">297</th>

                    <td class="uncovered" >
                        <pre>      $fi-&gt;deleteInvitationRuleCriteria($item);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L298" class="number uncovered">298</th>

                    <td class="uncovered" >
                        <pre>      $document = new Document();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L299" class="number uncovered">299</th>

                    <td class="uncovered" >
                        <pre>      return $document-&gt;delete([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L300" class="number uncovered">300</th>

                    <td class="uncovered" >
                        <pre>         &#039;id&#039; =&gt; $item-&gt;getField(&#039;documents_id&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L301" class="number uncovered">301</th>

                    <td class="uncovered" >
                        <pre>      ], 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L302" class="number unreach">302</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L303" class="number ">303</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L304" class="number ">304</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L305" class="number ">305</th>

                    <td class="" >
                        <pre>    * Actions done when a document is being purged
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L306" class="number ">306</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item Document
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L307" class="number ">307</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="hook_pre_document_purge">
                    <th id="L308" class="number ">308</th>

                    <td class="" id="hook_pre_document_purge">
                        <pre>   public static function hook_pre_document_purge(CommonDBTM $item) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L309" class="number uncovered">309</th>

                    <td class="uncovered" >
                        <pre>      $invitation = new self();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L310" class="number uncovered">310</th>

                    <td class="uncovered" >
                        <pre>      $documentId = $item-&gt;getID();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L311" class="number uncovered">311</th>

                    <td class="uncovered" >
                        <pre>      $rows = $invitation-&gt;find(&quot;`documents_id`=&#039;$documentId&#039;&quot;, &#039;&#039;, &#039;1&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L312" class="number uncovered">312</th>

                    <td class="uncovered" >
                        <pre>      if (count($rows) &gt; 0) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L313" class="number uncovered">313</th>

                    <td class="uncovered" >
                        <pre>         Session::addMessageAfterRedirect(__(&#039;Cannot delete the document. Delete the attached invitation first&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L314" class="number uncovered">314</th>

                    <td class="uncovered" >
                        <pre>            &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L315" class="number uncovered">315</th>

                    <td class="uncovered" >
                        <pre>         $item-&gt;input = false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L316" class="number ">316</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L317" class="number uncovered">317</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L318" class="number ">318</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L319" class="number ">319</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L320" class="number ">320</th>

                    <td class="" >
                        <pre>    * Returns the invited user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L321" class="number ">321</th>

                    <td class="" >
                        <pre>    * @return User
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L322" class="number ">322</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getUser">
                    <th id="L323" class="number ">323</th>

                    <td class="" id="getUser">
                        <pre>   public function getUser() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L324" class="number uncovered">324</th>

                    <td class="uncovered" >
                        <pre>      if ($this-&gt;isNewItem()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L325" class="number uncovered">325</th>

                    <td class="uncovered" >
                        <pre>         return null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L326" class="number ">326</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L327" class="number uncovered">327</th>

                    <td class="uncovered" >
                        <pre>      $this-&gt;user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L328" class="number uncovered">328</th>

                    <td class="uncovered" >
                        <pre>      if (!$this-&gt;user-&gt;getFromDB($this-&gt;fields[&#039;users_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L329" class="number uncovered">329</th>

                    <td class="uncovered" >
                        <pre>         $this-&gt;user = null;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L330" class="number ">330</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L331" class="number uncovered">331</th>

                    <td class="uncovered" >
                        <pre>      return $this-&gt;user;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L332" class="number unreach">332</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L333" class="number ">333</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L334" class="number ">334</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L335" class="number ">335</th>

                    <td class="" >
                        <pre>    * get the enrollment URL of the agent
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L336" class="number ">336</th>

                    <td class="" >
                        <pre>    * @return string URL to enroll a mobile Device
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L337" class="number ">337</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="createQRCodeDocument">
                    <th id="L338" class="number ">338</th>

                    <td class="" id="createQRCodeDocument">
                        <pre>   protected function createQRCodeDocument() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L339" class="number ">339</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L340" class="number covered">340</th>

                    <td class="covered" >
                        <pre>      $user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L341" class="number covered">341</th>

                    <td class="covered" >
                        <pre>      $user-&gt;getFromDB($this-&gt;fields[&#039;users_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L342" class="number covered">342</th>

                    <td class="covered" >
                        <pre>      $entityId = $this-&gt;fields[&#039;entities_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L343" class="number covered">343</th>

                    <td class="covered" >
                        <pre>      $encodedRequest = $this-&gt;getEnrollmentUrl();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L344" class="number ">344</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L345" class="number ">345</th>

                    <td class="" >
                        <pre>      // Generate a QRCode
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L346" class="number covered">346</th>

                    <td class="covered" >
                        <pre>      $barcodeobj = new TCPDF2DBarcode($encodedRequest, &#039;QRCODE,L&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L347" class="number covered">347</th>

                    <td class="covered" >
                        <pre>      $qrCode = $barcodeobj-&gt;getBarcodePngData(7, 7, [0, 0, 0]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L348" class="number ">348</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L349" class="number ">349</th>

                    <td class="" >
                        <pre>      // Add border to the QR
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L350" class="number ">350</th>

                    <td class="" >
                        <pre>      // TCPDF forgets the quiet zone
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L351" class="number covered">351</th>

                    <td class="covered" >
                        <pre>      $borderSize = 30;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L352" class="number covered">352</th>

                    <td class="covered" >
                        <pre>      $image = imagecreatefromstring($qrCode);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L353" class="number covered">353</th>

                    <td class="covered" >
                        <pre>      $width = imagesx($image);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L354" class="number covered">354</th>

                    <td class="covered" >
                        <pre>      $height = imagesy($image);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L355" class="number ">355</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L356" class="number ">356</th>

                    <td class="" >
                        <pre>      // Build new bigger image
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L357" class="number covered">357</th>

                    <td class="covered" >
                        <pre>      $compliantQRcode = imagecreatetruecolor($width + 2 * $borderSize, $height + 2 * $borderSize);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L358" class="number covered">358</th>

                    <td class="covered" >
                        <pre>      $white = imagecolorallocate($compliantQRcode, 255, 255, 255);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L359" class="number ">359</th>

                    <td class="" >
                        <pre>      // Fill it with white
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L360" class="number covered">360</th>

                    <td class="covered" >
                        <pre>      imagefilledrectangle($compliantQRcode, 0, 0, $width + 2 * $borderSize,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L361" class="number covered">361</th>

                    <td class="covered" >
                        <pre>         $height + 2 * $borderSize, $white);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L362" class="number ">362</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L363" class="number ">363</th>

                    <td class="" >
                        <pre>      // Copy and center the qr code in the big image
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L364" class="number covered">364</th>

                    <td class="covered" >
                        <pre>      imagecopy($compliantQRcode, $image, $borderSize, $borderSize, 0, 0, $width, $height);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L365" class="number ">365</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L366" class="number ">366</th>

                    <td class="" >
                        <pre>      // Save the image in a temporary file
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L367" class="number covered">367</th>

                    <td class="covered" >
                        <pre>      $tmpFile = uniqid() . &quot;.png&quot;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L368" class="number covered">368</th>

                    <td class="covered" >
                        <pre>      imagepng($compliantQRcode, GLPI_TMP_DIR . &quot;/&quot; . $tmpFile, 9);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L369" class="number ">369</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L370" class="number ">370</th>

                    <td class="" >
                        <pre>      // Generate a document with the QR code
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L371" class="number covered">371</th>

                    <td class="covered" >
                        <pre>      $input = [];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L372" class="number covered">372</th>

                    <td class="covered" >
                        <pre>      $document = new Document();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L373" class="number covered">373</th>

                    <td class="covered" >
                        <pre>      $input[&#039;entities_id&#039;] = $entityId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L374" class="number covered">374</th>

                    <td class="covered" >
                        <pre>      $input[&#039;is_recursive&#039;] = &#039;0&#039;;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L375" class="number covered">375</th>

                    <td class="covered" >
                        <pre>      $input[&#039;name&#039;] = addslashes(__(&#039;Enrollment QR code&#039;, &#039;flyvemdm&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L376" class="number covered">376</th>

                    <td class="covered" >
                        <pre>      $input[&#039;_filename&#039;] = [$tmpFile];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L377" class="number covered">377</th>

                    <td class="covered" >
                        <pre>      $input[&#039;_only_if_upload_succeed&#039;] = true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L378" class="number covered">378</th>

                    <td class="covered" >
                        <pre>      $documentId = $document-&gt;add($input);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L379" class="number ">379</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L380" class="number covered">380</th>

                    <td class="covered" >
                        <pre>      $documentItem = new Document_Item();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L381" class="number covered">381</th>

                    <td class="covered" >
                        <pre>      $documentItem-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L382" class="number covered">382</th>

                    <td class="covered" >
                        <pre>         &#039;entities_id&#039;  =&gt; $entityId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L383" class="number covered">383</th>

                    <td class="covered" >
                        <pre>         &#039;is_recursive&#039; =&gt; 0,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L384" class="number ">384</th>

                    <td class="" >
                        <pre>         &#039;itemtype&#039;     =&gt; PluginFlyvemdmInvitation::class,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L385" class="number covered">385</th>

                    <td class="covered" >
                        <pre>         &#039;items_id&#039;     =&gt; $this-&gt;fields[&#039;id&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L386" class="number covered">386</th>

                    <td class="covered" >
                        <pre>         &#039;documents_id&#039; =&gt; $documentId,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L387" class="number ">387</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L388" class="number ">388</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L389" class="number covered">389</th>

                    <td class="covered" >
                        <pre>      return $documentId;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L390" class="number unreach">390</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L391" class="number ">391</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L392" class="number ">392</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L393" class="number ">393</th>

                    <td class="" >
                        <pre>    * Generates the enrollment URL for the invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L394" class="number ">394</th>

                    <td class="" >
                        <pre>    * @return string
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L395" class="number ">395</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getEnrollmentUrl">
                    <th id="L396" class="number ">396</th>

                    <td class="" id="getEnrollmentUrl">
                        <pre>   public function getEnrollmentUrl() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L397" class="number covered">397</th>

                    <td class="covered" >
                        <pre>      global $CFG_GLPI;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L398" class="number ">398</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L399" class="number ">399</th>

                    <td class="" >
                        <pre>      // Get the general config of Flyve MDM
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L400" class="number covered">400</th>

                    <td class="covered" >
                        <pre>      $config = Config::getConfigurationValues(&#039;flyvemdm&#039;, [&#039;invitation_deeplink&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L401" class="number ">401</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L402" class="number covered">402</th>

                    <td class="covered" >
                        <pre>      $user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L403" class="number covered">403</th>

                    <td class="covered" >
                        <pre>      $user-&gt;getFromDB($this-&gt;fields[&#039;users_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L404" class="number covered">404</th>

                    <td class="covered" >
                        <pre>      $invitationToken = $this-&gt;fields[&#039;invitation_token&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L405" class="number covered">405</th>

                    <td class="covered" >
                        <pre>      $entities_id = $this-&gt;fields[&#039;entities_id&#039;];</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L406" class="number ">406</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L407" class="number ">407</th>

                    <td class="" >
                        <pre>      // Get the entitiy configuration data
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L408" class="number covered">408</th>

                    <td class="covered" >
                        <pre>      $entityConfig = new PluginFlyvemdmEntityConfig();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L409" class="number covered">409</th>

                    <td class="covered" >
                        <pre>      $entityConfig-&gt;getFromDBByCrit([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L410" class="number covered">410</th>

                    <td class="covered" >
                        <pre>         &#039;entities_id&#039; =&gt; $entities_id</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L411" class="number ">411</th>

                    <td class="" >
                        <pre>      ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L412" class="number ">412</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L413" class="number ">413</th>

                    <td class="" >
                        <pre>      // Build the data of the deeplink
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L414" class="number covered">414</th>

                    <td class="covered" >
                        <pre>      $personalToken = User::getToken($user-&gt;getID(), &#039;api_token&#039;);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L415" class="number ">415</th>

                    <td class="" >
                        <pre>      $enrollmentData = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L416" class="number covered">416</th>

                    <td class="covered" >
                        <pre>         &#039;url&#039;                =&gt; rtrim($CFG_GLPI[&#039;url_base_api&#039;], &#039;/&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L417" class="number covered">417</th>

                    <td class="covered" >
                        <pre>         &#039;user_token&#039;         =&gt; $personalToken,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L418" class="number covered">418</th>

                    <td class="covered" >
                        <pre>         &#039;invitation_token&#039;   =&gt; $invitationToken,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L419" class="number covered">419</th>

                    <td class="covered" >
                        <pre>         &#039;support_name&#039;       =&gt; $entityConfig-&gt;getField(&#039;support_name&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L420" class="number covered">420</th>

                    <td class="covered" >
                        <pre>         &#039;support_phone&#039;      =&gt; $entityConfig-&gt;getField(&#039;support_phone&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L421" class="number covered">421</th>

                    <td class="covered" >
                        <pre>         &#039;support_website&#039;    =&gt; $entityConfig-&gt;getField(&#039;support_website&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L422" class="number covered">422</th>

                    <td class="covered" >
                        <pre>         &#039;support_email&#039;      =&gt; $entityConfig-&gt;getField(&#039;support_email&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L423" class="number ">423</th>

                    <td class="" >
                        <pre>         //&#039;support_address&#039;    =&gt; $entityConfig-&gt;getField(&#039;support_address&#039;),
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L424" class="number ">424</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L425" class="number ">425</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L426" class="number covered">426</th>

                    <td class="covered" >
                        <pre>      return $config[&#039;invitation_deeplink&#039;] . PluginFlyvemdmNotificationTargetInvitation::DEEPLINK</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L427" class="number covered">427</th>

                    <td class="covered" >
                        <pre>                        . base64_encode(addcslashes(implode(&#039;;&#039;, $enrollmentData), &#039;\;&#039;));</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L428" class="number unreach">428</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L429" class="number ">429</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L430" class="number ">430</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L431" class="number ">431</th>

                    <td class="" >
                        <pre>    * Sends an invitation
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L432" class="number ">432</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="sendInvitation">
                    <th id="L433" class="number ">433</th>

                    <td class="" id="sendInvitation">
                        <pre>   public function sendInvitation() {<span class="label label-success">100%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L434" class="number covered">434</th>

                    <td class="covered" >
                        <pre>      NotificationEvent::raiseEvent(</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L435" class="number covered">435</th>

                    <td class="covered" >
                        <pre>         PluginFlyvemdmNotificationTargetInvitation::EVENT_GUEST_INVITATION,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L436" class="number covered">436</th>

                    <td class="covered" >
                        <pre>         $this</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L437" class="number ">437</th>

                    <td class="" >
                        <pre>      );
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L438" class="number covered">438</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L439" class="number ">439</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L440" class="number ">440</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L441" class="number ">441</th>

                    <td class="" >
                        <pre>    * @see CommonDBTM::getSearchOptionsNew()
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L442" class="number ">442</th>

                    <td class="" >
                        <pre>    * @return array
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L443" class="number ">443</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="getSearchOptionsNew">
                    <th id="L444" class="number ">444</th>

                    <td class="" id="getSearchOptionsNew">
                        <pre>   public function getSearchOptionsNew() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L445" class="number uncovered">445</th>

                    <td class="uncovered" >
                        <pre>      return $this-&gt;rawSearchOptions();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L446" class="number unreach">446</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L447" class="number ">447</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="rawSearchOptions">
                    <th id="L448" class="number ">448</th>

                    <td class="" id="rawSearchOptions">
                        <pre>   public function rawSearchOptions() {<span class="label label-success">97%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L449" class="number covered">449</th>

                    <td class="covered" >
                        <pre>      if (method_exists(&#039;CommonDBTM&#039;, &#039;rawSearchOptions&#039;)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L450" class="number covered">450</th>

                    <td class="covered" >
                        <pre>         $tab = parent::rawSearchOptions();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L451" class="number ">451</th>

                    <td class="" >
                        <pre>      } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L452" class="number uncovered">452</th>

                    <td class="uncovered" >
                        <pre>         $tab = parent::getSearchOptionsNew();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L453" class="number ">453</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L454" class="number ">454</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L455" class="number covered">455</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L456" class="number covered">456</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;            =&gt; &#039;2&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L457" class="number covered">457</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;         =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L458" class="number covered">458</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;         =&gt; &#039;id&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L459" class="number covered">459</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;          =&gt; __(&#039;ID&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L460" class="number ">460</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039; =&gt; false,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L461" class="number covered">461</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;      =&gt; &#039;number&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L462" class="number ">462</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L463" class="number ">463</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L464" class="number covered">464</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L465" class="number covered">465</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;            =&gt; &#039;3&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L466" class="number covered">466</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;         =&gt; &#039;glpi_users&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L467" class="number covered">467</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;         =&gt; &#039;name&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L468" class="number covered">468</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;          =&gt; __(&#039;User&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L469" class="number ">469</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039; =&gt; false,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L470" class="number covered">470</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;      =&gt; &#039;string&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L471" class="number ">471</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L472" class="number ">472</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L473" class="number covered">473</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L474" class="number covered">474</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;            =&gt; &#039;4&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L475" class="number covered">475</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;         =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L476" class="number covered">476</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;         =&gt; &#039;status&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L477" class="number covered">477</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;          =&gt; __(&#039;Status&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L478" class="number ">478</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039; =&gt; false,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L479" class="number covered">479</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;      =&gt; &#039;string&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L480" class="number ">480</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L481" class="number ">481</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L482" class="number covered">482</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L483" class="number covered">483</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;            =&gt; &#039;5&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L484" class="number covered">484</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;         =&gt; $this-&gt;getTable(),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L485" class="number covered">485</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;         =&gt; &#039;expiration_date&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L486" class="number covered">486</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;          =&gt; __(&#039;Expiration date&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L487" class="number ">487</th>

                    <td class="" >
                        <pre>         &#039;massiveaction&#039; =&gt; false,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L488" class="number covered">488</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;      =&gt; &#039;string&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L489" class="number ">489</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L490" class="number ">490</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L491" class="number covered">491</th>

                    <td class="covered" >
                        <pre>      $tab[] = [</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L492" class="number covered">492</th>

                    <td class="covered" >
                        <pre>         &#039;id&#039;                 =&gt; &#039;6&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L493" class="number covered">493</th>

                    <td class="covered" >
                        <pre>         &#039;table&#039;              =&gt; &#039;glpi_entities&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L494" class="number covered">494</th>

                    <td class="covered" >
                        <pre>         &#039;field&#039;              =&gt; &#039;completename&#039;,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L495" class="number covered">495</th>

                    <td class="covered" >
                        <pre>         &#039;name&#039;               =&gt; __(&#039;Entity&#039;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L496" class="number covered">496</th>

                    <td class="covered" >
                        <pre>         &#039;datatype&#039;           =&gt; &#039;dropdown&#039;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L497" class="number ">497</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L498" class="number ">498</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L499" class="number covered">499</th>

                    <td class="covered" >
                        <pre>      return $tab;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L500" class="number unreach">500</th>

                    <td class="unreach" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L501" class="number ">501</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L502" class="number ">502</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L503" class="number ">503</th>

                    <td class="" >
                        <pre>    * Deletes the invitation related to the entity being purged
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L504" class="number ">504</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L505" class="number ">505</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="hook_entity_purge">
                    <th id="L506" class="number ">506</th>

                    <td class="" id="hook_entity_purge">
                        <pre>   public function hook_entity_purge(CommonDBTM $item) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L507" class="number uncovered">507</th>

                    <td class="uncovered" >
                        <pre>      $invitation = new static();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L508" class="number uncovered">508</th>

                    <td class="uncovered" >
                        <pre>      $invitation-&gt;deleteByCriteria([&#039;entities_id&#039; =&gt; $item-&gt;getField(&#039;id&#039;)], 1);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L509" class="number uncovered">509</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L510" class="number ">510</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L511" class="number ">511</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L512" class="number ">512</th>

                    <td class="" >
                        <pre>    * Show form for edition
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L513" class="number ">513</th>

                    <td class="" >
                        <pre>    * @param integer $ID
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L514" class="number ">514</th>

                    <td class="" >
                        <pre>    * @param array $options
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L515" class="number ">515</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="showForm">
                    <th id="L516" class="number ">516</th>

                    <td class="" id="showForm">
                        <pre>   public function showForm($ID, $options = []) {<span class="label label-success">94%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L517" class="number covered">517</th>

                    <td class="covered" >
                        <pre>      $this-&gt;initForm($ID, $options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L518" class="number covered">518</th>

                    <td class="covered" >
                        <pre>      $this-&gt;showFormHeader();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L519" class="number covered">519</th>

                    <td class="covered" >
                        <pre>      $canUpdate = (!$this-&gt;isNewID($ID)) &amp;&amp; ($this-&gt;canView() &gt; 0) || $this-&gt;isNewID($ID);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L520" class="number ">520</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L521" class="number covered">521</th>

                    <td class="covered" >
                        <pre>      $fields = $this-&gt;fields;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L522" class="number covered">522</th>

                    <td class="covered" >
                        <pre>      $user = new User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L523" class="number covered">523</th>

                    <td class="covered" >
                        <pre>      $user-&gt;getFromDB($fields[&#039;users_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L524" class="number covered">524</th>

                    <td class="covered" >
                        <pre>      $fields[&#039;_useremails&#039;] = $user-&gt;getDefaultEmail();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L525" class="number ">525</th>

                    <td class="" >
                        <pre>      $data = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L526" class="number covered">526</th>

                    <td class="covered" >
                        <pre>         &#039;withTemplate&#039; =&gt; (isset($options[&#039;withtemplate&#039;]) &amp;&amp; $options[&#039;withtemplate&#039;] ? &quot;*&quot; : &quot;&quot;),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L527" class="number covered">527</th>

                    <td class="covered" >
                        <pre>         &#039;canUpdate&#039;    =&gt; $canUpdate,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L528" class="number covered">528</th>

                    <td class="covered" >
                        <pre>         &#039;isNewID&#039;      =&gt; $this-&gt;isNewID($ID),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L529" class="number covered">529</th>

                    <td class="covered" >
                        <pre>         &#039;invitation&#039;   =&gt; $fields,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L530" class="number covered">530</th>

                    <td class="covered" >
                        <pre>         &#039;resendButton&#039; =&gt; Html::submit(_x(&#039;button&#039;, &#039;Re-send&#039;), [&#039;name&#039; =&gt; &#039;resend&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L531" class="number ">531</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L532" class="number ">532</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L533" class="number covered">533</th>

                    <td class="covered" >
                        <pre>      $twig = plugin_flyvemdm_getTemplateEngine();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L534" class="number covered">534</th>

                    <td class="covered" >
                        <pre>      echo $twig-&gt;render(&#039;invitation.html.twig&#039;, $data);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L535" class="number ">535</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L536" class="number covered">536</th>

                    <td class="covered" >
                        <pre>      if (!$this-&gt;isNewID($ID)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L537" class="number uncovered">537</th>

                    <td class="uncovered" >
                        <pre>         $options[&#039;canedit&#039;] = true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L538" class="number ">538</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L539" class="number covered">539</th>

                    <td class="covered" >
                        <pre>      $this-&gt;showFormButtons($options);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L540" class="number covered">540</th>

                    <td class="covered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L541" class="number ">541</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L542" class="number ">542</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L543" class="number ">543</th>

                    <td class="" >
                        <pre>    * Displays the massive actions related to the invitation of the user
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L544" class="number ">544</th>

                    <td class="" >
                        <pre>    * @return string a HTML with the masssive actions
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L545" class="number ">545</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="showMassiveActionInviteUser">
                    <th id="L546" class="number ">546</th>

                    <td class="" id="showMassiveActionInviteUser">
                        <pre>   protected function showMassiveActionInviteUser() {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L547" class="number uncovered">547</th>

                    <td class="uncovered" >
                        <pre>      $twig = plugin_flyvemdm_getTemplateEngine();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L548" class="number ">548</th>

                    <td class="" >
                        <pre>      $data = [
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L549" class="number uncovered">549</th>

                    <td class="uncovered" >
                        <pre>         &#039;inviteButton&#039; =&gt; Html::submit(_x(&#039;button&#039;, &#039;Post&#039;), [&#039;name&#039; =&gt; &#039;massiveaction&#039;]),</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L550" class="number ">550</th>

                    <td class="" >
                        <pre>      ];
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L551" class="number uncovered">551</th>

                    <td class="uncovered" >
                        <pre>      echo $twig-&gt;render(&#039;mass_invitation.html.twig&#039;, $data);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L552" class="number uncovered">552</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L553" class="number ">553</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L554" class="number ">554</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L555" class="number ">555</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L556" class="number ">556</th>

                    <td class="" >
                        <pre>    * @param MassiveAction $ma
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L557" class="number ">557</th>

                    <td class="" >
                        <pre>    * @return bool
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L558" class="number ">558</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="showMassiveActionsSubForm">
                    <th id="L559" class="number ">559</th>

                    <td class="" id="showMassiveActionsSubForm">
                        <pre>   static function showMassiveActionsSubForm(MassiveAction $ma) {<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L560" class="number uncovered">560</th>

                    <td class="uncovered" >
                        <pre>      switch ($ma-&gt;getAction()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L561" class="number uncovered">561</th>

                    <td class="uncovered" >
                        <pre>         case &#039;InviteUser&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L562" class="number uncovered">562</th>

                    <td class="uncovered" >
                        <pre>            $invitation = new static();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L563" class="number uncovered">563</th>

                    <td class="uncovered" >
                        <pre>            $invitation-&gt;showMassiveActionInviteUser();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L564" class="number uncovered">564</th>

                    <td class="uncovered" >
                        <pre>            return true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L565" class="number ">565</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L566" class="number ">566</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L567" class="number uncovered">567</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L568" class="number ">568</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L569" class="number ">569</th>

                    <td class="" >
                        <pre>   /**
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L570" class="number ">570</th>

                    <td class="" >
                        <pre>    * Executes the code to process the massive actions
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L571" class="number ">571</th>

                    <td class="" >
                        <pre>    *
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L572" class="number ">572</th>

                    <td class="" >
                        <pre>    * @param MassiveAction $ma
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L573" class="number ">573</th>

                    <td class="" >
                        <pre>    * @param CommonDBTM $item
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L574" class="number ">574</th>

                    <td class="" >
                        <pre>    * @param array $ids
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L575" class="number ">575</th>

                    <td class="" >
                        <pre>    */
</pre>
                    </td>
                </tr>
                            <tr class="line" id="processMassiveActionsForOneItemtype">
                    <th id="L576" class="number ">576</th>

                    <td class="" id="processMassiveActionsForOneItemtype">
                        <pre>   public static function processMassiveActionsForOneItemtype(<span class="label label-danger">0%</span><div class="btn-group"></div></pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L577" class="number ">577</th>

                    <td class="" >
                        <pre>      MassiveAction $ma,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L578" class="number ">578</th>

                    <td class="" >
                        <pre>      CommonDBTM $item,
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L579" class="number ">579</th>

                    <td class="" >
                        <pre>      array $ids
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L580" class="number ">580</th>

                    <td class="" >
                        <pre>   ) {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L581" class="number uncovered">581</th>

                    <td class="uncovered" >
                        <pre>      switch ($ma-&gt;getAction()) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L582" class="number uncovered">582</th>

                    <td class="uncovered" >
                        <pre>         case &#039;InviteUser&#039;:</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L583" class="number uncovered">583</th>

                    <td class="uncovered" >
                        <pre>            if ($item-&gt;getType() == User::class) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L584" class="number ">584</th>

                    <td class="" >
                        <pre>               // find the profile ID of the service account (demo plugin)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L585" class="number uncovered">585</th>

                    <td class="uncovered" >
                        <pre>               $config = Config::getConfigurationValues(&#039;flyvemdmdemo&#039;, [&#039;service_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L586" class="number uncovered">586</th>

                    <td class="uncovered" >
                        <pre>               if (isset($config[&#039;service_profiles_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L587" class="number uncovered">587</th>

                    <td class="uncovered" >
                        <pre>                  $profile = new Profile();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L588" class="number uncovered">588</th>

                    <td class="uncovered" >
                        <pre>                  $profile-&gt;getFromDB($config[&#039;service_profiles_id&#039;]);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L589" class="number uncovered">589</th>

                    <td class="uncovered" >
                        <pre>                  $profile_user = new Profile_User();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L590" class="number ">590</th>

                    <td class="" >
                        <pre>               }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L591" class="number uncovered">591</th>

                    <td class="uncovered" >
                        <pre>               foreach ($ids as $id) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L592" class="number uncovered">592</th>

                    <td class="uncovered" >
                        <pre>                  $item-&gt;getFromDB($id);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L593" class="number uncovered">593</th>

                    <td class="uncovered" >
                        <pre>                  $reject = false;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L594" class="number ">594</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L595" class="number ">595</th>

                    <td class="" >
                        <pre>                  // Do not invite service account users (demo mode)
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L596" class="number uncovered">596</th>

                    <td class="uncovered" >
                        <pre>                  if (isset($config[&#039;service_profiles_id&#039;])) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L597" class="number uncovered">597</th>

                    <td class="uncovered" >
                        <pre>                     if ($profile_user-&gt;getFromDBForItems($item, $profile) !== false) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L598" class="number uncovered">598</th>

                    <td class="uncovered" >
                        <pre>                        $reject = true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L599" class="number ">599</th>

                    <td class="" >
                        <pre>                     }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L600" class="number ">600</th>

                    <td class="" >
                        <pre>                  }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L601" class="number ">601</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L602" class="number ">602</th>

                    <td class="" >
                        <pre>                  // Do not invite users without a default email address
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L603" class="number uncovered">603</th>

                    <td class="uncovered" >
                        <pre>                  $useremail = new UserEmail();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L604" class="number uncovered">604</th>

                    <td class="uncovered" >
                        <pre>                  $emailAddress = $useremail-&gt;getDefaultForUser($id);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L605" class="number uncovered">605</th>

                    <td class="uncovered" >
                        <pre>                  if (empty($emailAddress)) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L606" class="number uncovered">606</th>

                    <td class="uncovered" >
                        <pre>                     $reject = true;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L607" class="number ">607</th>

                    <td class="" >
                        <pre>                  }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L608" class="number ">608</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L609" class="number uncovered">609</th>

                    <td class="uncovered" >
                        <pre>                  $result = MassiveAction::ACTION_OK;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L610" class="number uncovered">610</th>

                    <td class="uncovered" >
                        <pre>                  if ($reject) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L611" class="number uncovered">611</th>

                    <td class="uncovered" >
                        <pre>                     $result = MassiveAction::ACTION_KO;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L612" class="number ">612</th>

                    <td class="" >
                        <pre>                  } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L613" class="number uncovered">613</th>

                    <td class="uncovered" >
                        <pre>                     $invitation = new PluginFlyvemdmInvitation();</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L614" class="number uncovered">614</th>

                    <td class="uncovered" >
                        <pre>                     $success = $invitation-&gt;add([</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L615" class="number uncovered">615</th>

                    <td class="uncovered" >
                        <pre>                        &#039;_useremails&#039; =&gt; $emailAddress,</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L616" class="number uncovered">616</th>

                    <td class="uncovered" >
                        <pre>                        &#039;entities_id&#039; =&gt; $_SESSION[&#039;glpiactive_entity&#039;],</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L617" class="number ">617</th>

                    <td class="" >
                        <pre>                     ]);
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L618" class="number uncovered">618</th>

                    <td class="uncovered" >
                        <pre>                     if (!$success) {</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L619" class="number uncovered">619</th>

                    <td class="uncovered" >
                        <pre>                        $result = MassiveAction::ACTION_KO;</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L620" class="number ">620</th>

                    <td class="" >
                        <pre>                     }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L621" class="number ">621</th>

                    <td class="" >
                        <pre>                  }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L622" class="number uncovered">622</th>

                    <td class="uncovered" >
                        <pre>                  $ma-&gt;itemDone($item-&gt;getType(), $id, $result);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L623" class="number ">623</th>

                    <td class="" >
                        <pre>               }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L624" class="number ">624</th>

                    <td class="" >
                        <pre>            } else {
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L625" class="number uncovered">625</th>

                    <td class="uncovered" >
                        <pre>               $ma-&gt;itemDone($item-&gt;getType(), $ids, MassiveAction::ACTION_KO);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L626" class="number ">626</th>

                    <td class="" >
                        <pre>            }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L627" class="number ">627</th>

                    <td class="" >
                        <pre>      }
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L628" class="number ">628</th>

                    <td class="" >
                        <pre>
</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L629" class="number uncovered">629</th>

                    <td class="uncovered" >
                        <pre>      parent::processMassiveActionsForOneItemtype($ma, $item, $ids);</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L630" class="number uncovered">630</th>

                    <td class="uncovered" >
                        <pre>   }</pre>
                    </td>
                </tr>
                            <tr class="line" id="">
                    <th id="L631" class="number ">631</th>

                    <td class="" >
                        <pre>}
</pre>
                    </td>
                </tr>
                        </tbody>
        </table>
    </div>
    </div>

    <footer class="row">
        <div class="col-lg-12">
            <small class="pull-right">Powered by <a href="http://atoum.org"><img src="assets/logo.png" alt="atoum"/></a></small>
        </div>
    </footer>
</div>

<script>
    $(function() {
        $('table.sort').tablesorter();
    })
</script>

</body>

</html>
